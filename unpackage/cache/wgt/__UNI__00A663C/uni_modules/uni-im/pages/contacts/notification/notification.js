"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var qi=Object.create;var bt=Object.defineProperty,Hi=Object.defineProperties,Wi=Object.getOwnPropertyDescriptor,zi=Object.getOwnPropertyDescriptors,Ji=Object.getOwnPropertyNames,sn=Object.getOwnPropertySymbols,Vi=Object.getPrototypeOf,rn=Object.prototype.hasOwnProperty,Ki=Object.prototype.propertyIsEnumerable;var an=(n,e,t)=>e in n?bt(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,B=(n,e)=>{for(var t in e||(e={}))rn.call(e,t)&&an(n,t,e[t]);if(sn)for(var t of sn(e))Ki.call(e,t)&&an(n,t,e[t]);return n},ne=(n,e)=>Hi(n,zi(e));var Gi=(n,e)=>()=>(e||n((e={exports:{}}).exports,e),e.exports);var Yi=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Ji(e))!rn.call(n,o)&&o!==t&&bt(n,o,{get:()=>e[o],enumerable:!(i=Wi(e,o))||i.enumerable});return n};var ke=(n,e,t)=>(t=n!=null?qi(Vi(n)):{},Yi(e||!n||!n.__esModule?bt(t,"default",{value:n,enumerable:!0}):t,n));var A=(n,e,t)=>new Promise((i,o)=>{var s=l=>{try{a(t.next(l))}catch(c){o(c)}},r=l=>{try{a(t.throw(l))}catch(c){o(c)}},a=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,r);a((t=t.apply(n,e)).next())});var we=Gi((Ia,cn)=>{cn.exports=Vue});var Ee=ke(we()),$i=n=>typeof n=="string",Qi="onShow",Zi="onHide";function D(n,e,...t){uni.__log__?uni.__log__(n,e,...t):console[n].apply(console,[...t,e])}function be(n,e){return $i(n)?e:n}var ln=n=>(e,t=(0,Ee.getCurrentInstance)())=>{!Ee.isInSSRComponentSetup&&(0,Ee.injectHook)(n,e,t)},un=ln(Qi),dn=ln(Zi);var ie=(n,e)=>{let t=n.__vccOpts||n;for(let[i,o]of e)t[i]=o;return t};var Vt=ke(we());var Xi=[{path:"pages/index/index",style:{navigationBarTitleText:"",enablePullDownRefresh:!1}},{path:"uni_modules/uni-im/pages/chat/chat",style:{navigationBarTitleText:"",enablePullDownRefresh:!1,"app-plus":{titleNView:{buttons:[{color:"#333",colorPressed:"#111111",float:"right",text:"...",fontSize:26,onclick:"more"}]}}}},{path:"uni_modules/uni-id-pages/pages/userinfo/realname-verify/realname-verify",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u5B9E\u540D\u8BA4\u8BC1"}}],eo=[{root:"uni_modules/uni-im/pages",pages:[{path:"index/index",style:{navigationBarTitleText:"\u4F1A\u8BDD\u5217\u8868",enablePullDownRefresh:!1,"app-plus":{titleNView:{buttons:[{color:"#999999",colorPressed:"#111111",float:"right",text:"\u6211\u7684",fontSize:14,onclick:"toLogin"}]}}}},{path:"common/uni-im-code-pages/uni-im-code-pages",style:{navigationBarTitleText:"\u4EE3\u7801\u6D4F\u89C8",enablePullDownRefresh:!1}},{path:"userList/userList",style:{navigationBarTitleText:"\u7528\u6237\u5217\u8868",enablePullDownRefresh:!0}},{path:"common/video/video",style:{navigationBarTitleText:"",enablePullDownRefresh:!1,navigationStyle:"custom"}},{path:"group/info",style:{navigationBarTitleText:"\u7FA4\u4FE1\u606F",enablePullDownRefresh:!1,"app-plus":{titleNView:{buttons:[{color:"#333",colorPressed:"#111111",float:"right",text:"\u7BA1\u7406",fontSize:16,onclick:"more"}]}}}},{path:"contacts/notification/notification",style:{navigationBarTitleText:"",enablePullDownRefresh:!1}},{path:"contacts/contacts",style:{navigationBarTitleText:"\u901A\u8BAF\u5F55",enablePullDownRefresh:!1}},{path:"contacts/addPeopleGroups/addPeopleGroups",style:{navigationStyle:"custom",enablePullDownRefresh:!1}},{path:"contacts/createGroup/createGroup",style:{navigationBarTitleText:"\u521B\u5EFA\u7FA4\u804A",enablePullDownRefresh:!1,maxWidth:950}},{path:"group/groupQRCode",style:{navigationBarTitleText:"\u7FA4\u804A\u4E8C\u7EF4\u7801",enablePullDownRefresh:!1}},{path:"contacts/groupList/groupList",style:{navigationBarTitleText:"\u6211\u7684\u7FA4\u804A",enablePullDownRefresh:!1}},{path:"chat/info",style:{navigationBarTitleText:"\u804A\u5929\u8BBE\u7F6E",enablePullDownRefresh:!1}}]},{root:"uni_modules/uni-id-pages/pages",pages:[{path:"userinfo/userinfo",style:{navigationBarTitleText:"\u4E2A\u4EBA\u8D44\u6599"}},{path:"login/login-withoutpwd"},{path:"login/login-withpwd"},{path:"userinfo/deactivate/deactivate",style:{navigationBarTitleText:"\u6CE8\u9500\u8D26\u53F7"}},{path:"userinfo/bind-mobile/bind-mobile",style:{navigationBarTitleText:"\u7ED1\u5B9A\u624B\u673A\u53F7\u7801"}},{path:"login/login-smscode",style:{navigationBarTitleText:"\u624B\u673A\u9A8C\u8BC1\u7801\u767B\u5F55"}},{path:"register/register",style:{navigationBarTitleText:"\u6CE8\u518C"}},{path:"retrieve/retrieve",style:{navigationBarTitleText:"\u91CD\u7F6E\u5BC6\u7801"}},{path:"common/webview/webview",style:{enablePullDownRefresh:!1,navigationBarTitleText:""}},{path:"userinfo/change_pwd/change_pwd",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u4FEE\u6539\u5BC6\u7801"}},{path:"register/register-by-email",style:{navigationBarTitleText:"\u90AE\u7BB1\u9A8C\u8BC1\u7801\u6CE8\u518C"}},{path:"retrieve/retrieve-by-email",style:{navigationBarTitleText:"\u901A\u8FC7\u90AE\u7BB1\u91CD\u7F6E\u5BC6\u7801"}},{path:"userinfo/set-pwd/set-pwd",style:{enablePullDownRefresh:!1,navigationBarTitleText:"\u8BBE\u7F6E\u5BC6\u7801"}}]}],to={color:"#999999",selectedColor:"#38BC48",borderStyle:"black",backgroundColor:"#FFFFFF",list:[{pagePath:"uni_modules/uni-im/pages/index/index",text:"\u4F1A\u8BDD",iconPath:"uni_modules/uni-im/static/tabbarIcon/chat.png",selectedIconPath:"uni_modules/uni-im/static/tabbarIcon/chatex.png"},{pagePath:"uni_modules/uni-im/pages/userList/userList",text:"\u7528\u6237\u5217\u8868",iconPath:"uni_modules/uni-im/static/tabbarIcon/contacts.png",selectedIconPath:"uni_modules/uni-im/static/tabbarIcon/contactsex.png"},{pagePath:"uni_modules/uni-im/pages/contacts/contacts",text:"\u901A\u8BAF\u5F55",iconPath:"uni_modules/uni-im/static/tabbarIcon/contacts.png",selectedIconPath:"uni_modules/uni-im/static/tabbarIcon/contactsex.png"}]},no={loginPage:"uni_modules/uni-id-pages/pages/login/login-withpwd",needLogin:["uni_modules/uni-im/pages/userList/userList","uni_modules/uni-im/pages/contacts/contacts","pages/index/index"]},io={navigationBarTextStyle:"black",navigationBarTitleText:"\u667A\u533B\u804A+",navigationBarBackgroundColor:"#F8F8F8",backgroundColor:"#F8F8F8"},De={pages:Xi,subPackages:eo,tabBar:to,uniIdRouter:no,globalStyle:io};function oo(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function fe(n,e,t){return n(t={path:e,exports:{},require:function(i,o){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(o==null&&t.path)}},t.exports),t.exports}var so=fe(function(n,e){var t;n.exports=(t=t||function(i,o){var s=Object.create||function(){function d(){}return function(b){var x;return d.prototype=b,x=new d,d.prototype=null,x}}(),r={},a=r.lib={},l=a.Base={extend:function(d){var b=s(this);return d&&b.mixIn(d),b.hasOwnProperty("init")&&this.init!==b.init||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var d=this.extend();return d.init.apply(d,arguments),d},init:function(){},mixIn:function(d){for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b]);d.hasOwnProperty("toString")&&(this.toString=d.toString)},clone:function(){return this.init.prototype.extend(this)}},c=a.WordArray=l.extend({init:function(d,b){d=this.words=d||[],this.sigBytes=b!=o?b:4*d.length},toString:function(d){return(d||u).stringify(this)},concat:function(d){var b=this.words,x=d.words,g=this.sigBytes,p=d.sigBytes;if(this.clamp(),g%4)for(var y=0;y<p;y++){var w=x[y>>>2]>>>24-y%4*8&255;b[g+y>>>2]|=w<<24-(g+y)%4*8}else for(y=0;y<p;y+=4)b[g+y>>>2]=x[y>>>2];return this.sigBytes+=p,this},clamp:function(){var d=this.words,b=this.sigBytes;d[b>>>2]&=4294967295<<32-b%4*8,d.length=i.ceil(b/4)},clone:function(){var d=l.clone.call(this);return d.words=this.words.slice(0),d},random:function(d){for(var b,x=[],g=function(w){w=w;var M=987654321,R=4294967295;return function(){var q=((M=36969*(65535&M)+(M>>16)&R)<<16)+(w=18e3*(65535&w)+(w>>16)&R)&R;return q/=4294967296,(q+=.5)*(i.random()>.5?1:-1)}},p=0;p<d;p+=4){var y=g(4294967296*(b||i.random()));b=987654071*y(),x.push(4294967296*y()|0)}return new c.init(x,d)}}),_=r.enc={},u=_.Hex={stringify:function(d){for(var b=d.words,x=d.sigBytes,g=[],p=0;p<x;p++){var y=b[p>>>2]>>>24-p%4*8&255;g.push((y>>>4).toString(16)),g.push((15&y).toString(16))}return g.join("")},parse:function(d){for(var b=d.length,x=[],g=0;g<b;g+=2)x[g>>>3]|=parseInt(d.substr(g,2),16)<<24-g%8*4;return new c.init(x,b/2)}},v=_.Latin1={stringify:function(d){for(var b=d.words,x=d.sigBytes,g=[],p=0;p<x;p++){var y=b[p>>>2]>>>24-p%4*8&255;g.push(String.fromCharCode(y))}return g.join("")},parse:function(d){for(var b=d.length,x=[],g=0;g<b;g++)x[g>>>2]|=(255&d.charCodeAt(g))<<24-g%4*8;return new c.init(x,b)}},h=_.Utf8={stringify:function(d){try{return decodeURIComponent(escape(v.stringify(d)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(d){return v.parse(unescape(encodeURIComponent(d)))}},m=a.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(d){typeof d=="string"&&(d=h.parse(d)),this._data.concat(d),this._nDataBytes+=d.sigBytes},_process:function(d){var b=this._data,x=b.words,g=b.sigBytes,p=this.blockSize,y=g/(4*p),w=(y=d?i.ceil(y):i.max((0|y)-this._minBufferSize,0))*p,M=i.min(4*w,g);if(w){for(var R=0;R<w;R+=p)this._doProcessBlock(x,R);var q=x.splice(0,w);b.sigBytes-=M}return new c.init(q,M)},clone:function(){var d=l.clone.call(this);return d._data=this._data.clone(),d},_minBufferSize:0});a.Hasher=m.extend({cfg:l.extend(),init:function(d){this.cfg=this.cfg.extend(d),this.reset()},reset:function(){m.reset.call(this),this._doReset()},update:function(d){return this._append(d),this._process(),this},finalize:function(d){return d&&this._append(d),this._doFinalize()},blockSize:16,_createHelper:function(d){return function(b,x){return new d.init(x).finalize(b)}},_createHmacHelper:function(d){return function(b,x){return new f.HMAC.init(d,x).finalize(b)}}});var f=r.algo={};return r}(Math),t)}),Se=so,ao=(fe(function(n,e){var t;n.exports=(t=Se,function(i){var o=t,s=o.lib,r=s.WordArray,a=s.Hasher,l=o.algo,c=[];(function(){for(var f=0;f<64;f++)c[f]=4294967296*i.abs(i.sin(f+1))|0})();var _=l.MD5=a.extend({_doReset:function(){this._hash=new r.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(f,d){for(var b=0;b<16;b++){var x=d+b,g=f[x];f[x]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8)}var p=this._hash.words,y=f[d+0],w=f[d+1],M=f[d+2],R=f[d+3],q=f[d+4],ee=f[d+5],z=f[d+6],oe=f[d+7],te=f[d+8],re=f[d+9],se=f[d+10],he=f[d+11],ge=f[d+12],me=f[d+13],pe=f[d+14],_e=f[d+15],S=p[0],T=p[1],I=p[2],k=p[3];S=u(S,T,I,k,y,7,c[0]),k=u(k,S,T,I,w,12,c[1]),I=u(I,k,S,T,M,17,c[2]),T=u(T,I,k,S,R,22,c[3]),S=u(S,T,I,k,q,7,c[4]),k=u(k,S,T,I,ee,12,c[5]),I=u(I,k,S,T,z,17,c[6]),T=u(T,I,k,S,oe,22,c[7]),S=u(S,T,I,k,te,7,c[8]),k=u(k,S,T,I,re,12,c[9]),I=u(I,k,S,T,se,17,c[10]),T=u(T,I,k,S,he,22,c[11]),S=u(S,T,I,k,ge,7,c[12]),k=u(k,S,T,I,me,12,c[13]),I=u(I,k,S,T,pe,17,c[14]),S=v(S,T=u(T,I,k,S,_e,22,c[15]),I,k,w,5,c[16]),k=v(k,S,T,I,z,9,c[17]),I=v(I,k,S,T,he,14,c[18]),T=v(T,I,k,S,y,20,c[19]),S=v(S,T,I,k,ee,5,c[20]),k=v(k,S,T,I,se,9,c[21]),I=v(I,k,S,T,_e,14,c[22]),T=v(T,I,k,S,q,20,c[23]),S=v(S,T,I,k,re,5,c[24]),k=v(k,S,T,I,pe,9,c[25]),I=v(I,k,S,T,R,14,c[26]),T=v(T,I,k,S,te,20,c[27]),S=v(S,T,I,k,me,5,c[28]),k=v(k,S,T,I,M,9,c[29]),I=v(I,k,S,T,oe,14,c[30]),S=h(S,T=v(T,I,k,S,ge,20,c[31]),I,k,ee,4,c[32]),k=h(k,S,T,I,te,11,c[33]),I=h(I,k,S,T,he,16,c[34]),T=h(T,I,k,S,pe,23,c[35]),S=h(S,T,I,k,w,4,c[36]),k=h(k,S,T,I,q,11,c[37]),I=h(I,k,S,T,oe,16,c[38]),T=h(T,I,k,S,se,23,c[39]),S=h(S,T,I,k,me,4,c[40]),k=h(k,S,T,I,y,11,c[41]),I=h(I,k,S,T,R,16,c[42]),T=h(T,I,k,S,z,23,c[43]),S=h(S,T,I,k,re,4,c[44]),k=h(k,S,T,I,ge,11,c[45]),I=h(I,k,S,T,_e,16,c[46]),S=m(S,T=h(T,I,k,S,M,23,c[47]),I,k,y,6,c[48]),k=m(k,S,T,I,oe,10,c[49]),I=m(I,k,S,T,pe,15,c[50]),T=m(T,I,k,S,ee,21,c[51]),S=m(S,T,I,k,ge,6,c[52]),k=m(k,S,T,I,R,10,c[53]),I=m(I,k,S,T,se,15,c[54]),T=m(T,I,k,S,w,21,c[55]),S=m(S,T,I,k,te,6,c[56]),k=m(k,S,T,I,_e,10,c[57]),I=m(I,k,S,T,z,15,c[58]),T=m(T,I,k,S,me,21,c[59]),S=m(S,T,I,k,q,6,c[60]),k=m(k,S,T,I,he,10,c[61]),I=m(I,k,S,T,M,15,c[62]),T=m(T,I,k,S,re,21,c[63]),p[0]=p[0]+S|0,p[1]=p[1]+T|0,p[2]=p[2]+I|0,p[3]=p[3]+k|0},_doFinalize:function(){var f=this._data,d=f.words,b=8*this._nDataBytes,x=8*f.sigBytes;d[x>>>5]|=128<<24-x%32;var g=i.floor(b/4294967296),p=b;d[15+(x+64>>>9<<4)]=16711935&(g<<8|g>>>24)|4278255360&(g<<24|g>>>8),d[14+(x+64>>>9<<4)]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),f.sigBytes=4*(d.length+1),this._process();for(var y=this._hash,w=y.words,M=0;M<4;M++){var R=w[M];w[M]=16711935&(R<<8|R>>>24)|4278255360&(R<<24|R>>>8)}return y},clone:function(){var f=a.clone.call(this);return f._hash=this._hash.clone(),f}});function u(f,d,b,x,g,p,y){var w=f+(d&b|~d&x)+g+y;return(w<<p|w>>>32-p)+d}function v(f,d,b,x,g,p,y){var w=f+(d&x|b&~x)+g+y;return(w<<p|w>>>32-p)+d}function h(f,d,b,x,g,p,y){var w=f+(d^b^x)+g+y;return(w<<p|w>>>32-p)+d}function m(f,d,b,x,g,p,y){var w=f+(b^(d|~x))+g+y;return(w<<p|w>>>32-p)+d}o.MD5=a._createHelper(_),o.HmacMD5=a._createHmacHelper(_)}(Math),t.MD5)}),fe(function(n,e){var t;n.exports=(t=Se,void function(){var i=t,o=i.lib.Base,s=i.enc.Utf8;i.algo.HMAC=o.extend({init:function(r,a){r=this._hasher=new r.init,typeof a=="string"&&(a=s.parse(a));var l=r.blockSize,c=4*l;a.sigBytes>c&&(a=r.finalize(a)),a.clamp();for(var _=this._oKey=a.clone(),u=this._iKey=a.clone(),v=_.words,h=u.words,m=0;m<l;m++)v[m]^=1549556828,h[m]^=909522486;_.sigBytes=u.sigBytes=c,this.reset()},reset:function(){var r=this._hasher;r.reset(),r.update(this._iKey)},update:function(r){return this._hasher.update(r),this},finalize:function(r){var a=this._hasher,l=a.finalize(r);return a.reset(),a.finalize(this._oKey.clone().concat(l))}})}())}),fe(function(n,e){n.exports=Se.HmacMD5})),ro=fe(function(n,e){n.exports=Se.enc.Utf8}),co=fe(function(n,e){var t;n.exports=(t=Se,function(){var i=t,o=i.lib.WordArray;function s(r,a,l){for(var c=[],_=0,u=0;u<a;u++)if(u%4){var v=l[r.charCodeAt(u-1)]<<u%4*2,h=l[r.charCodeAt(u)]>>>6-u%4*2;c[_>>>2]|=(v|h)<<24-_%4*8,_++}return o.create(c,_)}i.enc.Base64={stringify:function(r){var a=r.words,l=r.sigBytes,c=this._map;r.clamp();for(var _=[],u=0;u<l;u+=3)for(var v=(a[u>>>2]>>>24-u%4*8&255)<<16|(a[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|a[u+2>>>2]>>>24-(u+2)%4*8&255,h=0;h<4&&u+.75*h<l;h++)_.push(c.charAt(v>>>6*(3-h)&63));var m=c.charAt(64);if(m)for(;_.length%4;)_.push(m);return _.join("")},parse:function(r){var a=r.length,l=this._map,c=this._reverseMap;if(!c){c=this._reverseMap=[];for(var _=0;_<l.length;_++)c[l.charCodeAt(_)]=_}var u=l.charAt(64);if(u){var v=r.indexOf(u);v!==-1&&(a=v)}return s(r,a,c)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),t.enc.Base64)}),fn="FUNCTION",lo="OBJECT",uo="CLIENT_DB",hn="pending",fo="fulfilled",gn="rejected";function Je(n){return Object.prototype.toString.call(n).slice(8,-1).toLowerCase()}function Vn(n){return Je(n)==="object"}function Kn(n){return typeof n=="function"}function ho(n){return function(){try{return n.apply(n,arguments)}catch(e){console.error(e)}}}var mn="REJECTED",Gn="NOT_PENDING",rt=class{constructor({createPromise:e,retryRule:t=mn}={}){this.createPromise=e,this.status=null,this.promise=null,this.retryRule=t}get needRetry(){if(!this.status)return!0;switch(this.retryRule){case mn:return this.status===gn;case Gn:return this.status!==hn}}exec(){return this.needRetry?(this.status=hn,this.promise=this.createPromise().then(e=>(this.status=fo,Promise.resolve(e)),e=>(this.status=gn,Promise.reject(e))),this.promise):this.promise}};function Kt(n){return n&&typeof n=="string"?JSON.parse(n):n}var go=!1,mo="app",po=Kt([]),Yn=mo;Kt("");var _o=Kt('[{"provider":"aliyun","spaceName":"chat-kyxf","spaceId":"mp-e3582cd1-8371-4a89-9221-663dc8b8b2a5","clientSecret":"QHrHbGTbhDOgGvAPLvpJPw=="}]')||[],yo="";try{yo="__UNI__00A663C"}catch(n){}var at={};function Me(n,e={}){var t,i;return t=at,i=n,Object.prototype.hasOwnProperty.call(t,i)||(at[n]=e),at[n]}at=uni._globalUniCloudObj?uni._globalUniCloudObj:uni._globalUniCloudObj={};var $n=["invoke","success","fail","complete"],ue=Me("_globalUniCloudInterceptor");function Qn(n,e){ue[n]||(ue[n]={}),Vn(e)&&Object.keys(e).forEach(t=>{$n.indexOf(t)>-1&&function(i,o,s){let r=ue[i][o];r||(r=ue[i][o]=[]),r.indexOf(s)===-1&&Kn(s)&&r.push(s)}(n,t,e[t])})}function wo(n,e){ue[n]||(ue[n]={}),Vn(e)?Object.keys(e).forEach(t=>{$n.indexOf(t)>-1&&function(i,o,s){let r=ue[i][o];if(!r)return;let a=r.indexOf(s);a>-1&&r.splice(a,1)}(n,t,e[t])}):delete ue[n]}function $(n,e){return n&&n.length!==0?n.reduce((t,i)=>t.then(()=>i(e)),Promise.resolve()):Promise.resolve()}function Q(n,e){return ue[n]&&ue[n][e]||[]}function bo(n){Qn("callObject",n)}var vt=Me("_globalUniCloudListener"),de="response",Re="needLogin",ct="refreshToken",pn="clientdb",et="cloudfunction",_n="cloudobject";function $e(n){return vt[n]||(vt[n]=[]),vt[n]}function kt(n,e){let t=$e(n);t.includes(e)||t.push(e)}function xt(n,e){let t=$e(n),i=t.indexOf(e);i!==-1&&t.splice(i,1)}function ae(n,e){let t=$e(n);for(let i=0;i<t.length;i++)(0,t[i])(e)}var St,Tt=!1;function Zn(){return St||(St=new Promise(n=>{Tt&&n(),function e(){if(typeof getCurrentPages=="function"){let t=getCurrentPages();t&&t[0]&&(Tt=!0,n())}Tt||setTimeout(()=>{e()},30)}()}),St)}function Xn(n){let e={};for(let t in n){let i=n[t];Kn(i)&&(e[t]=ho(i))}return e}var P=class extends Error{constructor(e){super(e.message),this.errMsg=e.message||e.errMsg||"unknown system error",this.code=this.errCode=e.code||e.errCode||"SYSTEM_ERROR",this.errSubject=this.subject=e.subject||e.errSubject,this.cause=e.cause,this.requestId=e.requestId}toJson(e=0){if(!(e>=10))return e++,{errCode:this.errCode,errMsg:this.errMsg,errSubject:this.errSubject,cause:this.cause&&this.cause.toJson?this.cause.toJson(e):this.cause}}},Z={request:n=>uni.request(n),uploadFile:n=>uni.uploadFile(n),setStorageSync:(n,e)=>uni.setStorageSync(n,e),getStorageSync:n=>uni.getStorageSync(n),removeStorageSync:n=>uni.removeStorageSync(n),clearStorageSync:()=>uni.clearStorageSync()};function ei(n){return n&&ei(n.__v_raw)||n}function _t(){return{token:Z.getStorageSync("uni_id_token")||Z.getStorageSync("uniIdToken"),tokenExpired:Z.getStorageSync("uni_id_token_expired")}}function ti({token:n,tokenExpired:e}={}){n&&Z.setStorageSync("uni_id_token",n),e&&Z.setStorageSync("uni_id_token_expired",e)}var It,tt;function ni(){return It||(It=uni.getSystemInfoSync()),It}function vo(){let n,e;try{if(uni.getLaunchOptionsSync){if(uni.getLaunchOptionsSync.toString().indexOf("not yet implemented")>-1)return;let{scene:t,channel:i}=uni.getLaunchOptionsSync();n=i,e=t}}catch(t){}return{channel:n,scene:e}}function ii(){let n=uni.getLocale&&uni.getLocale()||"en";if(tt)return ne(B({},tt),{locale:n,LOCALE:n});let e=ni(),{deviceId:t,osName:i,uniPlatform:o,appId:s}=e,r=["pixelRatio","brand","model","system","language","version","platform","host","SDKVersion","swanNativeVersion","app","AppPlatform","fontSizeSetting"];for(let a=0;a<r.length;a++)delete e[r[a]];return tt=B(B({PLATFORM:o,OS:i,APPID:s,DEVICEID:t},vo()),e),ne(B({},tt),{locale:n,LOCALE:n})}var qe={sign:function(n,e){let t="";return Object.keys(n).sort().forEach(function(i){n[i]&&(t=t+"&"+i+"="+n[i])}),t=t.slice(1),ao(t,e).toString()},wrappedRequest:function(n,e){return new Promise((t,i)=>{e(Object.assign(n,{complete(o){o||(o={});let s=o.data&&o.data.header&&o.data.header["x-serverless-request-id"]||o.header&&o.header["request-id"];if(!o.statusCode||o.statusCode>=400)return i(new P({code:"SYS_ERR",message:o.errMsg||"request:fail",requestId:s}));let r=o.data;if(r.error)return i(new P({code:r.error.code,message:r.error.message,requestId:s}));r.result=r.data,r.requestId=s,delete r.data,t(r)}}))})},toBase64:function(n){return co.stringify(ro.parse(n))}},oi=class{constructor(n){["spaceId","clientSecret"].forEach(e=>{if(!Object.prototype.hasOwnProperty.call(n,e))throw new Error(`${e} required`)}),this.config=Object.assign({},{endpoint:n.spaceId.indexOf("mp-")===0?"https://api.next.bspapp.com":"https://api.bspapp.com"},n),this.config.provider="aliyun",this.config.requestUrl=this.config.endpoint+"/client",this.config.envType=this.config.envType||"public",this.config.accessTokenKey="access_token_"+this.config.spaceId,this.adapter=Z,this._getAccessTokenPromiseHub=new rt({createPromise:()=>this.requestAuth(this.setupRequest({method:"serverless.auth.user.anonymousAuthorize",params:"{}"},"auth")).then(e=>{if(!e.result||!e.result.accessToken)throw new P({code:"AUTH_FAILED",message:"\u83B7\u53D6accessToken\u5931\u8D25"});this.setAccessToken(e.result.accessToken)}),retryRule:Gn})}get hasAccessToken(){return!!this.accessToken}setAccessToken(n){this.accessToken=n}requestWrapped(n){return qe.wrappedRequest(n,this.adapter.request)}requestAuth(n){return this.requestWrapped(n)}request(n,e){return Promise.resolve().then(()=>this.hasAccessToken?e?this.requestWrapped(n):this.requestWrapped(n).catch(t=>new Promise((i,o)=>{!t||t.code!=="GATEWAY_INVALID_TOKEN"&&t.code!=="InvalidParameter.InvalidToken"?o(t):i()}).then(()=>this.getAccessToken()).then(()=>{let i=this.rebuildRequest(n);return this.request(i,!0)})):this.getAccessToken().then(()=>{let t=this.rebuildRequest(n);return this.request(t,!0)}))}rebuildRequest(n){let e=Object.assign({},n);return e.data.token=this.accessToken,e.header["x-basement-token"]=this.accessToken,e.header["x-serverless-sign"]=qe.sign(e.data,this.config.clientSecret),e}setupRequest(n,e){let t=Object.assign({},n,{spaceId:this.config.spaceId,timestamp:Date.now()}),i={"Content-Type":"application/json"};return e!=="auth"&&(t.token=this.accessToken,i["x-basement-token"]=this.accessToken),i["x-serverless-sign"]=qe.sign(t,this.config.clientSecret),{url:this.config.requestUrl,method:"POST",data:t,dataType:"json",header:i}}getAccessToken(){return this._getAccessTokenPromiseHub.exec()}authorize(){return A(this,null,function*(){yield this.getAccessToken()})}callFunction(n){let e={method:"serverless.function.runtime.invoke",params:JSON.stringify({functionTarget:n.name,functionArgs:n.data||{}})};return this.request(this.setupRequest(e))}getOSSUploadOptionsFromPath(n){let e={method:"serverless.file.resource.generateProximalSign",params:JSON.stringify(n)};return this.request(this.setupRequest(e))}uploadFileToOSS({url:n,formData:e,name:t,filePath:i,fileType:o,onUploadProgress:s}){return new Promise((r,a)=>{let l=this.adapter.uploadFile({url:n,formData:e,name:t,filePath:i,fileType:o,header:{"X-OSS-server-side-encrpytion":"AES256"},success(c){c&&c.statusCode<400?r(c):a(new P({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(c){a(new P({code:c.code||"UPLOAD_FAILED",message:c.message||c.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof s=="function"&&l&&typeof l.onProgressUpdate=="function"&&l.onProgressUpdate(c=>{s({loaded:c.totalBytesSent,total:c.totalBytesExpectedToSend})})})}reportOSSUpload(n){let e={method:"serverless.file.resource.report",params:JSON.stringify(n)};return this.request(this.setupRequest(e))}uploadFile(r){return A(this,arguments,function*({filePath:n,cloudPath:e,fileType:t="image",cloudPathAsRealPath:i=!1,onUploadProgress:o,config:s}){if(Je(e)!=="string")throw new P({code:"INVALID_PARAM",message:"cloudPath\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u7C7B\u578B"});if(!(e=e.trim()))throw new P({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});if(/:\/\//.test(e))throw new P({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u5408\u6CD5"});let a=s&&s.envType||this.config.envType;if(i&&(e[0]!=="/"&&(e="/"+e),e.indexOf("\\")>-1))throw new P({code:"INVALID_PARAM",message:"\u4F7F\u7528cloudPath\u4F5C\u4E3A\u8DEF\u5F84\u65F6\uFF0CcloudPath\u4E0D\u53EF\u5305\u542B\u201C\\\u201D"});let l=(yield this.getOSSUploadOptionsFromPath({env:a,filename:i?e.split("/").pop():e,fileId:i?e:void 0})).result,c="https://"+l.cdnDomain+"/"+l.ossPath,{securityToken:_,accessKeyId:u,signature:v,host:h,ossPath:m,id:f,policy:d,ossCallbackUrl:b}=l,x={"Cache-Control":"max-age=2592000","Content-Disposition":"attachment",OSSAccessKeyId:u,Signature:v,host:h,id:f,key:m,policy:d,success_action_status:200};if(_&&(x["x-oss-security-token"]=_),b){let p=JSON.stringify({callbackUrl:b,callbackBody:JSON.stringify({fileId:f,spaceId:this.config.spaceId}),callbackBodyType:"application/json"});x.callback=qe.toBase64(p)}let g={url:"https://"+l.host,formData:x,fileName:"file",name:"file",filePath:n,fileType:t};if(yield this.uploadFileToOSS(Object.assign({},g,{onUploadProgress:o})),b)return{success:!0,filePath:n,fileID:c};if((yield this.reportOSSUpload({id:f})).success)return{success:!0,filePath:n,fileID:c};throw new P({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"})})}getTempFileURL({fileList:n}={}){return new Promise((e,t)=>{Array.isArray(n)&&n.length!==0||t(new P({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"})),e({fileList:n.map(i=>({fileID:i,tempFileURL:i}))})})}getFileInfo(){return A(this,arguments,function*({fileList:n}={}){if(!Array.isArray(n)||n.length===0)throw new P({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"});let e={method:"serverless.file.resource.info",params:JSON.stringify({id:n.map(t=>t.split("?")[0]).join(",")})};return{fileList:(yield this.request(this.setupRequest(e))).result}})}},ko={init(n){let e=new oi(n),t={signInAnonymously:function(){return e.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return e.auth=function(){return t},e.customAuth=e.auth,e}},xo=typeof location!="undefined"&&location.protocol==="http:"?"http:":"https:",yn;(function(n){n.local="local",n.none="none",n.session="session"})(yn||(yn={}));var So=function(){},To=fe(function(n,e){var t;n.exports=(t=Se,function(i){var o=t,s=o.lib,r=s.WordArray,a=s.Hasher,l=o.algo,c=[],_=[];(function(){function h(b){for(var x=i.sqrt(b),g=2;g<=x;g++)if(!(b%g))return!1;return!0}function m(b){return 4294967296*(b-(0|b))|0}for(var f=2,d=0;d<64;)h(f)&&(d<8&&(c[d]=m(i.pow(f,.5))),_[d]=m(i.pow(f,1/3)),d++),f++})();var u=[],v=l.SHA256=a.extend({_doReset:function(){this._hash=new r.init(c.slice(0))},_doProcessBlock:function(h,m){for(var f=this._hash.words,d=f[0],b=f[1],x=f[2],g=f[3],p=f[4],y=f[5],w=f[6],M=f[7],R=0;R<64;R++){if(R<16)u[R]=0|h[m+R];else{var q=u[R-15],ee=(q<<25|q>>>7)^(q<<14|q>>>18)^q>>>3,z=u[R-2],oe=(z<<15|z>>>17)^(z<<13|z>>>19)^z>>>10;u[R]=ee+u[R-7]+oe+u[R-16]}var te=d&b^d&x^b&x,re=(d<<30|d>>>2)^(d<<19|d>>>13)^(d<<10|d>>>22),se=M+((p<<26|p>>>6)^(p<<21|p>>>11)^(p<<7|p>>>25))+(p&y^~p&w)+_[R]+u[R];M=w,w=y,y=p,p=g+se|0,g=x,x=b,b=d,d=se+(re+te)|0}f[0]=f[0]+d|0,f[1]=f[1]+b|0,f[2]=f[2]+x|0,f[3]=f[3]+g|0,f[4]=f[4]+p|0,f[5]=f[5]+y|0,f[6]=f[6]+w|0,f[7]=f[7]+M|0},_doFinalize:function(){var h=this._data,m=h.words,f=8*this._nDataBytes,d=8*h.sigBytes;return m[d>>>5]|=128<<24-d%32,m[14+(d+64>>>9<<4)]=i.floor(f/4294967296),m[15+(d+64>>>9<<4)]=f,h.sigBytes=4*m.length,this._process(),this._hash},clone:function(){var h=a.clone.call(this);return h._hash=this._hash.clone(),h}});o.SHA256=a._createHelper(v),o.HmacSHA256=a._createHmacHelper(v)}(Math),t.SHA256)}),wn=To,Io=fe(function(n,e){n.exports=Se.HmacSHA256}),Qe=()=>{let n;if(!Promise){n=()=>{},n.promise={};let t=()=>{throw new P({message:'Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.'})};return Object.defineProperty(n.promise,"then",{get:t}),Object.defineProperty(n.promise,"catch",{get:t}),n}let e=new Promise((t,i)=>{n=(o,s)=>o?i(o):t(s)});return n.promise=e,n};function Ao(n){return n===void 0}function Co(n){return Object.prototype.toString.call(n)==="[object Null]"}var bn;function Po(n){let e=(t=n,Object.prototype.toString.call(t)==="[object Array]"?n:[n]);var t;for(let i of e){let{isMatch:o,genAdapter:s,runtime:r}=i;if(o())return{adapter:s(),runtime:r}}}(function(n){n.WEB="web",n.WX_MP="wx_mp"})(bn||(bn={}));var Y={adapter:null,runtime:void 0},Lo=["anonymousUuidKey"],He=class extends So{constructor(){super(),Y.adapter.root.tcbObject||(Y.adapter.root.tcbObject={})}setItem(e,t){Y.adapter.root.tcbObject[e]=t}getItem(e){return Y.adapter.root.tcbObject[e]}removeItem(e){delete Y.adapter.root.tcbObject[e]}clear(){delete Y.adapter.root.tcbObject}};function vn(n,e){switch(n){case"local":return e.localStorage||new He;case"none":return new He;default:return e.sessionStorage||new He}}var lt=class{constructor(e){if(!this._storage){this._persistence=Y.adapter.primaryStorage||e.persistence,this._storage=vn(this._persistence,Y.adapter);let t=`access_token_${e.env}`,i=`access_token_expire_${e.env}`,o=`refresh_token_${e.env}`,s=`anonymous_uuid_${e.env}`,r=`login_type_${e.env}`,a=`user_info_${e.env}`;this.keys={accessTokenKey:t,accessTokenExpireKey:i,refreshTokenKey:o,anonymousUuidKey:s,loginTypeKey:r,userInfoKey:a}}}updatePersistence(e){if(e===this._persistence)return;let t=this._persistence==="local";this._persistence=e;let i=vn(e,Y.adapter);for(let o in this.keys){let s=this.keys[o];if(t&&Lo.includes(o))continue;let r=this._storage.getItem(s);Ao(r)||Co(r)||(i.setItem(s,r),this._storage.removeItem(s))}this._storage=i}setStore(e,t,i){if(!this._storage)return;let o={version:i||"localCachev1",content:t},s=JSON.stringify(o);try{this._storage.setItem(e,s)}catch(r){throw r}}getStore(e,t){try{if(!this._storage)return}catch(o){return""}t=t||"localCachev1";let i=this._storage.getItem(e);return i&&i.indexOf(t)>=0?JSON.parse(i).content:""}removeStore(e){this._storage.removeItem(e)}},si={},ai={};function Ze(n){return si[n]}var ut=class{constructor(e,t){this.data=t||null,this.name=e}},Mt=class extends ut{constructor(e,t){super("error",{error:e,data:t}),this.error=e}},Gt=new class{constructor(){this._listeners={}}on(n,e){return function(t,i,o){o[t]=o[t]||[],o[t].push(i)}(n,e,this._listeners),this}off(n,e){return function(t,i,o){if(o&&o[t]){let s=o[t].indexOf(i);s!==-1&&o[t].splice(s,1)}}(n,e,this._listeners),this}fire(n,e){if(n instanceof Mt)return console.error(n.error),this;let t=typeof n=="string"?new ut(n,e||{}):n,i=t.name;if(this._listens(i)){t.target=this;let o=this._listeners[i]?[...this._listeners[i]]:[];for(let s of o)s.call(this,t)}return this}_listens(n){return this._listeners[n]&&this._listeners[n].length>0}};function xe(n,e){Gt.on(n,e)}function X(n,e={}){Gt.fire(n,e)}function Oo(n,e){Gt.off(n,e)}var Ne="loginStateChanged",ri="loginStateExpire",Te="loginTypeChanged",Rt="anonymousConverted",ci="refreshAccessToken",K;(function(n){n.ANONYMOUS="ANONYMOUS",n.WECHAT="WECHAT",n.WECHAT_PUBLIC="WECHAT-PUBLIC",n.WECHAT_OPEN="WECHAT-OPEN",n.CUSTOM="CUSTOM",n.EMAIL="EMAIL",n.USERNAME="USERNAME",n.NULL="NULL"})(K||(K={}));var kn=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"],Eo={"X-SDK-Version":"1.3.5"};function At(n,e,t){let i=n[e];n[e]=function(o){let s={},r={};t.forEach(l=>{let{data:c,headers:_}=l.call(n,o);Object.assign(s,c),Object.assign(r,_)});let a=o.data;return a&&(()=>{var l;if(l=a,Object.prototype.toString.call(l)!=="[object FormData]")o.data=B(B({},a),s);else for(let c in s)a.append(c,s[c])})(),o.headers=B(B({},o.headers||{}),r),i.call(n,o)}}function Ct(){let n=Math.random().toString(16).slice(2);return{data:{seqId:n},headers:ne(B({},Eo),{"x-seqid":n})}}var Nt=class{constructor(e={}){var t;this.config=e,this._reqClass=new Y.adapter.reqClass({timeout:this.config.timeout,timeoutMsg:`\u8BF7\u6C42\u5728${this.config.timeout/1e3}s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD`,restrictedMethods:["post"]}),this._cache=Ze(this.config.env),this._localCache=(t=this.config.env,ai[t]),At(this._reqClass,"post",[Ct]),At(this._reqClass,"upload",[Ct]),At(this._reqClass,"download",[Ct])}post(e){return A(this,null,function*(){return yield this._reqClass.post(e)})}upload(e){return A(this,null,function*(){return yield this._reqClass.upload(e)})}download(e){return A(this,null,function*(){return yield this._reqClass.download(e)})}refreshAccessToken(){return A(this,null,function*(){let e,t;this._refreshAccessTokenPromise||(this._refreshAccessTokenPromise=this._refreshAccessToken());try{e=yield this._refreshAccessTokenPromise}catch(i){t=i}if(this._refreshAccessTokenPromise=null,this._shouldRefreshAccessTokenHook=null,t)throw t;return e})}_refreshAccessToken(){return A(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:i,loginTypeKey:o,anonymousUuidKey:s}=this._cache.keys;this._cache.removeStore(e),this._cache.removeStore(t);let r=this._cache.getStore(i);if(!r)throw new P({message:"\u672A\u767B\u5F55CloudBase"});let a={refresh_token:r},l=yield this.request("auth.fetchAccessTokenWithRefreshToken",a);if(l.data.code){let{code:c}=l.data;if(c==="SIGN_PARAM_INVALID"||c==="REFRESH_TOKEN_EXPIRED"||c==="INVALID_REFRESH_TOKEN"){if(this._cache.getStore(o)===K.ANONYMOUS&&c==="INVALID_REFRESH_TOKEN"){let _=this._cache.getStore(s),u=this._cache.getStore(i),v=yield this.send("auth.signInAnonymously",{anonymous_uuid:_,refresh_token:u});return this.setRefreshToken(v.refresh_token),this._refreshAccessToken()}X(ri),this._cache.removeStore(i)}throw new P({code:l.data.code,message:`\u5237\u65B0access token\u5931\u8D25\uFF1A${l.data.code}`})}if(l.data.access_token)return X(ci),this._cache.setStore(e,l.data.access_token),this._cache.setStore(t,l.data.access_token_expire+Date.now()),{accessToken:l.data.access_token,accessTokenExpire:l.data.access_token_expire};l.data.refresh_token&&(this._cache.removeStore(i),this._cache.setStore(i,l.data.refresh_token),this._refreshAccessToken())})}getAccessToken(){return A(this,null,function*(){let{accessTokenKey:e,accessTokenExpireKey:t,refreshTokenKey:i}=this._cache.keys;if(!this._cache.getStore(i))throw new P({message:"refresh token\u4E0D\u5B58\u5728\uFF0C\u767B\u5F55\u72B6\u6001\u5F02\u5E38"});let o=this._cache.getStore(e),s=this._cache.getStore(t),r=!0;return this._shouldRefreshAccessTokenHook&&!(yield this._shouldRefreshAccessTokenHook(o,s))&&(r=!1),(!o||!s||s<Date.now())&&r?this.refreshAccessToken():{accessToken:o,accessTokenExpire:s}})}request(e,t,i){return A(this,null,function*(){let o=`x-tcb-trace_${this.config.env}`,s="application/x-www-form-urlencoded",r=B({action:e,env:this.config.env,dataVersion:"2019-08-16"},t);if(kn.indexOf(e)===-1){let{refreshTokenKey:b}=this._cache.keys;this._cache.getStore(b)&&(r.access_token=(yield this.getAccessToken()).accessToken)}let a;if(e==="storage.uploadFile"){a=new FormData;for(let b in a)a.hasOwnProperty(b)&&a[b]!==void 0&&a.append(b,r[b]);s="multipart/form-data"}else{s="application/json",a={};for(let b in r)r[b]!==void 0&&(a[b]=r[b])}let l={headers:{"content-type":s}};i&&i.onUploadProgress&&(l.onUploadProgress=i.onUploadProgress);let c=this._localCache.getStore(o);c&&(l.headers["X-TCB-Trace"]=c);let{parse:_,inQuery:u,search:v}=t,h={env:this.config.env};_&&(h.parse=!0),u&&(h=B(B({},u),h));let m=function(b,x,g={}){let p=/\?/.test(x),y="";for(let w in g)y===""?!p&&(x+="?"):y+="&",y+=`${w}=${encodeURIComponent(g[w])}`;return/^http(s)?\:\/\//.test(x+=y)?x:`${b}${x}`}(xo,"//tcb-api.tencentcloudapi.com/web",h);v&&(m+=v);let f=yield this.post(B({url:m,data:a},l)),d=f.header&&f.header["x-tcb-trace"];if(d&&this._localCache.setStore(o,d),Number(f.status)!==200&&Number(f.statusCode)!==200||!f.data)throw new P({code:"NETWORK_ERROR",message:"network request error"});return f})}send(i){return A(this,arguments,function*(e,t={}){let o=yield this.request(e,t,{onUploadProgress:t.onUploadProgress});if(o.data.code==="ACCESS_TOKEN_EXPIRED"&&kn.indexOf(e)===-1){yield this.refreshAccessToken();let s=yield this.request(e,t,{onUploadProgress:t.onUploadProgress});if(s.data.code)throw new P({code:s.data.code,message:s.data.message});return s.data}if(o.data.code)throw new P({code:o.data.code,message:o.data.message});return o.data})}setRefreshToken(e){let{accessTokenKey:t,accessTokenExpireKey:i,refreshTokenKey:o}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(i),this._cache.setStore(o,e)}},li={};function ve(n){return li[n]}var Ue=class{constructor(e){this.config=e,this._cache=Ze(e.env),this._request=ve(e.env)}setRefreshToken(e){let{accessTokenKey:t,accessTokenExpireKey:i,refreshTokenKey:o}=this._cache.keys;this._cache.removeStore(t),this._cache.removeStore(i),this._cache.setStore(o,e)}setAccessToken(e,t){let{accessTokenKey:i,accessTokenExpireKey:o}=this._cache.keys;this._cache.setStore(i,e),this._cache.setStore(o,t)}refreshUserInfo(){return A(this,null,function*(){let{data:e}=yield this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e})}setLocalUserInfo(e){let{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e)}},Ut=class{constructor(e){if(!e)throw new P({code:"PARAM_ERROR",message:"envId is not defined"});this._envId=e,this._cache=Ze(this._envId),this._request=ve(this._envId),this.setUserInfo()}linkWithTicket(e){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"ticket must be string"});return this._request.send("auth.linkWithTicket",{ticket:e})}linkWithRedirect(e){e.signInWithRedirect()}updatePassword(e,t){return this._request.send("auth.updatePassword",{oldPassword:t,newPassword:e})}updateEmail(e){return this._request.send("auth.updateEmail",{newEmail:e})}updateUsername(e){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"username must be a string"});return this._request.send("auth.updateUsername",{username:e})}getLinkedUidList(){return A(this,null,function*(){let{data:e}=yield this._request.send("auth.getLinkedUidList",{}),t=!1,{users:i}=e;return i.forEach(o=>{o.wxOpenId&&o.wxPublicId&&(t=!0)}),{users:i,hasPrimaryUid:t}})}setPrimaryUid(e){return this._request.send("auth.setPrimaryUid",{uid:e})}unlink(e){return this._request.send("auth.unlink",{platform:e})}update(e){return A(this,null,function*(){let{nickName:t,gender:i,avatarUrl:o,province:s,country:r,city:a}=e,{data:l}=yield this._request.send("auth.updateUserInfo",{nickName:t,gender:i,avatarUrl:o,province:s,country:r,city:a});this.setLocalUserInfo(l)})}refresh(){return A(this,null,function*(){let{data:e}=yield this._request.send("auth.getUserInfo",{});return this.setLocalUserInfo(e),e})}setUserInfo(){let{userInfoKey:e}=this._cache.keys,t=this._cache.getStore(e);["uid","loginType","openid","wxOpenId","wxPublicId","unionId","qqMiniOpenId","email","hasPassword","customUserId","nickName","gender","avatarUrl"].forEach(i=>{this[i]=t[i]}),this.location={country:t.country,province:t.province,city:t.city}}setLocalUserInfo(e){let{userInfoKey:t}=this._cache.keys;this._cache.setStore(t,e),this.setUserInfo()}},Oe=class{constructor(e){if(!e)throw new P({code:"PARAM_ERROR",message:"envId is not defined"});this._cache=Ze(e);let{refreshTokenKey:t,accessTokenKey:i,accessTokenExpireKey:o}=this._cache.keys,s=this._cache.getStore(t),r=this._cache.getStore(i),a=this._cache.getStore(o);this.credential={refreshToken:s,accessToken:r,accessTokenExpire:a},this.user=new Ut(e)}get isAnonymousAuth(){return this.loginType===K.ANONYMOUS}get isCustomAuth(){return this.loginType===K.CUSTOM}get isWeixinAuth(){return this.loginType===K.WECHAT||this.loginType===K.WECHAT_OPEN||this.loginType===K.WECHAT_PUBLIC}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}},We=class extends Ue{signIn(){return A(this,null,function*(){this._cache.updatePersistence("local");let{anonymousUuidKey:e,refreshTokenKey:t}=this._cache.keys,i=this._cache.getStore(e)||void 0,o=this._cache.getStore(t)||void 0,s=yield this._request.send("auth.signInAnonymously",{anonymous_uuid:i,refresh_token:o});if(s.uuid&&s.refresh_token){this._setAnonymousUUID(s.uuid),this.setRefreshToken(s.refresh_token),yield this._request.refreshAccessToken(),X(Ne),X(Te,{env:this.config.env,loginType:K.ANONYMOUS,persistence:"local"});let r=new Oe(this.config.env);return yield r.user.refresh(),r}throw new P({message:"\u533F\u540D\u767B\u5F55\u5931\u8D25"})})}linkAndRetrieveDataWithTicket(e){return A(this,null,function*(){let{anonymousUuidKey:t,refreshTokenKey:i}=this._cache.keys,o=this._cache.getStore(t),s=this._cache.getStore(i),r=yield this._request.send("auth.linkAndRetrieveDataWithTicket",{anonymous_uuid:o,refresh_token:s,ticket:e});if(r.refresh_token)return this._clearAnonymousUUID(),this.setRefreshToken(r.refresh_token),yield this._request.refreshAccessToken(),X(Rt,{env:this.config.env}),X(Te,{loginType:K.CUSTOM,persistence:"local"}),{credential:{refreshToken:r.refresh_token}};throw new P({message:"\u533F\u540D\u8F6C\u5316\u5931\u8D25"})})}_setAnonymousUUID(e){let{anonymousUuidKey:t,loginTypeKey:i}=this._cache.keys;this._cache.removeStore(t),this._cache.setStore(t,e),this._cache.setStore(i,K.ANONYMOUS)}_clearAnonymousUUID(){this._cache.removeStore(this._cache.keys.anonymousUuidKey)}},dt=class extends Ue{signIn(e){return A(this,null,function*(){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"ticket must be a string"});let{refreshTokenKey:t}=this._cache.keys,i=yield this._request.send("auth.signInWithTicket",{ticket:e,refresh_token:this._cache.getStore(t)||""});if(i.refresh_token)return this.setRefreshToken(i.refresh_token),yield this._request.refreshAccessToken(),X(Ne),X(Te,{env:this.config.env,loginType:K.CUSTOM,persistence:this.config.persistence}),yield this.refreshUserInfo(),new Oe(this.config.env);throw new P({message:"\u81EA\u5B9A\u4E49\u767B\u5F55\u5931\u8D25"})})}},ft=class extends Ue{signIn(e,t){return A(this,null,function*(){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"email must be a string"});let{refreshTokenKey:i}=this._cache.keys,o=yield this._request.send("auth.signIn",{loginType:"EMAIL",email:e,password:t,refresh_token:this._cache.getStore(i)||""}),{refresh_token:s,access_token:r,access_token_expire:a}=o;if(s)return this.setRefreshToken(s),r&&a?this.setAccessToken(r,a):yield this._request.refreshAccessToken(),yield this.refreshUserInfo(),X(Ne),X(Te,{env:this.config.env,loginType:K.EMAIL,persistence:this.config.persistence}),new Oe(this.config.env);throw o.code?new P({code:o.code,message:`\u90AE\u7BB1\u767B\u5F55\u5931\u8D25: ${o.message}`}):new P({message:"\u90AE\u7BB1\u767B\u5F55\u5931\u8D25"})})}activate(e){return A(this,null,function*(){return this._request.send("auth.activateEndUserMail",{token:e})})}resetPasswordWithToken(e,t){return A(this,null,function*(){return this._request.send("auth.resetPasswordWithToken",{token:e,newPassword:t})})}},ht=class extends Ue{signIn(e,t){return A(this,null,function*(){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"username must be a string"});typeof t!="string"&&(t="",console.warn("password is empty"));let{refreshTokenKey:i}=this._cache.keys,o=yield this._request.send("auth.signIn",{loginType:K.USERNAME,username:e,password:t,refresh_token:this._cache.getStore(i)||""}),{refresh_token:s,access_token_expire:r,access_token:a}=o;if(s)return this.setRefreshToken(s),a&&r?this.setAccessToken(a,r):yield this._request.refreshAccessToken(),yield this.refreshUserInfo(),X(Ne),X(Te,{env:this.config.env,loginType:K.USERNAME,persistence:this.config.persistence}),new Oe(this.config.env);throw o.code?new P({code:o.code,message:`\u7528\u6237\u540D\u5BC6\u7801\u767B\u5F55\u5931\u8D25: ${o.message}`}):new P({message:"\u7528\u6237\u540D\u5BC6\u7801\u767B\u5F55\u5931\u8D25"})})}},jt=class{constructor(e){this.config=e,this._cache=Ze(e.env),this._request=ve(e.env),this._onAnonymousConverted=this._onAnonymousConverted.bind(this),this._onLoginTypeChanged=this._onLoginTypeChanged.bind(this),xe(Te,this._onLoginTypeChanged)}get currentUser(){let e=this.hasLoginState();return e&&e.user||null}get loginType(){return this._cache.getStore(this._cache.keys.loginTypeKey)}anonymousAuthProvider(){return new We(this.config)}customAuthProvider(){return new dt(this.config)}emailAuthProvider(){return new ft(this.config)}usernameAuthProvider(){return new ht(this.config)}signInAnonymously(){return A(this,null,function*(){return new We(this.config).signIn()})}signInWithEmailAndPassword(e,t){return A(this,null,function*(){return new ft(this.config).signIn(e,t)})}signInWithUsernameAndPassword(e,t){return new ht(this.config).signIn(e,t)}linkAndRetrieveDataWithTicket(e){return A(this,null,function*(){return this._anonymousAuthProvider||(this._anonymousAuthProvider=new We(this.config)),xe(Rt,this._onAnonymousConverted),yield this._anonymousAuthProvider.linkAndRetrieveDataWithTicket(e)})}signOut(){return A(this,null,function*(){if(this.loginType===K.ANONYMOUS)throw new P({message:"\u533F\u540D\u7528\u6237\u4E0D\u652F\u6301\u767B\u51FA\u64CD\u4F5C"});let{refreshTokenKey:e,accessTokenKey:t,accessTokenExpireKey:i}=this._cache.keys,o=this._cache.getStore(e);if(!o)return;let s=yield this._request.send("auth.logout",{refresh_token:o});return this._cache.removeStore(e),this._cache.removeStore(t),this._cache.removeStore(i),X(Ne),X(Te,{env:this.config.env,loginType:K.NULL,persistence:this.config.persistence}),s})}signUpWithEmailAndPassword(e,t){return A(this,null,function*(){return this._request.send("auth.signUpWithEmailAndPassword",{email:e,password:t})})}sendPasswordResetEmail(e){return A(this,null,function*(){return this._request.send("auth.sendPasswordResetEmail",{email:e})})}onLoginStateChanged(e){xe(Ne,()=>{let i=this.hasLoginState();e.call(this,i)});let t=this.hasLoginState();e.call(this,t)}onLoginStateExpired(e){xe(ri,e.bind(this))}onAccessTokenRefreshed(e){xe(ci,e.bind(this))}onAnonymousConverted(e){xe(Rt,e.bind(this))}onLoginTypeChanged(e){xe(Te,()=>{let t=this.hasLoginState();e.call(this,t)})}getAccessToken(){return A(this,null,function*(){return{accessToken:(yield this._request.getAccessToken()).accessToken,env:this.config.env}})}hasLoginState(){let{refreshTokenKey:e}=this._cache.keys;return this._cache.getStore(e)?new Oe(this.config.env):null}isUsernameRegistered(e){return A(this,null,function*(){if(typeof e!="string")throw new P({code:"PARAM_ERROR",message:"username must be a string"});let{data:t}=yield this._request.send("auth.isUsernameRegistered",{username:e});return t&&t.isRegistered})}getLoginState(){return Promise.resolve(this.hasLoginState())}signInWithTicket(e){return A(this,null,function*(){return new dt(this.config).signIn(e)})}shouldRefreshAccessToken(e){this._request._shouldRefreshAccessTokenHook=e.bind(this)}getUserInfo(){return this._request.send("auth.getUserInfo",{}).then(e=>e.code?e:ne(B({},e.data),{requestId:e.seqId}))}getAuthHeader(){let{refreshTokenKey:e,accessTokenKey:t}=this._cache.keys,i=this._cache.getStore(e);return{"x-cloudbase-credentials":this._cache.getStore(t)+"/@@/"+i}}_onAnonymousConverted(e){let{env:t}=e.data;t===this.config.env&&this._cache.updatePersistence(this.config.persistence)}_onLoginTypeChanged(e){let{loginType:t,persistence:i,env:o}=e.data;o===this.config.env&&(this._cache.updatePersistence(i),this._cache.setStore(this._cache.keys.loginTypeKey,t))}},Do=function(n,e){e=e||Qe();let t=ve(this.config.env),{cloudPath:i,filePath:o,onUploadProgress:s,fileType:r="image"}=n;return t.send("storage.getUploadMetadata",{path:i}).then(a=>{let{data:{url:l,authorization:c,token:_,fileId:u,cosFileId:v},requestId:h}=a,m={key:i,signature:c,"x-cos-meta-fileid":v,success_action_status:"201","x-cos-security-token":_};t.upload({url:l,data:m,file:o,name:i,fileType:r,onUploadProgress:s}).then(f=>{f.statusCode===201?e(null,{fileID:u,requestId:h}):e(new P({code:"STORAGE_REQUEST_FAIL",message:`STORAGE_REQUEST_FAIL: ${f.data}`}))}).catch(f=>{e(f)})}).catch(a=>{e(a)}),e.promise},Mo=function(n,e){e=e||Qe();let t=ve(this.config.env),{cloudPath:i}=n;return t.send("storage.getUploadMetadata",{path:i}).then(o=>{e(null,o)}).catch(o=>{e(o)}),e.promise},Ro=function({fileList:n},e){if(e=e||Qe(),!n||!Array.isArray(n))return{code:"INVALID_PARAM",message:"fileList\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u6570\u7EC4"};for(let i of n)if(!i||typeof i!="string")return{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"};let t={fileid_list:n};return ve(this.config.env).send("storage.batchDeleteFile",t).then(i=>{i.code?e(null,i):e(null,{fileList:i.data.delete_list,requestId:i.requestId})}).catch(i=>{e(i)}),e.promise},ui=function({fileList:n},e){e=e||Qe(),n&&Array.isArray(n)||e(null,{code:"INVALID_PARAM",message:"fileList\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u6570\u7EC4"});let t=[];for(let o of n)typeof o=="object"?(o.hasOwnProperty("fileID")&&o.hasOwnProperty("maxAge")||e(null,{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u5305\u542BfileID\u548CmaxAge\u7684\u5BF9\u8C61"}),t.push({fileid:o.fileID,max_age:o.maxAge})):typeof o=="string"?t.push({fileid:o}):e(null,{code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u5B57\u7B26\u4E32"});let i={file_list:t};return ve(this.config.env).send("storage.batchGetDownloadUrl",i).then(o=>{o.code?e(null,o):e(null,{fileList:o.data.download_list,requestId:o.requestId})}).catch(o=>{e(o)}),e.promise},No=function(t,i){return A(this,arguments,function*({fileID:n},e){let o=(yield ui.call(this,{fileList:[{fileID:n,maxAge:600}]})).fileList[0];if(o.code!=="SUCCESS")return e?e(o):new Promise(a=>{a(o)});let s=ve(this.config.env),r=o.download_url;if(r=encodeURI(r),!e)return s.download({url:r});e(yield s.download({url:r}))})},Uo=function({name:n,data:e,query:t,parse:i,search:o},s){let r=s||Qe(),a;try{a=e?JSON.stringify(e):""}catch(c){return Promise.reject(c)}if(!n)return Promise.reject(new P({code:"PARAM_ERROR",message:"\u51FD\u6570\u540D\u4E0D\u80FD\u4E3A\u7A7A"}));let l={inQuery:t,parse:i,search:o,function_name:n,request_data:a};return ve(this.config.env).send("functions.invokeFunction",l).then(c=>{if(c.code)r(null,c);else{let _=c.data.response_data;if(i)r(null,{result:_,requestId:c.requestId});else try{_=JSON.parse(c.data.response_data),r(null,{result:_,requestId:c.requestId})}catch(u){r(new P({message:"response data must be json"}))}}return r.promise}).catch(c=>{r(c)}),r.promise},xn={timeout:15e3,persistence:"session"},Sn={},Ve=class{constructor(e){this.config=e||this.config,this.authObj=void 0}init(e){switch(Y.adapter||(this.requestClient=new Y.adapter.reqClass({timeout:e.timeout||5e3,timeoutMsg:`\u8BF7\u6C42\u5728${(e.timeout||5e3)/1e3}s\u5185\u672A\u5B8C\u6210\uFF0C\u5DF2\u4E2D\u65AD`})),this.config=B(B({},xn),e),!0){case this.config.timeout>6e5:console.warn("timeout\u5927\u4E8E\u53EF\u914D\u7F6E\u4E0A\u9650[10\u5206\u949F]\uFF0C\u5DF2\u91CD\u7F6E\u4E3A\u4E0A\u9650\u6570\u503C"),this.config.timeout=6e5;break;case this.config.timeout<100:console.warn("timeout\u5C0F\u4E8E\u53EF\u914D\u7F6E\u4E0B\u9650[100ms]\uFF0C\u5DF2\u91CD\u7F6E\u4E3A\u4E0B\u9650\u6570\u503C"),this.config.timeout=100}return new Ve(this.config)}auth({persistence:e}={}){if(this.authObj)return this.authObj;let t=e||Y.adapter.primaryStorage||xn.persistence;var i;return t!==this.config.persistence&&(this.config.persistence=t),function(o){let{env:s}=o;si[s]=new lt(o),ai[s]=new lt(ne(B({},o),{persistence:"local"}))}(this.config),i=this.config,li[i.env]=new Nt(i),this.authObj=new jt(this.config),this.authObj}on(e,t){return xe.apply(this,[e,t])}off(e,t){return Oo.apply(this,[e,t])}callFunction(e,t){return Uo.apply(this,[e,t])}deleteFile(e,t){return Ro.apply(this,[e,t])}getTempFileURL(e,t){return ui.apply(this,[e,t])}downloadFile(e,t){return No.apply(this,[e,t])}uploadFile(e,t){return Do.apply(this,[e,t])}getUploadMetadata(e,t){return Mo.apply(this,[e,t])}registerExtension(e){Sn[e.name]=e}invokeExtension(e,t){return A(this,null,function*(){let i=Sn[e];if(!i)throw new P({message:`\u6269\u5C55${e} \u5FC5\u987B\u5148\u6CE8\u518C`});return yield i.invoke(t,this)})}useAdapters(e){let{adapter:t,runtime:i}=Po(e)||{};t&&(Y.adapter=t),i&&(Y.runtime=i)}},di=new Ve;function Tn(n,e,t){t===void 0&&(t={});var i=/\?/.test(e),o="";for(var s in t)o===""?!i&&(e+="?"):o+="&",o+=s+"="+encodeURIComponent(t[s]);return/^http(s)?:\/\//.test(e+=o)?e:""+n+e}var Bt=class{post(e){let{url:t,data:i,headers:o}=e;return new Promise((s,r)=>{Z.request({url:Tn("https:",t),data:i,method:"POST",header:o,success(a){s(a)},fail(a){r(a)}})})}upload(e){return new Promise((t,i)=>{let{url:o,file:s,data:r,headers:a,fileType:l}=e,c=Z.uploadFile({url:Tn("https:",o),name:"file",formData:Object.assign({},r),filePath:s,fileType:l,header:a,success(_){let u={statusCode:_.statusCode,data:_.data||{}};_.statusCode===200&&r.success_action_status&&(u.statusCode=parseInt(r.success_action_status,10)),t(u)},fail(_){i(new Error(_.errMsg||"uploadFile:fail"))}});typeof e.onUploadProgress=="function"&&c&&typeof c.onProgressUpdate=="function"&&c.onProgressUpdate(_=>{e.onUploadProgress({loaded:_.totalBytesSent,total:_.totalBytesExpectedToSend})})})}},jo={setItem(n,e){Z.setStorageSync(n,e)},getItem:n=>Z.getStorageSync(n),removeItem(n){Z.removeStorageSync(n)},clear(){Z.clearStorageSync()}},Bo={genAdapter:function(){return{root:{},reqClass:Bt,localStorage:jo,primaryStorage:"local"}},isMatch:function(){return!0},runtime:"uni_app"};di.useAdapters(Bo);var Yt=di,Fo=Yt.init;Yt.init=function(n){n.env=n.spaceId;let e=Fo.call(this,n);e.config.provider="tencent",e.config.spaceId=n.spaceId;let t=e.auth;return e.auth=function(i){let o=t.call(this,i);return["linkAndRetrieveDataWithTicket","signInAnonymously","signOut","getAccessToken","getLoginState","signInWithTicket","getUserInfo"].forEach(s=>{var r;o[s]=(r=o[s],function(a){a=a||{};let{success:l,fail:c,complete:_}=Xn(a);if(!(l||c||_))return r.call(this,a);r.call(this,a).then(u=>{l&&l(u),_&&_(u)},u=>{c&&c(u),_&&_(u)})}).bind(o)}),o},e.customAuth=e.auth,e};var In=Yt,qo=class extends oi{getAccessToken(){return new Promise((n,e)=>{let t="Anonymous_Access_token";this.setAccessToken(t),n(t)})}setupRequest(n,e){let t=Object.assign({},n,{spaceId:this.config.spaceId,timestamp:Date.now()}),i={"Content-Type":"application/json"};e!=="auth"&&(t.token=this.accessToken,i["x-basement-token"]=this.accessToken),i["x-serverless-sign"]=qe.sign(t,this.config.clientSecret);let o=ii();i["x-client-info"]=encodeURIComponent(JSON.stringify(o));let{token:s}=_t();return i["x-client-token"]=s,{url:this.config.requestUrl,method:"POST",data:t,dataType:"json",header:JSON.parse(JSON.stringify(i))}}uploadFileToOSS({url:n,formData:e,name:t,filePath:i,fileType:o,onUploadProgress:s}){return new Promise((r,a)=>{let l=this.adapter.uploadFile({url:n,formData:e,name:t,filePath:i,fileType:o,success(c){c&&c.statusCode<400?r(c):a(new P({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(c){a(new P({code:c.code||"UPLOAD_FAILED",message:c.message||c.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof s=="function"&&l&&typeof l.onProgressUpdate=="function"&&l.onProgressUpdate(c=>{s({loaded:c.totalBytesSent,total:c.totalBytesExpectedToSend})})})}uploadFile({filePath:n,cloudPath:e,fileType:t="image",onUploadProgress:i}){if(!e)throw new P({code:"CLOUDPATH_REQUIRED",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});let o;return this.getOSSUploadOptionsFromPath({cloudPath:e}).then(s=>{let{url:r,formData:a,name:l}=s.result;o=s.result.fileUrl;let c={url:r,formData:a,name:l,filePath:n,fileType:t};return this.uploadFileToOSS(Object.assign({},c,{onUploadProgress:i}))}).then(()=>this.reportOSSUpload({cloudPath:e})).then(s=>new Promise((r,a)=>{s.success?r({success:!0,filePath:n,fileID:o}):a(new P({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}))}deleteFile({fileList:n}){let e={method:"serverless.file.resource.delete",params:JSON.stringify({fileList:n})};return this.request(this.setupRequest(e)).then(t=>{if(t.success)return t.result;throw new P({code:"DELETE_FILE_FAILED",message:"\u5220\u9664\u6587\u4EF6\u5931\u8D25"})})}getTempFileURL({fileList:n,maxAge:e}={}){if(!Array.isArray(n)||n.length===0)throw new P({code:"INVALID_PARAM",message:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"});let t={method:"serverless.file.resource.getTempFileURL",params:JSON.stringify({fileList:n,maxAge:e})};return this.request(this.setupRequest(t)).then(i=>{if(i.success)return{fileList:i.result.fileList.map(o=>({fileID:o.fileID,tempFileURL:o.tempFileURL}))};throw new P({code:"GET_TEMP_FILE_URL_FAILED",message:"\u83B7\u53D6\u4E34\u65F6\u6587\u4EF6\u94FE\u63A5\u5931\u8D25"})})}},Ho={init(n){let e=new qo(n),t={signInAnonymously:function(){return e.authorize()},getLoginState:function(){return Promise.resolve(!1)}};return e.auth=function(){return t},e.customAuth=e.auth,e}},Pt=fe(function(n,e){n.exports=Se.enc.Hex});function fi(n="",e={}){let{data:t,functionName:i,method:o,headers:s,signHeaderKeys:r=[],config:a}=e,l=Date.now(),c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var d=16*Math.random()|0;return(f==="x"?d:3&d|8).toString(16)}),_=Object.assign({},s,{"x-from-app-id":a.spaceAppId,"x-from-env-id":a.spaceId,"x-to-env-id":a.spaceId,"x-from-instance-id":l,"x-from-function-name":i,"x-client-timestamp":l,"x-alipay-source":"client","x-request-id":c,"x-alipay-callid":c}),u=["x-from-app-id","x-from-env-id","x-to-env-id","x-from-instance-id","x-from-function-name","x-client-timestamp"].concat(r),[v="",h=""]=n.split("?")||[],m=function(f){let d=f.signedHeaders.join(";"),b=f.signedHeaders.map(M=>`${M.toLowerCase()}:${f.headers[M]}
`).join(""),x=wn(f.body).toString(Pt),g=`${f.method.toUpperCase()}
${f.path}
${f.query}
${b}
${d}
${x}
`,p=wn(g).toString(Pt),y=`HMAC-SHA256
${f.timestamp}
${p}
`,w=Io(y,f.secretKey).toString(Pt);return`HMAC-SHA256 Credential=${f.secretId}, SignedHeaders=${d}, Signature=${w}`}({path:v,query:h,method:o,headers:_,timestamp:l,body:JSON.stringify(t),secretId:a.accessKey,secretKey:a.secretKey,signedHeaders:u.sort()});return{url:`${a.endpoint}${n}`,headers:Object.assign({},_,{Authorization:m})}}function hi({url:n,data:e,method:t="POST",headers:i={}}){return new Promise((o,s)=>{Z.request({url:n,method:t,data:e,header:i,dataType:"json",complete:(r={})=>{if(!r.statusCode||r.statusCode>=400){let{errMsg:a}=r.data||{};return s(new P({code:"SYS_ERR",message:a||r.errMsg||"request:fail",requestId:r.requestID}))}o({status:r.statusCode,data:r.data,headers:r.header,requestId:r.requestID})}})})}function An(n,e){let{path:t,data:i,method:o="GET"}=n,{url:s,headers:r}=fi(t,{functionName:"",data:i,method:o,headers:{"x-alipay-cloud-mode":"oss","x-data-api-type":"oss","x-expire-timestamp":Date.now()+6e4},signHeaderKeys:["x-data-api-type","x-expire-timestamp"],config:e});return hi({url:s,data:i,method:o,headers:r}).then(a=>{let l=a.data||{};if(!l.success)throw new P({code:a.code,message:a.message,requestId:a.trace_id});return l.data||{}}).catch(a=>{throw new P({code:a.errCode,message:a.errMsg,requestId:a.requestId})})}function Wo(n=""){let e=n.trim().replace(/^cloud:\/\//,""),t=e.indexOf("/");if(t<=0)throw new P({code:"INVALID_PARAM",message:"fileID\u4E0D\u5408\u6CD5"});let i=e.substring(0,t),o=e.substring(t+1);return i!==this.config.spaceId&&console.warn("file ".concat(n," does not belong to env ").concat(this.config.spaceId)),o}var zo=class{constructor(n){if(["spaceId","spaceAppId","accessKey","secretKey"].forEach(e=>{if(!Object.prototype.hasOwnProperty.call(n,e))throw new Error(`${e} required`)}),n.endpoint){if(typeof n.endpoint!="string")throw new Error("endpoint must be string");if(!/^https:\/\//.test(n.endpoint))throw new Error("endpoint must start with https://");n.endpoint=n.endpoint.replace(/\/$/,"")}this.config=Object.assign({},n,{endpoint:n.endpoint||`https://${n.spaceId}.api-hz.cloudbasefunction.cn`})}callFunction(n){return function(e,t){let{name:i,data:o}=e,s="POST",{url:r,headers:a}=fi("/functions/invokeFunction",{functionName:i,data:o,method:s,headers:{"x-to-function-name":i},signHeaderKeys:["x-to-function-name"],config:t});return hi({url:r,data:o,method:s,headers:a}).then(l=>({errCode:0,success:!0,requestId:l.requestId,result:l.data})).catch(l=>{throw new P({code:l.errCode,message:l.errMsg,requestId:l.requestId})})}(n,this.config)}uploadFileToOSS({url:n,filePath:e,fileType:t,formData:i,onUploadProgress:o}){return new Promise((s,r)=>{let a=Z.uploadFile({url:n,filePath:e,fileType:t,formData:i,name:"file",success(l){l&&l.statusCode<400?s(l):r(new P({code:"UPLOAD_FAILED",message:"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))},fail(l){r(new P({code:l.code||"UPLOAD_FAILED",message:l.message||l.errMsg||"\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"}))}});typeof o=="function"&&a&&typeof a.onProgressUpdate=="function"&&a.onProgressUpdate(l=>{o({loaded:l.totalBytesSent,total:l.totalBytesExpectedToSend})})})}uploadFile(o){return A(this,arguments,function*({filePath:n,cloudPath:e="",fileType:t="image",onUploadProgress:i}){if(Je(e)!=="string")throw new P({code:"INVALID_PARAM",message:"cloudPath\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u7C7B\u578B"});if(!(e=e.trim()))throw new P({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u53EF\u4E3A\u7A7A"});if(/:\/\//.test(e))throw new P({code:"INVALID_PARAM",message:"cloudPath\u4E0D\u5408\u6CD5"});let s=yield An({path:"/".concat(e.replace(/^\//,""),"?post_url")},this.config),{file_id:r,upload_url:a,form_data:l}=s,c=l&&l.reduce((_,u)=>(_[u.key]=u.value,_),{});return this.uploadFileToOSS({url:a,filePath:n,fileType:t,formData:c,onUploadProgress:i}).then(()=>({fileID:r}))})}getTempFileURL(e){return A(this,arguments,function*({fileList:n}){return new Promise((t,i)=>{(!n||n.length<0)&&i(new P({errCode:"INVALID_PARAM",errMsg:"fileList\u4E0D\u80FD\u4E3A\u7A7A\u6570\u7EC4"})),n.length>50&&i(new P({errCode:"INVALID_PARAM",errMsg:"fileList\u6570\u7EC4\u957F\u5EA6\u4E0D\u80FD\u8D85\u8FC750"}));let o=[];for(let s of n){Je(s)!=="string"&&i(new P({errCode:"INVALID_PARAM",errMsg:"fileList\u7684\u5143\u7D20\u5FC5\u987B\u662F\u975E\u7A7A\u7684\u5B57\u7B26\u4E32"}));let r=Wo.call(this,s);o.push({file_id:r,expire:600})}An({path:"/?download_url",data:{file_list:o},method:"POST"},this.config).then(s=>{let{file_list:r=[]}=s;t({fileList:r.map(a=>({fileID:a.file_id,tempFileURL:a.download_url}))})}).catch(s=>i(s))})})}},Jo={init:n=>{n.provider="alipay";let e=new zo(n);return e.auth=function(){return{signInAnonymously:function(){return Promise.resolve()},getLoginState:function(){return Promise.resolve(!0)}}},e}};function Vo({data:n}){let e;e=ii();let t=JSON.parse(JSON.stringify(n||{}));if(Object.assign(t,{clientInfo:e}),!t.uniIdToken){let{token:i}=_t();i&&(t.uniIdToken=i)}return t}var Ko=[{rule:/fc_function_not_found|FUNCTION_NOT_FOUND/,content:"\uFF0C\u4E91\u51FD\u6570[{functionName}]\u5728\u4E91\u7AEF\u4E0D\u5B58\u5728\uFF0C\u8BF7\u68C0\u67E5\u6B64\u4E91\u51FD\u6570\u540D\u79F0\u662F\u5426\u6B63\u786E\u4EE5\u53CA\u8BE5\u4E91\u51FD\u6570\u662F\u5426\u5DF2\u4E0A\u4F20\u5230\u670D\u52A1\u7A7A\u95F4",mode:"append"}],gi=/[\\^$.*+?()[\]{}|]/g,Go=RegExp(gi.source);function Cn(n,e,t){return n.replace(new RegExp((i=e)&&Go.test(i)?i.replace(gi,"\\$&"):i,"g"),t);var i}var Yo="request",$o="response",Qo="both",Zo={code:2e4,message:"System error"},Xo={code:20101,message:"Invalid client"};function mi(n){let{errSubject:e,subject:t,errCode:i,errMsg:o,code:s,message:r,cause:a}=n||{};return new P({subject:e||t||"uni-secure-network",code:i||s||Zo.code,message:o||r,cause:a})}var Ft;function Pn({secretType:n}={}){return n===Yo||n===$o||n===Qo}function Ln({name:n,data:e={}}={}){return n==="DCloud-clientDB"&&e.redirectTo==="encryption"&&e.action==="getAppClientKey"}function es({provider:n,spaceId:e,functionName:t}={}){let{appId:i,uniPlatform:o,osName:s}=ni(),r=o;o==="app"&&(r=s);let a=function({provider:u,spaceId:v}={}){let h=po;if(!h)return{};u=function(f){return f==="tencent"?"tcb":f}(u);let m=h.find(f=>f.provider===u&&f.spaceId===v);return m&&m.config}({provider:n,spaceId:e});if(!a||!a.accessControl||!a.accessControl.enable)return!1;let l=a.accessControl.function||{},c=Object.keys(l);if(c.length===0)return!0;let _=function(u,v){let h,m,f;for(let d=0;d<u.length;d++){let b=u[d];b!==v?b!=="*"?b.split(",").map(x=>x.trim()).indexOf(v)>-1&&(m=b):f=b:h=b}return h||m||f}(c,t);if(!_)return!1;if((l[_]||[]).find((u={})=>u.appId===i&&(u.platform||"").toLowerCase()===r.toLowerCase()))return!0;throw console.error(`\u6B64\u5E94\u7528[appId: ${i}, platform: ${r}]\u4E0D\u5728\u4E91\u7AEF\u914D\u7F6E\u7684\u5141\u8BB8\u8BBF\u95EE\u7684\u5E94\u7528\u5217\u8868\u5185\uFF0C\u53C2\u8003\uFF1Ahttps://uniapp.dcloud.net.cn/uniCloud/secure-network.html#verify-client`),mi(Xo)}function On({functionName:n,result:e,logPvd:t}){}function ts(n){let e=n.callFunction,t=function(i){let o=i.name;i.data=Vo.call(n,{data:i.data});let s={aliyun:"aliyun",tencent:"tcb",tcb:"tcb",alipay:"alipay"}[this.config.provider],r=Pn(i),a=Ln(i),l=r||a;return e.call(this,i).then(c=>(c.errCode=0,!l&&On.call(this,{functionName:o,result:c,logPvd:s}),Promise.resolve(c)),c=>(!l&&On.call(this,{functionName:o,result:c,logPvd:s}),c&&c.message&&(c.message=function({message:_="",extraInfo:u={},formatter:v=[]}={}){for(let h=0;h<v.length;h++){let{rule:m,content:f,mode:d}=v[h],b=_.match(m);if(!b)continue;let x=f;for(let g=1;g<b.length;g++)x=Cn(x,`{$${g}}`,b[g]);for(let g in u)x=Cn(x,`{${g}}`,u[g]);return d==="replace"?x:_+x}return _}({message:`[${i.name}]: ${c.message}`,formatter:Ko,extraInfo:{functionName:o}})),Promise.reject(c)))};n.callFunction=function(i){let{provider:o,spaceId:s}=n.config,r=i.name,a,l;return i.data=i.data||{},a=t,a=a.bind(n),Ln(i)?l=t.call(n,i):Pn(i)?l=new Ft({secretType:i.secretType,uniCloudIns:n}).wrapEncryptDataCallFunction(t.bind(n))(i):es({provider:o,spaceId:s,functionName:r})?l=new Ft({secretType:i.secretType,uniCloudIns:n}).wrapVerifyClientCallFunction(t.bind(n))(i):l=a(i),Object.defineProperty(l,"result",{get:()=>(console.warn("\u5F53\u524D\u8FD4\u56DE\u7ED3\u679C\u4E3APromise\u7C7B\u578B\uFF0C\u4E0D\u53EF\u76F4\u63A5\u8BBF\u95EE\u5176result\u5C5E\u6027\uFF0C\u8BE6\u60C5\u8BF7\u53C2\u8003\uFF1Ahttps://uniapp.dcloud.net.cn/uniCloud/faq?id=promise"),{})}),l}}Ft=class{constructor(){throw mi({message:`Platform ${Yn} is not enabled, please check whether secure network module is enabled in your manifest.json`})}};var pi=Symbol("CLIENT_DB_INTERNAL");function gt(n,e){return n.then="DoNotReturnProxyWithAFunctionNamedThen",n._internalType=pi,n.inspect=null,n.__v_raw=void 0,new Proxy(n,{get(t,i,o){if(i==="_uniClient")return null;if(typeof i=="symbol")return t[i];if(i in t||typeof i!="string"){let s=t[i];return typeof s=="function"?s.bind(t):s}return e.get(t,i,o)}})}function En(n){return{on:(e,t)=>{n[e]=n[e]||[],n[e].indexOf(t)>-1||n[e].push(t)},off:(e,t)=>{n[e]=n[e]||[];let i=n[e].indexOf(t);i!==-1&&n[e].splice(i,1)}}}var ns=["db.Geo","db.command","command.aggregate"];function _i(n,e){return ns.indexOf(`${n}.${e}`)>-1}function Le(n){switch(Je(n=ei(n))){case"array":return n.map(e=>Le(e));case"object":return n._internalType===pi||Object.keys(n).forEach(e=>{n[e]=Le(n[e])}),n;case"regexp":return{$regexp:{source:n.source,flags:n.flags}};case"date":return{$date:n.toISOString()};default:return n}}function Be(n){return n&&n.content&&n.content.$method}var qt=class{constructor(e,t,i){this.content=e,this.prevStage=t||null,this.udb=null,this._database=i}toJSON(){let e=this,t=[e.content];for(;e.prevStage;)e=e.prevStage,t.push(e.content);return{$db:t.reverse().map(i=>({$method:i.$method,$param:Le(i.$param)}))}}toString(){return JSON.stringify(this.toJSON())}getAction(){let e=this.toJSON().$db.find(t=>t.$method==="action");return e&&e.$param&&e.$param[0]}getCommand(){return{$db:this.toJSON().$db.filter(e=>e.$method!=="action")}}get isAggregate(){let e=this;for(;e;){let t=Be(e),i=Be(e.prevStage);if(t==="aggregate"&&i==="collection"||t==="pipeline")return!0;e=e.prevStage}return!1}get isCommand(){let e=this;for(;e;){if(Be(e)==="command")return!0;e=e.prevStage}return!1}get isAggregateCommand(){let e=this;for(;e;){let t=Be(e),i=Be(e.prevStage);if(t==="aggregate"&&i==="command")return!0;e=e.prevStage}return!1}getNextStageFn(e){let t=this;return function(){return Ke({$method:e,$param:Le(Array.from(arguments))},t,t._database)}}get count(){return this.isAggregate?this.getNextStageFn("count"):function(){return this._send("count",Array.from(arguments))}}get remove(){return this.isCommand?this.getNextStageFn("remove"):function(){return this._send("remove",Array.from(arguments))}}get(){return this._send("get",Array.from(arguments))}get add(){return this.isCommand?this.getNextStageFn("add"):function(){return this._send("add",Array.from(arguments))}}update(){return this._send("update",Array.from(arguments))}end(){return this._send("end",Array.from(arguments))}get set(){return this.isCommand?this.getNextStageFn("set"):function(){throw new Error("JQL\u7981\u6B62\u4F7F\u7528set\u65B9\u6CD5")}}_send(e,t){let i=this.getAction(),o=this.getCommand();return o.$db.push({$method:e,$param:Le(t)}),this._database._callCloudFunction({action:i,command:o})}};function Ke(n,e,t){return gt(new qt(n,e,t),{get(i,o){let s="db";return i&&i.content&&(s=i.content.$method),_i(s,o)?Ke({$method:o},i,t):function(){return Ke({$method:o,$param:Le(Array.from(arguments))},i,t)}}})}function Lt({path:n,method:e}){return class{constructor(){this.param=Array.from(arguments)}toJSON(){return{$newDb:[...n.map(t=>({$method:t})),{$method:e,$param:this.param}]}}toString(){return JSON.stringify(this.toJSON())}}}function Dn(n,e={}){return gt(new n(e),{get:(t,i)=>_i("db",i)?Ke({$method:i},null,t):function(){return Ke({$method:i,$param:Le(Array.from(arguments))},null,t)}})}var mt=class extends class{constructor({uniClient:e={},isJQL:t=!1}={}){this._uniClient=e,this._authCallBacks={},this._dbCallBacks={},e._isDefault&&(this._dbCallBacks=Me("_globalUniCloudDatabaseCallback")),t||(this.auth=En(this._authCallBacks)),this._isJQL=t,Object.assign(this,En(this._dbCallBacks)),this.env=gt({},{get:(i,o)=>({$env:o})}),this.Geo=gt({},{get:(i,o)=>Lt({path:["Geo"],method:o})}),this.serverDate=Lt({path:[],method:"serverDate"}),this.RegExp=Lt({path:[],method:"RegExp"})}getCloudEnv(e){if(typeof e!="string"||!e.trim())throw new Error("getCloudEnv\u53C2\u6570\u9519\u8BEF");return{$env:e.replace("$cloudEnv_","")}}_callback(e,t){let i=this._dbCallBacks;i[e]&&i[e].forEach(o=>{o(...t)})}_callbackAuth(e,t){let i=this._authCallBacks;i[e]&&i[e].forEach(o=>{o(...t)})}multiSend(){let e=Array.from(arguments),t=e.map(i=>{let o=i.getAction(),s=i.getCommand();if(s.$db[s.$db.length-1].$method!=="getTemp")throw new Error("multiSend\u53EA\u652F\u6301\u5B50\u547D\u4EE4\u5185\u4F7F\u7528getTemp");return{action:o,command:s}});return this._callCloudFunction({multiCommand:t,queryList:e})}}{_parseResult(e){return this._isJQL?e.result:e}_callCloudFunction({action:e,command:t,multiCommand:i,queryList:o}){function s(u,v){if(i&&o)for(let h=0;h<o.length;h++){let m=o[h];m.udb&&typeof m.udb.setResult=="function"&&(v?m.udb.setResult(v):m.udb.setResult(u.result.dataList[h]))}}let r=this,a=this._isJQL?"databaseForJQL":"database";function l(u){return r._callback("error",[u]),$(Q(a,"fail"),u).then(()=>$(Q(a,"complete"),u)).then(()=>(s(null,u),ae(de,{type:pn,content:u}),Promise.reject(u)))}let c=$(Q(a,"invoke")),_=this._uniClient;return c.then(()=>_.callFunction({name:"DCloud-clientDB",type:uo,data:{action:e,command:t,multiCommand:i}})).then(u=>{let{code:v,message:h,token:m,tokenExpired:f,systemInfo:d=[]}=u.result;if(d)for(let x=0;x<d.length;x++){let{level:g,message:p,detail:y}=d[x],w=console[g==="warn"?"error":g]||console.log,M="[System Info]"+p;y&&(M=`${M}
\u8BE6\u7EC6\u4FE1\u606F\uFF1A${y}`),w(M)}if(v)return l(new P({code:v,message:h,requestId:u.requestId}));u.result.errCode=u.result.errCode||u.result.code,u.result.errMsg=u.result.errMsg||u.result.message,m&&f&&(ti({token:m,tokenExpired:f}),this._callbackAuth("refreshToken",[{token:m,tokenExpired:f}]),this._callback("refreshToken",[{token:m,tokenExpired:f}]),ae(ct,{token:m,tokenExpired:f}));let b=[{prop:"affectedDocs",tips:"affectedDocs\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528inserted/deleted/updated/data.length\u66FF\u4EE3"},{prop:"code",tips:"code\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528errCode\u66FF\u4EE3"},{prop:"message",tips:"message\u4E0D\u518D\u63A8\u8350\u4F7F\u7528\uFF0C\u8BF7\u4F7F\u7528errMsg\u66FF\u4EE3"}];for(let x=0;x<b.length;x++){let{prop:g,tips:p}=b[x];if(g in u.result){let y=u.result[g];Object.defineProperty(u.result,g,{get:()=>(console.warn(p),y)})}}return function(x){return $(Q(a,"success"),x).then(()=>$(Q(a,"complete"),x)).then(()=>{s(x,null);let g=r._parseResult(x);return ae(de,{type:pn,content:g}),Promise.resolve(g)})}(u)},u=>(/fc_function_not_found|FUNCTION_NOT_FOUND/g.test(u.message)&&console.warn("clientDB\u672A\u521D\u59CB\u5316\uFF0C\u8BF7\u5728web\u63A7\u5236\u53F0\u4FDD\u5B58\u4E00\u6B21schema\u4EE5\u5F00\u542FclientDB"),l(new P({code:u.code||"SYSTEM_ERROR",message:u.message,requestId:u.requestId}))))}},Pe="token\u65E0\u6548\uFF0C\u8DF3\u8F6C\u767B\u5F55\u9875\u9762",yi="token\u8FC7\u671F\uFF0C\u8DF3\u8F6C\u767B\u5F55\u9875\u9762",is={TOKEN_INVALID_TOKEN_EXPIRED:yi,TOKEN_INVALID_INVALID_CLIENTID:Pe,TOKEN_INVALID:Pe,TOKEN_INVALID_WRONG_TOKEN:Pe,TOKEN_INVALID_ANONYMOUS_USER:Pe},Ht={"uni-id-token-expired":yi,"uni-id-check-token-failed":Pe,"uni-id-token-not-exist":Pe,"uni-id-check-device-feature-failed":Pe};function Mn(n,e){let t="";return t=n?`${n}/${e}`:e,t.replace(/^\//,"")}function Rn(n=[],e=""){let t=[],i=[];return n.forEach(o=>{o.needLogin===!0?t.push(Mn(e,o.path)):o.needLogin===!1&&i.push(Mn(e,o.path))}),{needLoginPage:t,notNeedLoginPage:i}}function Ge(n){return n.split("?")[0].replace(/^\//,"")}function $t(){return function(n){let e=n&&n.$page&&n.$page.fullPath||"";return e&&(e.charAt(0)!=="/"&&(e="/"+e),e)}(function(){let n=getCurrentPages();return n[n.length-1]}())}function wi(){return Ge($t())}function os(n="",e={}){if(!n||!(e&&e.list&&e.list.length))return!1;let t=e.list,i=Ge(n);return t.some(o=>o.pagePath===i)}var ss=!!De.uniIdRouter,{loginPage:Ye,routerNeedLogin:as,resToLogin:rs,needLoginPage:bi,notNeedLoginPage:cs,loginPageInTabBar:ls}=function({pages:n=[],subPackages:e=[],uniIdRouter:t={},tabBar:i={}}=De){let{loginPage:o,needLogin:s=[],resToLogin:r=!0}=t,{needLoginPage:a,notNeedLoginPage:l}=Rn(n),{needLoginPage:c,notNeedLoginPage:_}=function(u=[]){let v=[],h=[];return u.forEach(m=>{let{root:f,pages:d=[]}=m,{needLoginPage:b,notNeedLoginPage:x}=Rn(d,f);v.push(...b),h.push(...x)}),{needLoginPage:v,notNeedLoginPage:h}}(e);return{loginPage:o,routerNeedLogin:s,resToLogin:r,needLoginPage:[...a,...c],notNeedLoginPage:[...l,..._],loginPageInTabBar:os(o,i)}}();if(bi.indexOf(Ye)>-1)throw new Error(`Login page [${Ye}] should not be "needLogin", please check your pages.json`);function vi(n){let e=wi();if(n.charAt(0)==="/")return n;let[t,i]=n.split("?"),o=t.replace(/^\//,"").split("/"),s=e.split("/");s.pop();for(let r=0;r<o.length;r++){let a=o[r];a===".."?s.pop():a!=="."&&s.push(a)}return s[0]===""&&s.shift(),"/"+s.join("/")+(i?"?"+i:"")}function us(n){let e=Ge(vi(n));return!(cs.indexOf(e)>-1)&&(bi.indexOf(e)>-1||as.some(t=>function(i,o){return new RegExp(o).test(i)}(n,t)))}function ki({redirect:n}){let e=Ge(n),t=Ge(Ye);return wi()!==t&&e!==t}function Wt({api:n,redirect:e}={}){if(!e||!ki({redirect:e}))return;let t=function(o,s){return o.charAt(0)!=="/"&&(o="/"+o),s?o.indexOf("?")>-1?o+`&uniIdRedirectUrl=${encodeURIComponent(s)}`:o+`?uniIdRedirectUrl=${encodeURIComponent(s)}`:o}(Ye,e);ls?n!=="navigateTo"&&n!=="redirectTo"||(n="switchTab"):n==="switchTab"&&(n="navigateTo");let i={navigateTo:uni.navigateTo,redirectTo:uni.redirectTo,switchTab:uni.switchTab,reLaunch:uni.reLaunch};setTimeout(()=>{i[n]({url:t})})}function Nn({url:n}={}){let e={abortLoginPageJump:!1,autoToLoginPage:!1},t=function(){let{token:i,tokenExpired:o}=_t(),s;if(i){if(o<Date.now()){let r="uni-id-token-expired";s={errCode:r,errMsg:Ht[r]}}}else{let r="uni-id-check-token-failed";s={errCode:r,errMsg:Ht[r]}}return s}();if(us(n)&&t){if(t.uniIdRedirectUrl=n,$e(Re).length>0)return setTimeout(()=>{ae(Re,t)},0),e.abortLoginPageJump=!0,e;e.autoToLoginPage=!0}return e}function ds(){(function(){let e=$t(),{abortLoginPageJump:t,autoToLoginPage:i}=Nn({url:e});t||i&&Wt({api:"redirectTo",redirect:e})})();let n=["navigateTo","redirectTo","reLaunch","switchTab"];for(let e=0;e<n.length;e++){let t=n[e];uni.addInterceptor(t,{invoke(i){let{abortLoginPageJump:o,autoToLoginPage:s}=Nn({url:i.url});return o?i:s?(Wt({api:t,redirect:vi(i.url)}),!1):i}})}}function fs(){this.onResponse(n=>{let{type:e,content:t}=n,i=!1;switch(e){case"cloudobject":i=function(o){if(typeof o!="object")return!1;let{errCode:s}=o||{};return s in Ht}(t);break;case"clientdb":i=function(o){if(typeof o!="object")return!1;let{errCode:s}=o||{};return s in is}(t)}i&&function(o={}){let s=$e(Re);Zn().then(()=>{let r=$t();if(r&&ki({redirect:r}))return s.length>0?ae(Re,Object.assign({uniIdRedirectUrl:r},o)):void(Ye&&Wt({api:"navigateTo",redirect:r}))})}(t)})}function hs(n){(function(e){e.onResponse=function(t){kt(de,t)},e.offResponse=function(t){xt(de,t)}})(n),function(e){e.onNeedLogin=function(t){kt(Re,t)},e.offNeedLogin=function(t){xt(Re,t)},ss&&(Me("_globalUniCloudStatus").needLoginInit||(Me("_globalUniCloudStatus").needLoginInit=!0,Zn().then(()=>{ds.call(e)}),rs&&fs.call(e)))}(n),function(e){e.onRefreshToken=function(t){kt(ct,t)},e.offRefreshToken=function(t){xt(ct,t)}}(n)}var xi,nt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",gs=/^(?:[A-Za-z\d+/]{4})*?(?:[A-Za-z\d+/]{2}(?:==)?|[A-Za-z\d+/]{3}=?)?$/;function ms(){let n=_t().token||"",e=n.split(".");if(!n||e.length!==3)return{uid:null,role:[],permission:[],tokenExpired:0};let t;try{t=JSON.parse((i=e[1],decodeURIComponent(xi(i).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch(o){throw new Error("\u83B7\u53D6\u5F53\u524D\u7528\u6237\u4FE1\u606F\u51FA\u9519\uFF0C\u8BE6\u7EC6\u9519\u8BEF\u4FE1\u606F\u4E3A\uFF1A"+o.message)}var i;return t.tokenExpired=1e3*t.exp,delete t.exp,delete t.iat,t}xi=typeof atob!="function"?function(n){if(n=String(n).replace(/[\t\n\f\r ]+/g,""),!gs.test(n))throw new Error("Failed to execute 'atob' on 'Window': The string to be decoded is not correctly encoded.");var e;n+="==".slice(2-(3&n.length));for(var t,i,o="",s=0;s<n.length;)e=nt.indexOf(n.charAt(s++))<<18|nt.indexOf(n.charAt(s++))<<12|(t=nt.indexOf(n.charAt(s++)))<<6|(i=nt.indexOf(n.charAt(s++))),o+=t===64?String.fromCharCode(e>>16&255):i===64?String.fromCharCode(e>>16&255,e>>8&255):String.fromCharCode(e>>16&255,e>>8&255,255&e);return o}:atob;var ps=fe(function(n,e){Object.defineProperty(e,"__esModule",{value:!0});let t="chooseAndUploadFile:ok",i="chooseAndUploadFile:fail";function o(r,a){return r.tempFiles.forEach((l,c)=>{l.name||(l.name=l.path.substring(l.path.lastIndexOf("/")+1)),a&&(l.fileType=a),l.cloudPath=Date.now()+"_"+c+l.name.substring(l.name.lastIndexOf("."))}),r.tempFilePaths||(r.tempFilePaths=r.tempFiles.map(l=>l.path)),r}function s(r,a,{onChooseFile:l,onUploadProgress:c}){return a.then(_=>{if(l){let u=l(_);if(u!==void 0)return Promise.resolve(u).then(v=>v===void 0?_:v)}return _}).then(_=>_===!1?{errMsg:t,tempFilePaths:[],tempFiles:[]}:function(u,v,h=5,m){(v=Object.assign({},v)).errMsg=t;let f=v.tempFiles,d=f.length,b=0;return new Promise(x=>{for(;b<h;)g();function g(){let p=b++;if(p>=d)return void(!f.find(w=>!w.url&&!w.errMsg)&&x(v));let y=f[p];u.uploadFile({filePath:y.path,cloudPath:y.cloudPath,fileType:y.fileType,cloudPathAsRealPath:y.cloudPathAsRealPath,onUploadProgress(w){w.index=p,w.tempFile=y,w.tempFilePath=y.path,m&&m(w)}}).then(w=>{y.url=w.fileID,p<d&&g()}).catch(w=>{y.errMsg=w.errMsg||w.message,p<d&&g()})}})}(r,_,5,c))}e.initChooseAndUploadFile=function(r){return function(a={type:"all"}){return a.type==="image"?s(r,function(l){let{count:c,sizeType:_,sourceType:u=["album","camera"],extension:v}=l;return new Promise((h,m)=>{uni.chooseImage({count:c,sizeType:_,sourceType:u,extension:v,success(f){h(o(f,"image"))},fail(f){m({errMsg:f.errMsg.replace("chooseImage:fail",i)})}})})}(a),a):a.type==="video"?s(r,function(l){let{camera:c,compressed:_,maxDuration:u,sourceType:v=["album","camera"],extension:h}=l;return new Promise((m,f)=>{uni.chooseVideo({camera:c,compressed:_,maxDuration:u,sourceType:v,extension:h,success(d){let{tempFilePath:b,duration:x,size:g,height:p,width:y}=d;m(o({errMsg:"chooseVideo:ok",tempFilePaths:[b],tempFiles:[{name:d.tempFile&&d.tempFile.name||"",path:b,size:g,type:d.tempFile&&d.tempFile.type||"",width:y,height:p,duration:x,fileType:"video",cloudPath:""}]},"video"))},fail(d){f({errMsg:d.errMsg.replace("chooseVideo:fail",i)})}})})}(a),a):s(r,function(l){let{count:c,extension:_}=l;return new Promise((u,v)=>{let h=uni.chooseFile;if(typeof wx!="undefined"&&typeof wx.chooseMessageFile=="function"&&(h=wx.chooseMessageFile),typeof h!="function")return v({errMsg:i+" \u8BF7\u6307\u5B9A type \u7C7B\u578B\uFF0C\u8BE5\u5E73\u53F0\u4EC5\u652F\u6301\u9009\u62E9 image \u6216 video\u3002"});h({type:"all",count:c,extension:_,success(m){u(o(m))},fail(m){v({errMsg:m.errMsg.replace("chooseFile:fail",i)})}})})}(a),a)}}}),_s=oo(ps),ys="manual";function Si(n){return{props:{localdata:{type:Array,default:()=>[]},options:{type:[Object,Array],default:()=>({})},spaceInfo:{type:Object,default:()=>({})},collection:{type:[String,Array],default:""},action:{type:String,default:""},field:{type:String,default:""},orderby:{type:String,default:""},where:{type:[String,Object],default:""},pageData:{type:String,default:"add"},pageCurrent:{type:Number,default:1},pageSize:{type:Number,default:20},getcount:{type:[Boolean,String],default:!1},gettree:{type:[Boolean,String],default:!1},gettreepath:{type:[Boolean,String],default:!1},startwith:{type:String,default:""},limitlevel:{type:Number,default:10},groupby:{type:String,default:""},groupField:{type:String,default:""},distinct:{type:[Boolean,String],default:!1},foreignKey:{type:String,default:""},loadtime:{type:String,default:"auto"},manual:{type:Boolean,default:!1}},data:()=>({mixinDatacomLoading:!1,mixinDatacomHasMore:!1,mixinDatacomResData:[],mixinDatacomErrorMessage:"",mixinDatacomPage:{}}),created(){this.mixinDatacomPage={current:this.pageCurrent,size:this.pageSize,count:0},this.$watch(()=>{var e=[];return["pageCurrent","pageSize","localdata","collection","action","field","orderby","where","getont","getcount","gettree","groupby","groupField","distinct"].forEach(t=>{e.push(this[t])}),e},(e,t)=>{if(this.loadtime===ys)return;let i=!1,o=[];for(let s=2;s<e.length;s++)e[s]!==t[s]&&(o.push(e[s]),i=!0);e[0]!==t[0]&&(this.mixinDatacomPage.current=this.pageCurrent),this.mixinDatacomPage.size=this.pageSize,this.onMixinDatacomPropsChange(i,o)})},methods:{onMixinDatacomPropsChange(e,t){},mixinDatacomEasyGet({getone:e=!1,success:t,fail:i}={}){this.mixinDatacomLoading||(this.mixinDatacomLoading=!0,this.mixinDatacomErrorMessage="",this.mixinDatacomGet().then(o=>{this.mixinDatacomLoading=!1;let{data:s,count:r}=o.result;this.getcount&&(this.mixinDatacomPage.count=r),this.mixinDatacomHasMore=s.length<this.pageSize;let a=e?s.length?s[0]:void 0:s;this.mixinDatacomResData=a,t&&t(a)}).catch(o=>{this.mixinDatacomLoading=!1,this.mixinDatacomErrorMessage=o,i&&i(o)}))},mixinDatacomGet(e={}){let t=n.database(this.spaceInfo),i=e.action||this.action;i&&(t=t.action(i));let o=e.collection||this.collection;t=Array.isArray(o)?t.collection(...o):t.collection(o);let s=e.where||this.where;s&&Object.keys(s).length&&(t=t.where(s));let r=e.field||this.field;r&&(t=t.field(r));let a=e.foreignKey||this.foreignKey;a&&(t=t.foreignKey(a));let l=e.groupby||this.groupby;l&&(t=t.groupBy(l));let c=e.groupField||this.groupField;c&&(t=t.groupField(c)),(e.distinct!==void 0?e.distinct:this.distinct)===!0&&(t=t.distinct());let _=e.orderby||this.orderby;_&&(t=t.orderBy(_));let u=e.pageCurrent!==void 0?e.pageCurrent:this.mixinDatacomPage.current,v=e.pageSize!==void 0?e.pageSize:this.mixinDatacomPage.size,h=e.getcount!==void 0?e.getcount:this.getcount,m=e.gettree!==void 0?e.gettree:this.gettree,f=e.gettreepath!==void 0?e.gettreepath:this.gettreepath,d={getCount:h},b={limitLevel:e.limitlevel!==void 0?e.limitlevel:this.limitlevel,startWith:e.startwith!==void 0?e.startwith:this.startwith};return m&&(d.getTree=b),f&&(d.getTreePath=b),t=t.skip(v*(u-1)).limit(v).get(d),t}}}}function ws(n){return function(e,t={}){t=function(l,c={}){return l.customUI=c.customUI||l.customUI,l.parseSystemError=c.parseSystemError||l.parseSystemError,Object.assign(l.loadingOptions,c.loadingOptions),Object.assign(l.errorOptions,c.errorOptions),typeof c.secretMethods=="object"&&(l.secretMethods=c.secretMethods),l}({customUI:!1,loadingOptions:{title:"\u52A0\u8F7D\u4E2D...",mask:!0},errorOptions:{type:"modal",retry:!1}},t);let{customUI:i,loadingOptions:o,errorOptions:s,parseSystemError:r}=t,a=!i;return new Proxy({},{get:(l,c)=>function({fn:_,interceptorName:u,getCallbackArgs:v}={}){return function(...h){return A(this,null,function*(){let m=v?v({params:h}):{},f,d;try{return yield $(Q(u,"invoke"),B({},m)),f=yield _(...h),yield $(Q(u,"success"),ne(B({},m),{result:f})),f}catch(b){throw d=b,yield $(Q(u,"fail"),ne(B({},m),{error:d})),d}finally{yield $(Q(u,"complete"),d?ne(B({},m),{error:d}):ne(B({},m),{result:f}))}})}}({fn:function _(...u){return A(this,null,function*(){let v;a&&uni.showLoading({title:o.title,mask:o.mask});let h={name:e,type:lo,data:{method:c,params:u}};typeof t.secretMethods=="object"&&function(g,p){let y=p.data.method,w=g.secretMethods||{},M=w[y]||w["*"];M&&(p.secretType=M)}(t,h);let m=!1;try{v=yield n.callFunction(h)}catch(g){m=!0,v={result:new P(g)}}let{errSubject:f,errCode:d,errMsg:b,newToken:x}=v.result||{};if(a&&uni.hideLoading(),x&&x.token&&x.tokenExpired&&(ti(x),ae(ct,B({},x))),d){let g=b;if(m&&r&&(g=(yield r({objectName:e,methodName:c,params:u,errSubject:f,errCode:d,errMsg:b})).errMsg||b),a)if(s.type==="toast")uni.showToast({title:g,icon:"none"});else{if(s.type!=="modal")throw new Error(`Invalid errorOptions.type: ${s.type}`);{let{confirm:y}=yield function(){return A(this,arguments,function*({title:w,content:M,showCancel:R,cancelText:q,confirmText:ee}={}){return new Promise((z,oe)=>{uni.showModal({title:w,content:M,showCancel:R,cancelText:q,confirmText:ee,success(te){z(te)},fail(){z({confirm:!1,cancel:!0})}})})})}({title:"\u63D0\u793A",content:g,showCancel:s.retry,cancelText:"\u53D6\u6D88",confirmText:s.retry?"\u91CD\u8BD5":"\u786E\u5B9A"});if(s.retry&&y)return _(...u)}}let p=new P({subject:f,code:d,message:b,requestId:v.requestId});throw p.detail=v.result,ae(de,{type:_n,content:p}),p}return ae(de,{type:_n,content:v.result}),v.result})},interceptorName:"callObject",getCallbackArgs:function({params:_}={}){return{objectName:e,methodName:c,params:_}}})})}}function Ti(n){return Me("_globalUniCloudSecureNetworkCache__{spaceId}".replace("{spaceId}",n.config.spaceId))}function bs(){return A(this,arguments,function*({openid:n,callLoginByWeixin:e=!1}={}){throw Ti(this),new Error(`[SecureNetwork] API \`initSecureNetworkByWeixin\` is not supported on platform \`${Yn}\``)})}function vs(n){return A(this,null,function*(){let e=Ti(this);return e.initPromise||(e.initPromise=bs.call(this,n)),e.initPromise})}function ks(n){return function({openid:e,callLoginByWeixin:t=!1}={}){return vs.call(n,{openid:e,callLoginByWeixin:t})}}function Un(n){let e={getSystemInfo:uni.getSystemInfo,getPushClientId:uni.getPushClientId};return function(t){return new Promise((i,o)=>{e[n](ne(B({},t),{success(s){i(s)},fail(s){o(s)}}))})}}var zt=class extends class{constructor(){this._callback={}}addListener(e,t){this._callback[e]||(this._callback[e]=[]),this._callback[e].push(t)}on(e,t){return this.addListener(e,t)}removeListener(e,t){if(!t)throw new Error('The "listener" argument must be of type function. Received undefined');let i=this._callback[e];if(!i)return;let o=function(s,r){for(let a=s.length-1;a>=0;a--)if(s[a]===r)return a;return-1}(i,t);i.splice(o,1)}off(e,t){return this.removeListener(e,t)}removeAllListener(e){delete this._callback[e]}emit(e,...t){let i=this._callback[e];if(i)for(let o=0;o<i.length;o++)i[o](...t)}}{constructor(){super(),this._uniPushMessageCallback=this._receivePushMessage.bind(this),this._currentMessageId=-1,this._payloadQueue=[]}init(){return Promise.all([Un("getSystemInfo")(),Un("getPushClientId")()]).then(([{appId:e}={},{cid:t}={}]=[])=>{if(!e)throw new Error("Invalid appId, please check the manifest.json file");if(!t)throw new Error("Invalid push client id");this._appId=e,this._pushClientId=t,this._seqId=Date.now()+"-"+Math.floor(9e5*Math.random()+1e5),this.emit("open"),this._initMessageListener()},e=>{throw this.emit("error",e),this.close(),e})}open(){return A(this,null,function*(){return this.init()})}_isUniCloudSSE(e){if(e.type!=="receive")return!1;let t=e&&e.data&&e.data.payload;return!(!t||t.channel!=="UNI_CLOUD_SSE"||t.seqId!==this._seqId)}_receivePushMessage(e){if(!this._isUniCloudSSE(e))return;let t=e&&e.data&&e.data.payload,{action:i,messageId:o,message:s}=t;this._payloadQueue.push({action:i,messageId:o,message:s}),this._consumMessage()}_consumMessage(){for(;;){let e=this._payloadQueue.find(t=>t.messageId===this._currentMessageId+1);if(!e)break;this._currentMessageId++,this._parseMessagePayload(e)}}_parseMessagePayload(e){let{action:t,messageId:i,message:o}=e;t==="end"?this._end({messageId:i,message:o}):t==="message"&&this._appendMessage({messageId:i,message:o})}_appendMessage({messageId:e,message:t}={}){this.emit("message",t)}_end({messageId:e,message:t}={}){this.emit("end",t),this.close()}_initMessageListener(){uni.onPushMessage(this._uniPushMessageCallback)}_destroy(){uni.offPushMessage(this._uniPushMessageCallback)}toJSON(){return{appId:this._appId,pushClientId:this._pushClientId,seqId:this._seqId}}close(){this._destroy(),this.emit("close")}};function xs(n){n._initPromiseHub||(n._initPromiseHub=new rt({createPromise:function(){let e=Promise.resolve();var t;t=1,e=new Promise(o=>{setTimeout(()=>{o()},t)});let i=n.auth();return e.then(()=>i.getLoginState()).then(o=>o?Promise.resolve():i.signInAnonymously())}}))}var Ss={tcb:In,tencent:In,aliyun:ko,private:Ho,alipay:Jo},le=new class{init(n){let e={},t=Ss[n.provider];if(!t)throw new Error("\u672A\u63D0\u4F9B\u6B63\u786E\u7684provider\u53C2\u6570");return e=t.init(n),xs(e),ts(e),function(i){let o=i.uploadFile;i.uploadFile=function(s){return o.call(this,s)}}(e),function(i){i.database=function(o){if(o&&Object.keys(o).length>0)return i.init(o).database();if(this._database)return this._database;let s=Dn(mt,{uniClient:i});return this._database=s,s},i.databaseForJQL=function(o){if(o&&Object.keys(o).length>0)return i.init(o).databaseForJQL();if(this._databaseForJQL)return this._databaseForJQL;let s=Dn(mt,{uniClient:i,isJQL:!0});return this._databaseForJQL=s,s}}(e),function(i){i.getCurrentUserInfo=ms,i.chooseAndUploadFile=_s.initChooseAndUploadFile(i),Object.assign(i,{get mixinDatacom(){return Si(i)}}),i.SSEChannel=zt,i.initSecureNetworkByWeixin=ks(i),i.importObject=ws(i)}(e),["callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","chooseAndUploadFile"].forEach(i=>{if(!e[i])return;let o=e[i];e[i]=function(){return o.apply(e,Array.from(arguments))},e[i]=function(s,r){return function(a){let l=!1;r==="callFunction"&&(l=(a&&a.type||fn)!==fn);let c=r==="callFunction"&&!l,_=this._initPromiseHub.exec();a=a||{};let{success:u,fail:v,complete:h}=Xn(a),m=_.then(()=>l?Promise.resolve():$(Q(r,"invoke"),a)).then(()=>s.call(this,a)).then(f=>l?Promise.resolve(f):$(Q(r,"success"),f).then(()=>$(Q(r,"complete"),f)).then(()=>(c&&ae(de,{type:et,content:f}),Promise.resolve(f))),f=>l?Promise.reject(f):$(Q(r,"fail"),f).then(()=>$(Q(r,"complete"),f)).then(()=>(ae(de,{type:et,content:f}),Promise.reject(f))));if(!(u||v||h))return m;m.then(f=>{u&&u(f),h&&h(f),c&&ae(de,{type:et,content:f})},f=>{v&&v(f),h&&h(f),c&&ae(de,{type:et,content:f})})}}(e[i],i).bind(e)}),e.init=this.init,e}};(()=>{let n=_o,e={};if(n&&n.length===1)e=n[0],le=le.init(e),le._isDefault=!0;else{let t=["auth","callFunction","uploadFile","deleteFile","getTempFileURL","downloadFile","database","getCurrentUSerInfo","importObject"],i;i=n&&n.length>0?"\u5E94\u7528\u6709\u591A\u4E2A\u670D\u52A1\u7A7A\u95F4\uFF0C\u8BF7\u901A\u8FC7uniCloud.init\u65B9\u6CD5\u6307\u5B9A\u8981\u4F7F\u7528\u7684\u670D\u52A1\u7A7A\u95F4":"\u5E94\u7528\u672A\u5173\u8054\u670D\u52A1\u7A7A\u95F4\uFF0C\u8BF7\u5728uniCloud\u76EE\u5F55\u53F3\u952E\u5173\u8054\u670D\u52A1\u7A7A\u95F4",t.forEach(o=>{le[o]=function(){return console.error(i),Promise.reject(new P({code:"SYS_ERR",message:i}))}})}Object.assign(le,{get mixinDatacom(){return Si(le)}}),hs(le),le.addInterceptor=Qn,le.removeInterceptor=wo,le.interceptObject=bo})();var F=le;function Ii(n){function e(k,N){return k<<N|k>>>32-N}function t(k,N){var j,J,W,V,H;return W=k&2147483648,V=N&2147483648,j=k&1073741824,J=N&1073741824,H=(k&1073741823)+(N&1073741823),j&J?H^2147483648^W^V:j|J?H&1073741824?H^3221225472^W^V:H^1073741824^W^V:H^W^V}function i(k,N,j){return k&N|~k&j}function o(k,N,j){return k&j|N&~j}function s(k,N,j){return k^N^j}function r(k,N,j){return N^(k|~j)}function a(k,N,j,J,W,V,H){return k=t(k,t(t(i(N,j,J),W),H)),t(e(k,V),N)}function l(k,N,j,J,W,V,H){return k=t(k,t(t(o(N,j,J),W),H)),t(e(k,V),N)}function c(k,N,j,J,W,V,H){return k=t(k,t(t(s(N,j,J),W),H)),t(e(k,V),N)}function _(k,N,j,J,W,V,H){return k=t(k,t(t(r(N,j,J),W),H)),t(e(k,V),N)}function u(k){for(var N,j=k.length,J=j+8,W=(J-J%64)/64,V=(W+1)*16,H=Array(V-1),Xe=0,ye=0;ye<j;)N=(ye-ye%4)/4,Xe=ye%4*8,H[N]=H[N]|k.charCodeAt(ye)<<Xe,ye++;return N=(ye-ye%4)/4,Xe=ye%4*8,H[N]=H[N]|128<<Xe,H[V-2]=j<<3,H[V-1]=j>>>29,H}function v(k){var N="",j="",J,W;for(W=0;W<=3;W++)J=k>>>W*8&255,j="0"+J.toString(16),N=N+j.substr(j.length-2,2);return N}var h=Array(),m,f,d,b,x,g,p,y,w,M=7,R=12,q=17,ee=22,z=5,oe=9,te=14,re=20,se=4,he=11,ge=16,me=23,pe=6,_e=10,S=15,T=21;for(h=u(n),g=1732584193,p=4023233417,y=2562383102,w=271733878,m=0;m<h.length;m+=16)f=g,d=p,b=y,x=w,g=a(g,p,y,w,h[m+0],M,3614090360),w=a(w,g,p,y,h[m+1],R,3905402710),y=a(y,w,g,p,h[m+2],q,606105819),p=a(p,y,w,g,h[m+3],ee,3250441966),g=a(g,p,y,w,h[m+4],M,4118548399),w=a(w,g,p,y,h[m+5],R,1200080426),y=a(y,w,g,p,h[m+6],q,2821735955),p=a(p,y,w,g,h[m+7],ee,4249261313),g=a(g,p,y,w,h[m+8],M,1770035416),w=a(w,g,p,y,h[m+9],R,2336552879),y=a(y,w,g,p,h[m+10],q,4294925233),p=a(p,y,w,g,h[m+11],ee,2304563134),g=a(g,p,y,w,h[m+12],M,1804603682),w=a(w,g,p,y,h[m+13],R,4254626195),y=a(y,w,g,p,h[m+14],q,2792965006),p=a(p,y,w,g,h[m+15],ee,1236535329),g=l(g,p,y,w,h[m+1],z,4129170786),w=l(w,g,p,y,h[m+6],oe,3225465664),y=l(y,w,g,p,h[m+11],te,643717713),p=l(p,y,w,g,h[m+0],re,3921069994),g=l(g,p,y,w,h[m+5],z,3593408605),w=l(w,g,p,y,h[m+10],oe,38016083),y=l(y,w,g,p,h[m+15],te,3634488961),p=l(p,y,w,g,h[m+4],re,3889429448),g=l(g,p,y,w,h[m+9],z,568446438),w=l(w,g,p,y,h[m+14],oe,3275163606),y=l(y,w,g,p,h[m+3],te,4107603335),p=l(p,y,w,g,h[m+8],re,1163531501),g=l(g,p,y,w,h[m+13],z,2850285829),w=l(w,g,p,y,h[m+2],oe,4243563512),y=l(y,w,g,p,h[m+7],te,1735328473),p=l(p,y,w,g,h[m+12],re,2368359562),g=c(g,p,y,w,h[m+5],se,4294588738),w=c(w,g,p,y,h[m+8],he,2272392833),y=c(y,w,g,p,h[m+11],ge,1839030562),p=c(p,y,w,g,h[m+14],me,4259657740),g=c(g,p,y,w,h[m+1],se,2763975236),w=c(w,g,p,y,h[m+4],he,1272893353),y=c(y,w,g,p,h[m+7],ge,4139469664),p=c(p,y,w,g,h[m+10],me,3200236656),g=c(g,p,y,w,h[m+13],se,681279174),w=c(w,g,p,y,h[m+0],he,3936430074),y=c(y,w,g,p,h[m+3],ge,3572445317),p=c(p,y,w,g,h[m+6],me,76029189),g=c(g,p,y,w,h[m+9],se,3654602809),w=c(w,g,p,y,h[m+12],he,3873151461),y=c(y,w,g,p,h[m+15],ge,530742520),p=c(p,y,w,g,h[m+2],me,3299628645),g=_(g,p,y,w,h[m+0],pe,4096336452),w=_(w,g,p,y,h[m+7],_e,1126891415),y=_(y,w,g,p,h[m+14],S,2878612391),p=_(p,y,w,g,h[m+5],T,4237533241),g=_(g,p,y,w,h[m+12],pe,1700485571),w=_(w,g,p,y,h[m+3],_e,2399980690),y=_(y,w,g,p,h[m+10],S,4293915773),p=_(p,y,w,g,h[m+1],T,2240044497),g=_(g,p,y,w,h[m+8],pe,1873313359),w=_(w,g,p,y,h[m+15],_e,4264355552),y=_(y,w,g,p,h[m+6],S,2734768916),p=_(p,y,w,g,h[m+13],T,1309151649),g=_(g,p,y,w,h[m+4],pe,4149444226),w=_(w,g,p,y,h[m+11],_e,3174756917),y=_(y,w,g,p,h[m+2],S,718787259),p=_(p,y,w,g,h[m+9],T,3951481745),g=t(g,f),p=t(p,d),y=t(y,b),w=t(w,x);var I=v(g)+v(p)+v(y)+v(w);return I.toLowerCase()}function Ts(n){let e=new Date,t=new Date(n),i=Math.floor((e-t)/1e3);if(t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()){if(i<60)return"\u521A\u521A";if(i<60*60)return`${Math.floor(i/60)}\u5206\u949F\u524D`;if(i<60*60*2){let d=Math.floor(i/3600),b=Math.floor((i-d*60*60)/60);return`${d}\u5C0F\u65F6 ${b}\u5206\u949F\u524D`}let h=t.getHours()>=12?"\u4E0B\u5348":"\u4E0A\u5348",m=t.getHours()%12||12,f=t.getMinutes().toString().padStart(2,"0");return`${h} ${m}:${f}`}let o=24*60*60*1e3;if(e-t<o*2)if(t.getDate()===e.getDate()-1&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()){let h=t.getHours()>=12?"\u4E0B\u5348":"\u4E0A\u5348",m=t.getHours()%12||12,f=t.getMinutes().toString().padStart(2,"0");return`\u6628\u5929 ${h} ${m}:${f}`}else{let h=t.getHours()>=12?"\u4E0B\u5348":"\u4E0A\u5348",m=t.getHours()%12||12,f=t.getMinutes().toString().padStart(2,"0");return`\u524D\u5929 ${h} ${m}:${f}`}let s=o*7;if(e-t<s){let h=["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"],m=t.getHours()>=12?"\u4E0B\u5348":"\u4E0A\u5348",f=t.getHours()%12||12,d=t.getMinutes().toString().padStart(2,"0");return`${h[t.getDay()]} ${m} ${f}:${d}`}let a=t.getFullYear(),l=(t.getMonth()+1).toString().padStart(2,"0"),c=t.getDate().toString().padStart(2,"0"),_=t.getHours()>=12?"\u4E0B\u5348":"\u4E0A\u5348",u=t.getHours()%12||12,v=t.getMinutes().toString().padStart(2,"0");return`${a}-${l}-${c} ${_} ${u}:${v}`}var jn=[],Bn=[],ze={appShowIndex:0,appHideIndex:0,onAppShow(n){this.appShowIndex++,typeof n=="function"&&jn.push(n),jn.forEach(e=>e())},onAppHide(n){this.appHideIndex++,typeof n=="function"&&Bn.push(n),Bn.forEach(e=>e())}};setTimeout(()=>{un(function(){ze.onAppShow()},getApp().$vm.$),dn(function(){ze.onAppHide()},getApp().$vm.$)},0);var Is=F.importObject("uni-id-co"),As=F.database(),Fn=As.collection("uni-id-users"),qn=uni.getStorageSync("uni-id-pages-userInfo")||{},Cs={userInfo:qn,hasLogin:Object.keys(qn).length!=0},Ps={updateUserInfo(n=!1){return A(this,null,function*(){if(n)Fn.where("_id==$env.uid").update(n).then(e=>{e.result.updated?(uni.showToast({title:"\u66F4\u65B0\u6210\u529F",icon:"none",duration:3e3}),this.setUserInfo(n)):uni.showToast({title:"\u6CA1\u6709\u6539\u53D8",icon:"none",duration:3e3})});else{let e=F.importObject("uni-id-co",{customUI:!0});try{let t=yield Fn.where("'_id' == $cloudEnv_uid").field("mobile,nickname,username,email,avatar_file").get(),i=yield e.getRealNameInfo();this.setUserInfo(ne(B({},t.result.data[0]),{realNameAuth:i}))}catch(t){this.setUserInfo({},{cover:!0}),D("error","at uni_modules/uni-id-pages/common/store.js:57",t.message,t.errCode)}}})},setUserInfo(t){return A(this,arguments,function*(n,{cover:e}={cover:!1}){let i=e?n:Object.assign(Ce.userInfo,n);return Ce.userInfo=Object.assign({},i),Ce.hasLogin=Object.keys(Ce.userInfo).length!=0,uni.setStorageSync("uni-id-pages-userInfo",Ce.userInfo),n})},logout(){return A(this,null,function*(){if(F.getCurrentUserInfo().tokenExpired>Date.now())try{yield Is.logout()}catch(n){D("error","at uni_modules/uni-id-pages/common/store.js:76",n)}uni.removeStorageSync("uni_id_token"),uni.setStorageSync("uni_id_token_expired",0),uni.redirectTo({url:`/${De.uniIdRouter&&De.uniIdRouter.loginPage?De.uniIdRouter.loginPage:"uni_modules/uni-id-pages/pages/login/login-withoutpwd"}`}),uni.$emit("uni-id-pages-logout"),this.setUserInfo({},{cover:!0})})},loginBack(n={}){let{uniIdRedirectUrl:e=""}=n,t=0,i=getCurrentPages();if(i.forEach((o,s)=>{i[i.length-s-1].route.split("/")[3]=="login"&&t++}),e)return uni.redirectTo({url:e,fail:o=>{uni.switchTab({url:e,fail:s=>{D("log","at uni_modules/uni-id-pages/common/store.js:106",o,s)}})}});if(t){let o=De.pages[0];return uni.reLaunch({url:`/${o.path}`})}uni.navigateBack({delta:t})},loginSuccess(n={}){let{showToast:e=!0,toastText:t="\u767B\u5F55\u6210\u529F",autoBack:i=!0,uniIdRedirectUrl:o="",passwordConfirmed:s}=n;e&&uni.showToast({title:t,icon:"none",duration:3e3}),this.updateUserInfo(),uni.$emit("uni-id-pages-login-success"),i&&this.loginBack({uniIdRedirectUrl:o})}},Ce=(0,Vt.reactive)(Cs),Ai=F.database(),Fe=Ai.command,pt=class{constructor(e){this.indexDB=!1,this.isInit=!1,this.msgList=[],this.getMore=()=>A(this,null,function*(){if(this.cloudMsg.hasAfterStorage){let t=yield this.localMsgMaxTime(),i=this.msgListMinTime(),o=yield this.cloudMsg.get({minTime:t,maxTime:i});return o.length?o:(this.cloudMsg.hasAfterStorage=!1,this.getMore())}else if(this.localMsg.hasBeforeList){let t=this.msgListMinTime(),i=yield this.localMsg.get({maxTime:t});return i.length?i:(this.localMsg.hasBeforeList=!1,this.getMore())}if(this.cloudMsg.hasBeforeStorage){let t=this.msgList[0]?this.msgList[0].create_time:!1,i=yield this.cloudMsg.get({maxTime:t});return i.length?i:(this.cloudMsg.hasBeforeStorage=!1,[])}}),this.cloudMsg={hasAfterStorage:!0,hasBeforeStorage:!0,get:(...s)=>A(this,[...s],function*({minTime:t=0,maxTime:i=!1,limit:o=30}={}){let r={conversation_id:this.conversation_id};t&&i?r.create_time=Fe.and([Fe.gt(t),Fe.lt(i)]):(t&&(r.create_time=Fe.gt(t)),i&&(r.create_time=Fe.lt(i)));let a=Ai.collection("uni-im-msg"),l;try{l=(yield a.where(r).limit(o).orderBy("create_time","desc").get()).result.data.reverse()}catch(c){l=[]}return l.length&&this.localMsg.add(l,t===0?"unshift":"push"),l})},this.localMsg={maxTime:!1,hasBeforeList:!0,get:(...r)=>A(this,[...r],function*({minTime:t=0,maxTime:i=!1,limit:o=30,orderBy:s={create_time:"asc"}}={}){let a=`select * from msg WHERE conversation_id = "${this.conversation_id}" `;(i||t)&&(i&&(a+=`AND create_time < ${i} `),t&&(a+=`AND create_time > ${t} `)),a+='ORDER BY "create_time" DESC ',o&&(a+=`LIMIT ${o} `);let l=[];try{l=yield this.sqlite.selectSql(a)}catch(c){D("error","at uni_modules/uni-im/lib/MsgManager.js:208",c)}return l.map(c=>{try{let _={"&quot;":'"',"&#39;":"'","&lt;":"<","&gt;":">","&amp;":"&"};Object.keys(_).forEach(u=>{c.body=c.body.replace(new RegExp(u,"g"),_[u])}),c.body=JSON.parse(c.body)}catch(_){D("error","at uni_modules/uni-im/lib/MsgManager.js:228",_)}return c}).sort((c,_)=>s.create_time=="asc"?c.create_time-_.create_time:_.create_time-c.create_time)}),add:(t,i="push")=>A(this,null,function*(){Array.isArray(t)||(t=[t]),t.forEach(a=>A(this,null,function*(){a.unique_id=Ii(JSON.stringify(a)+Math.random())}));let o=[];if(t.forEach(a=>A(this,null,function*(){let l=Object.keys(a),c=l.reduce((_,u)=>{if(u=="body"){let v=JSON.stringify(a.body);try{v=Hn(v)}catch(h){D("error","at uni_modules/uni-im/lib/MsgManager.js:342",h)}_+=`"${v}",`}else typeof a[u]=="string"?_+=`"${a[u]}",`:typeof a[u]=="undefined"?_+=`${null},`:_+=`${a[u]},`;return _},"").slice(0,-1);o.push(`insert into msg("${l.join('","')}") values (${c})`)})),o.length)try{yield this.sqlite.executeSql(o)}catch(a){D("log","at uni_modules/uni-im/lib/MsgManager.js:360",a)}let s=t.map(a=>a.create_time).sort((a,l)=>l-a)[0],r=yield this.localMsgMaxTime();s>(yield r)&&(this.localMsg.maxTime=s)}),update:(t,i)=>A(this,null,function*(){i=Object.assign({},i);let o="";for(let r in i)if(o+=`"${r}" = `,r=="body"){let a=JSON.stringify(i.body);try{a=Hn(a)}catch(l){D("error","at uni_modules/uni-im/lib/MsgManager.js:429",l)}o+=`"${a}",`}else typeof i[r]=="string"?o+=`"${i[r]}",`:typeof i[r]=="undefined"?o+=`${null},`:o+=`${i[r]},`;let s=`UPDATE msg SET ${o.slice(0,-1)} WHERE unique_id = "${t}"`;try{yield this.sqlite.executeSql(s)}catch(r){D("log","at uni_modules/uni-im/lib/MsgManager.js:444",r)}})},this.sqlite=getApp().globalData.sqlite,this.conversation_id=e.id,Object.defineProperty(this,"msgList",{get(){return e.isInit?e.msgList:[]},set(t){e.msgList=t}})}sleep(e){return A(this,null,function*(){return yield new Promise((t,i)=>{setTimeout(t,e)})})}localMsgMaxTime(){return A(this,null,function*(){if(this.localMsg.maxTime===!1){let e=yield this.localMsg.get({limit:1,orderBy:{create_time:"desc"}}),[t]=e;t?this.localMsg.maxTime=t.create_time:this.localMsg.maxTime=0}return this.localMsg.maxTime})}msgListMinTime(){let e=this.msgList[0];return e?e.create_time:0}},Ls=/["'&<>]/;function Hn(n){var e=""+n,t=Ls.exec(e);if(!t)return e;var i,o="",s=0,r=0;for(s=t.index;s<e.length;s++){switch(e.charCodeAt(s)){case 34:i="&quot;";break;case 38:i="&amp;";break;case 39:i="&#39;";break;case 60:i="&lt;";break;case 62:i="&gt;";break;default:continue}r!==s&&(o+=e.substring(r,s)),r=s+1,o+=i}return r!==s?o+e.substring(r,s):o}function Os(n,e="imObservableData"){return typeof uni[e]=="undefined"&&(n=(0,Vt.reactive)(n),uni[e]=n),uni[e]}var ce=F.database(),Wn=F.importObject("uni-im-co",{customUI:!0});function Ot(){return F.getCurrentUserInfo().uid}var U=Os({conversation:{dataList:[],hasMore:!0,loading:!1},currentConversationId:!1,heartbeat:"",friend:{dataList:[],hasMore:!0},group:{dataList:[],hasMore:!0},notification:{dataList:[],hasMore:!0},usersInfo:{},isWidescreen:!1,systemInfo:{},indexDB:!1,audioContext:!1,dataBaseIsOpen:!1,socketOpenIndex:0}),Jt={conversation:{revokeMsg(s){return A(this,arguments,function*({msg_id:n,_id:e,conversation_id:t,user_id:i=!1,create_time:o}){if(e&&(n=e),!i)try{let u=yield Wn.revokeMsg(n)}catch(u){return D("log","at uni_modules/uni-im/lib/main.js:88","err",u),uni.showToast({title:u.message,icon:"none"})}let r=yield this.get(t),a=r.msgList,l=a.findIndex(u=>u._id==n);if(l!=-1){let u=a[l];u.is_revoke=!0,u.body="[\u6B64\u6D88\u606F\u5DF2\u88AB\u64A4\u56DE]",r.msgList.splice(l,1,Object.assign({},u))}let _=(yield r.msgManager.localMsg.get({minTime:o-1,maxTime:o+1})).find(u=>u._id==n);_&&(_.is_revoke=!0,_.body="[\u6B64\u6D88\u606F\u5DF2\u88AB\u64A4\u56DE]",r.msgManager.localMsg.update(_.unique_id,_))})},get(n){return A(this,null,function*(){let e=!1;if(n)if(typeof n=="object"){let{friend_uid:i,user_id:o,group_id:s,conversation_id:r}=n;if(e=r,o&&(i=o,n.friend_uid=o),!e){if(!s&&!i)throw D("log","at uni_modules/uni-im/lib/main.js:146","param---------",n),new Error("\u4F1A\u8BDD\u5BF9\u8C61\u4E0D\u8BE6\uFF0C\u8BF7\u68C0\u67E5\u53C2\u6570",n);e=Qt.getConversationId(i||s,i?"single":"group")}}else if(typeof n=="string")e=n;else throw new Error("\u4F1A\u8BDD\u5BF9\u8C61\u4E0D\u8BE6\uFF0C\u8BF7\u68C0\u67E5\u53C2\u6570",n);let t=U.conversation.dataList;if(e&&(t=t.filter(i=>i.id==e),t.length==0)){let i=yield this.loadMore(e);if(i)t=[i];else{if(n.group_id)throw new Error("\u672A\u627E\u5230\u6B64\u7FA4\u4F1A\u8BDD");if(typeof n!="object")throw D("log","at uni_modules/uni-im/lib/main.js:170","param",n),new Error("\u53C2\u6570\u9519\u8BEF");if(!n.user_info){let s=yield F.database().collection("uni-id-users").doc(n.friend_uid).field("_id,nickname,avatar_file").get();if(D("log","at uni_modules/uni-im/lib/main.js:180","user_info",s),n.user_info=s.result.data[0],!n.user_info)throw new Error("\u7528\u6237\u67E5\u627E\u5931\u8D25")}let o={group_id:n.group_id,friend_uid:n.friend_uid,unread_count:0};try{let r=yield F.database().collection("uni-im-conversation").add(o)}catch(s){throw new Error(s)}o=Object.assign(o,{user_id:Ot(),id:e,user_info:n.user_info,type:n.friend_uid?1:2,msgList:[],update_time:Date.now()}),this.add(o),t.push(o)}}if(e){let i=t[0];if(i.group_id&&Object.keys(i.group_member).length==0){let o=yield ce.collection(ce.collection("uni-im-group-member").where({group_id:i.group_id}).getTemp(),ce.collection("uni-id-users").field("_id,nickname,avatar_file").getTemp()).limit(1e3).get(),s={};o.result.data.forEach(r=>{let a=r.user_id[0];s[a._id]=a}),Jt.mergeUsersInfo(s),i.group_member=s}return i.isInit||(i.msgManager=new pt(i)),i}else return t})},loadMore(n){return A(this,null,function*(){if(!n){if(U.conversation.loading)return[];U.conversation.loading=!0}let e=yield this.get(),t=e[e.length-1],i=t?t.update_time:"";n&&(i="");let o={data:[]};try{o=yield Wn.getConversationList({maxUpdateTime:i,limit:30,conversation_id:n})}catch(s){D("log","at uni_modules/uni-im/lib/main.js:286",s),n||(U.conversation.loading=!1)}if(o.data.length&&this.add(o.data),n)return o.data[0];{U.conversation.loading=!1,U.conversation.hasMore=o.data.length==30;let s="user_id == $cloudEnv_uid",r=o.data.filter(l=>l.group_id).map(l=>l.group_id)||[];r.length&&(s=`(user_id == $cloudEnv_uid || "group_id" in ${JSON.stringify(r)})`);let a=uni.getStorageSync("uni-im-lastTaskTime");return a&&(s+=`&& "create_time" > ${a}`),ce.collection("uni-im-task").where(s).orderBy("create_time desc").get().then(l=>{l.result.data.length&&(l.result.data.forEach(c=>{c.type=="revoke_msg"&&this.revokeMsg(c.payload)}),uni.setStorageSync("uni-im-lastTaskTime",l.result.data[0].create_time))}).catch(l=>{D("error","at uni_modules/uni-im/lib/main.js:333",l)}),o.data}})},add(n){return Array.isArray(n)||(n=[n]),n.forEach(e=>{Array.isArray(e.user_info)&&(e.user_info=e.user_info[0]),Array.isArray(e.group_info)&&(e.group_info=e.group_info[0],e.group_id&&(e.group_member||(e.group_member={}),e.group_info.introduction===void 0&&(e.group_info.introduction=""),e.group_info.avatar_file===void 0&&(e.group_info.avatar_file={url:""}))),e=Object.assign(e,{isInit:!1,title:"",chatText:"",avatar_file:{},call_list:[]}),e.user_info?Object.defineProperties(e,{title:{get(){return e.user_info.nickname}},avatar_file:{get(){return e.user_info.avatar_file}},group_info:{value:!1}}):e.group_info?Object.defineProperties(e,{title:{get(){return e.group_info.name}},avatar_file:{get(){return e.group_info.avatar_file}},user_info:{value:!1}}):D("error","at uni_modules/uni-im/lib/main.js:412","\u4F1A\u8BDD\u5217\u8868\u5931\u6548\uFF0C\u7591\u4F3C\u5173\u8054\u7528\u6237/\u7FA4\u88AB\u5220\u9664(\u8BF7\u6539\u4E3A\u8F6F\u5220\u9664\u907F\u514D\u7CFB\u7EDF\u5F02\u5E38\uFF09\uFF1A",JSON.stringify(e));let t=e.update_time;Object.defineProperties(e,{last_msg_note:{get(){let a="\u6682\u65E0\u8BB0\u5F55",l=e.msgList[e.msgList.length-1];return e.chatText&&U.currentConversationId!=e.id&&(l={body:"[uni-im-draft]"+e.chatText,type:"text",create_time:Date.now()}),l&&(a="[\u591A\u5A92\u4F53]",l.type=="text"&&(a=l.body.toString(),a=a.replace(/[\r\n]/g,""),a=a.slice(0,30)),l.is_revoke&&(a="\u6D88\u606F\u5DF2\u88AB\u64A4\u56DE"),l.is_delete&&(a="\u6D88\u606F\u5DF2\u88AB\u5220\u9664")),a}},update_time:{get(){let a=e.msgList[e.msgList.length-1];return a?a.create_time:t}}});let{user_info:i,group_member:o}=e,s={};i&&(s[i._id]=i),Jt.mergeUsersInfo(s),e.msgManager=new pt(e);let r=a=>{for(let c=0;c<a.length;c++){let _=a[c];_&&typeof _=="object"&&("is_delete"in _||(_.is_delete=!1))}return["push","unshift"].forEach(c=>{a[c]=function(){r(arguments),Array.prototype[c].apply(this,arguments)}}),a};r(e.msgList),e.msgList.clear=function(){this.length=0},Object.defineProperty(e,"msgList",{writable:!1}),U.conversation.dataList.find(a=>a.id==e.id)||U.conversation.dataList.push(e)}),uni.setStorage({key:"uni-im-conversation_uid:"+Ot(),data:U.conversation}),n},unreadCount(){return U.conversation.dataList.reduce((e,t,i,o)=>e+t.unread_count,0)},remove(n){let e=U.conversation.dataList.findIndex(t=>t.id==n);U.conversation.dataList.splice(e,1)}},notification:{get:({type:n,excludeType:e}={})=>{let t=U.notification.dataList;return t?t.reduce((i,o)=>(n?(typeof n=="string"&&(n=[n]),n.includes(o.payload.subType)&&i.push(o)):e?(typeof e=="string"&&(e=[e]),e.includes(o.payload.subType)||i.push(o)):i.push(o),i),[]):!1},loadMore(){return A(this,null,function*(){let n=yield ce.collection("uni-im-notification").aggregate().match('"payload.type" == "uni-im-notification" && "user_id" == $cloudEnv_uid').sort({create_time:-1}).limit(1e3).end();this.add(n.result.data),this.hasMore==(n.result.data.length!=0)})},add(n){Array.isArray(n)||(n=[n]);let e=n.concat(U.notification.dataList);e.sort((s,r)=>s.create_time-r.create_time);let t={};for(var i=0;i<e.length;i++){let s=e[i],{subType:r,unique:a}=s.payload;t[a?r+"_"+a:Date.now()+"_"+i]=s}let o=[];for(let s in t){let r=t[s];o.push(r)}o.sort((s,r)=>r.create_time-s.create_time),U.notification.dataList=o},unreadCount(n={}){let t=this.get(n).reduce((i,o,s,r)=>(o.is_read||i++,i),0);return t===0?uni.removeTabBarBadge({index:2,complete:i=>{}}):uni.setTabBarBadge({index:2,text:t+"",complete:i=>{}}),t?t+"":""}},friend:{get(){return U.friend.dataList},loadMore(){return A(this,arguments,function*({friend_uid:n}={}){let e='"user_id" == $cloudEnv_uid';n&&(e+=`&& "friend_uid" == "${n}"`);let i=(yield ce.collection(ce.collection("uni-im-friend").where(e).field("friend_uid,mark,class_name").getTemp(),ce.collection("uni-id-users").field("_id,nickname,avatar_file").getTemp()).limit(500).get()).result.data;i.forEach((o,s)=>{i[s]=o.friend_uid[0];let r=i[s]._id;U.usersInfo[r]||(U.usersInfo[r]=o.friend_uid[0])}),U.friend.hasMore=i.length==500,U.friend.dataList.push(...i)})},remove(n){let e=U.friend.dataList,t=e.findIndex(i=>i._id==n);e.splice(t,1)}},group:{get(){return U.group.dataList},loadMore(){return A(this,arguments,function*({group_id:n}={}){let e='"user_id" == $cloudEnv_uid ';n&&(e+=`&& "group_id" == "${n}"`);let t=yield ce.collection(ce.collection("uni-im-group-member").where(e).getTemp(),ce.collection("uni-im-group").getTemp()).limit(500).get();t.result.data.map(i=>(i.group_info=i.group_id[0],delete i.group_id,i)),t.result.data=t.result.data.filter(i=>i.group_info),U.group.hasMore=t.result.data.length==500,n?U.group.dataList.push(...t.result.data):U.group.dataList=t.result.data})},remove({group_id:n}){let e=U.group.dataList,t=e.findIndex(i=>i.group_info._id==n);t!=-1&&e.splice(t,1)}},mergeUsersInfo(n){U.usersInfo=Object.assign({},U.usersInfo,n)},clearUnreadCount(n){return A(this,null,function*(){let e=yield this.conversation.get(n);setTimeout(function(){e.unread_count=0},10),F.database().collection("uni-im-conversation").where({user_id:Ot(),id:n}).update({unread_count:0}).then(t=>{D("log","at uni_modules/uni-im/lib/main.js:760","\u8BBE\u7F6E\u4E3A\u5DF2\u8BFB",t.result.updated)})})}},Es=function(n=[]){let e={};return n.forEach(t=>{let i=t,o=!1;if(t.includes(" as ")){let s=t.trim().split(" as ");i=s[0],o=s[1]}e[o||i]=function(){return U[i]}}),e},O=Ci(U,Jt,{mapState:Es});function Ci(){let n=arguments.length,e=arguments[0];Et(e)||(e={});for(let t=1;t<n;t++){let i=arguments[t];if(Et(i))for(let o in i)o==="__proto__"||e===i[o]||(Et(i[o])?e[o]=Ci(e[o],i[o]):e[o]=i[o])}return e}function Et(n){return typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"}var it={name:"uni-im",path:"_doc/uni-im.db"},Pi={init(n=()=>{}){return A(this,null,function*(){n()})},checkDataBaseIsOpen(){return A(this,null,function*(){if(O.dataBaseIsOpen)return!0;let n=plus.sqlite.isOpenDatabase(it);if(O.dataBaseIsOpen=n,!n){let e=yield new Promise((i,o)=>{plus.sqlite.openDatabase(ne(B({},it),{success:function(s){i(s)},fail:function(s){D("error","at uni_modules/uni-im/common/sqlite.js:26",s,"openDatabase failed: "+JSON.stringify(s)),o(s)}}))}),t=`create table if not exists msg(
					"_id" CHAR(32),
					"body" TEXT,
					"type" CHAR(32),
					"from_uid" CHAR(32),
					"to_uid" CHAR(32),
					"is_read" BOOLEAN,
					"friendly_time" DATETIME,
					"create_time" DATETIME,
					"conversation_id" CHAR(32),
					"group_id" CHAR(32),
					"client_create_time" DATETIME,
					"unique_id" CHAR(32),
					"appid" CHAR(32),
					"state" INT,
					"is_revoke" BOOLEAN,
					"is_delete" BOOLEAN,
					"action" TEXT
			)`;return this.executeSql(t),e}})},clearMsgTable(){return A(this,null,function*(){let n=yield this.executeSql("drop table msg");D("log","at uni_modules/uni-im/common/sqlite.js:58","clearMsgTable",n)})},executeSql(n){return A(this,null,function*(){return yield this.checkDataBaseIsOpen(),yield new Promise((e,t)=>{try{plus.sqlite.executeSql({name:it.name,sql:n,success:function(i){e(i)},fail:function(i){D("error","at uni_modules/uni-im/common/sqlite.js:77",i),D("error","at uni_modules/uni-im/common/sqlite.js:78",{sql:n}),D("error","at uni_modules/uni-im/common/sqlite.js:79","executeSql failed: "+JSON.stringify(i)),D("error","at uni_modules/uni-im/common/sqlite.js:80","executeSql failed: "+JSON.stringify(n)),t(i)}})}catch(i){t(i)}})})},selectSql(n){return A(this,null,function*(){return yield this.checkDataBaseIsOpen(),yield new Promise((e,t)=>A(this,null,function*(){try{plus.sqlite.selectSql({name:it.name,sql:n,success:function(i){e(i)},fail:function(i){D("error","at uni_modules/uni-im/common/sqlite.js:106","sql:"+n,"selectSql failed: "+JSON.stringify(i)),t(i)}})}catch(i){t(i)}}))})}};Pi.init();var Ds=F.importObject("uni-id-co",{customUI:!0}),zn=F.database(),Dt=!0,ot=!1,st=!0,Qt={init(){getApp().globalData.sqlite=Pi,O.socketOpenIndex=0,uni.onSocketClose(function(s){st=!0,D("log","at uni_modules/uni-im/common/utils.js:43","WebSocket \u5DF2\u5173\u95ED\uFF01")}),uni.onSocketOpen(function(s){D("log","at uni_modules/uni-im/common/utils.js:46","WebSocket\u8FDE\u63A5\u5DF2\u6253\u5F00\uFF01"),st=!1,O.socketOpenIndex++,O.socketOpenIndex>1&&n()}),ze.onAppShow(()=>A(this,null,function*(){n()}));function n(){ot||(ot=!0,setTimeout(()=>A(this,null,function*(){let s=(yield O.conversation.get())[0];if(!s){ot=!1;return}let r=yield zn.collection("uni-im-msg").where({to_uid:F.getCurrentUserInfo().uid,create_time:zn.command.gt(s.update_time)}).get();D("log","at uni_modules/uni-im/common/utils.js:82","getCloudMsg res",s.update_time,r.result.data);let a={};r.result.data.forEach(l=>{a[l.conversation_id]?a[l.conversation_id].push(l):a[l.conversation_id]=[l]});for(let l in a){let c=yield O.conversation.get(l),_=a[l];_.length&&(c.msgList.push(..._),c.msgManager.localMsg.add(_),c.unread_count+=_.length)}ot=!1}),0))}this.listenImMsg(),setInterval(()=>{O.heartbeat=Date.now()},1e3);let e=uni.createInnerAudioContext(),t={};Object.defineProperty(t,"src",{set(s){e.src=s},get(){return e.src}}),O.audioContext=new Proxy(t,{get(s,r,a){return e[r]}}),O.systemInfo=uni.getSystemInfoSync();function i(){O.conversation.dataList=[],O.notification.dataList=[],O.notification.loadMore(),O.friend.dataList=[],O.friend.loadMore(),O.group.dataList=[],O.group.loadMore();let s={};s[Ce.userInfo._id]=Ce.userInfo,O.mergeUsersInfo(s)}F.getCurrentUserInfo().tokenExpired>Date.now()&&setTimeout(i,0),uni.$on("uni-id-pages-login-success",()=>A(this,null,function*(){i()})),uni.onPushMessage(s=>A(this,null,function*(){s.data.payload.type=="uni-im-notification"&&(D("log","at uni_modules/uni-im/common/utils.js:198","uni-im-notification-res.data",s.data),s.data.create_time=Date.now(),typeof s.data.is_read=="undefined"&&(s.data.is_read=!1),D("log","at uni_modules/uni-im/common/utils.js:203","res.data notification.add",s.data),s.data._id=s.data.payload.notificationId,s.data,delete s.data.payload.notificationId,delete s.data.unipush_version,O.notification.add(s.data))})),["navigateTo","redirectTo","reLaunch","switchTab","navigateBack"].forEach(s=>{uni.addInterceptor(s,{success:r=>{o()}})});function o(){setTimeout(()=>{let s=O.notification.unreadCount();r(2,s),s=O.conversation.unreadCount(),r(0,s);function r(a,l){l==0?uni.removeTabBarBadge({index:a,complete:c=>{}}):uni.setTabBarBadge({index:a,text:l+"",complete:c=>{}})}},300)}uni.$on("uni-id-pages-logout",()=>{O.conversation.dataList=[],O.conversation.hasMore=!0,O.notification.dataList=[],O.notification.hasMore=!0,O.friend.dataList=[],O.friend.hasMore=!0,O.group.dataList=[],O.group.hasMore=!0,O.currentConversationId=!1}),ze.onAppHide(()=>A(this,null,function*(){Dt=!1})),ze.onAppShow(()=>A(this,null,function*(){Dt=!0,this.clearPushNotify()}))},getConversationId(n,e="single"){if(e=="single"){let t=F.getCurrentUserInfo().uid;return t||D("error","at uni_modules/uni-im/common/utils.js:332","\u9519\u8BEFcurrent_uid\u4E0D\u80FD\u4E3A\u7A7A",t),"single_"+Ii([n,t].sort().toString())}else return"group_"+n},listenImMsg(){uni.onPushMessage(n=>A(this,null,function*(){var e;D("log","at uni_modules/uni-im/common/utils.js:342","\u6536\u5230\u6D88\u606F",n);let{payload:t}=n.data;if(t.type=="uni-im"){let i=t.data;if(i.LongMsg){let s=yield F.database().collection("uni-im-msg").where({_id:i._id,conversation_id:i.conversation_id}).get();s.result.code==0?t.data.body=s.result.data[0].body:D("error","at uni_modules/uni-im/common/utils.js:363","\u8D85\u957F\u6587\u672C\u7C7B\u578B\u6D88\u606F\u67E5\u5E93\u5931\u8D25",i._id)}if(t.device_id==uni.getSystemInfoSync().deviceId)return D("log","at uni_modules/uni-im/common/utils.js:368","\u5F53\u524D\u8BBE\u5907\u53D1\u7684\u6D88\u606F\uFF0C\u4E0D\u7528\u63A5\u6536\uFF1B\u5FFD\u7565");if(n.type=="receive"){let{conversation_id:o,group_id:s}=i,r=getCurrentPages(),a=r[r.length-1].route;if(!Dt||!["uni_modules/uni-im/pages/chat/chat","uni_modules/uni-im/pages/index/index","uni_modules/uni-im/pages/userList/userList","uni_modules/uni-im/pages/contacts/contacts"].includes(a)){let{content:v,data:h,title:m,avatar_file:f}=t;f&&f.url;let d="_www/uni_modules/uni-im/static/avatarUrl.png";uni.getSystemInfoSync().platform=="android"&&f&&(d=(e=(yield uni.downloadFile({url:f.url}))[1])==null?void 0:e.tempFilePath),plus.push.createMessage(v,t,{title:m,icon:d})}else o!=O.currentConversationId;let c=yield O.conversation.get(o),_=c.msgList,u=[..._].pop();if(u&&u._id!=i._id&&(_.push(i),c.unread_count++),st||c.msgManager.localMsg.add(i),i.group_id&&i.about_msg_id){let v=F.getCurrentUserInfo().uid,h=_.find(m=>m._id==i.about_msg_id);h&&h.from_uid==v&&(c.call_list.push(i._id),D("log","at uni_modules/uni-im/common/utils.js:439","conversation.call_list",c.call_list))}if(i.action=="join-group-notice"){D("log","at uni_modules/uni-im/common/utils.js:450",'"join-group-notice"',i);let v=yield O.conversation.get(i.conversation_id);if(D("log","at uni_modules/uni-im/common/utils.js:452",'"join-group-notice"conversation',v),v){let h=i.body.user_list;if(h&&Object.keys(v.group_member)){for(let f=0;f<h.length;f++)v.group_member[h[f]._id]=h[f];D("log","at uni_modules/uni-im/common/utils.js:465","add user to group_member",v.group_member)}O.mergeUsersInfo(v.group_member),O.group.dataList.find(f=>f.group_info._id==s)||(yield O.group.loadMore({group_id:s}))}}}else{let o=getCurrentPages();o[o.length-1].route=="uni_modules/uni-im/pages/chat/chat"?uni.redirectTo({url:"/uni_modules/uni-im/pages/chat/chat?conversation_id="+i.conversation_id,complete(r){D("log","at uni_modules/uni-im/common/utils.js:490",r)}}):uni.navigateTo({url:"/uni_modules/uni-im/pages/chat/chat?conversation_id="+i.conversation_id,complete(r){D("log","at uni_modules/uni-im/common/utils.js:497",r)}})}}else if(t.type=="uni-im-group-exit"||t.type=="uni-im-group-expel"||t.subType=="uni-im-group-expel"){let{timestamp:i,group_id:o}=t.data,s="group_"+o,r=n.data.content,a=yield O.conversation.get(s),l={conversation_id:s,group_id:o,client_create_time:Date.now(),create_time:Date.now(),type:"system",body:r};if(a.msgList.push(l),st||a.msgManager.localMsg.add(l),t.data.user_id==F.getCurrentUserInfo().uid){let c=O.currentConversationId,_=Jn(),{route:u,options:v}=_.$page;u=="uni_modules/uni-im/pages/group/info"&&(c=v.conversation_id),c=="group_"+t.data.group_id&&uni.navigateBack({delta:2}),setTimeout(()=>{O.conversation.remove(s),O.group.remove({group_id:t.data.group_id})},1e3)}else{let c=yield O.conversation.get(s);delete c.group_member[t.data.user_id]}}else if(t.type=="uni-im-group-join-request")D("log","at uni_modules/uni-im/common/utils.js:573","\u6709\u7528\u6237\u7533\u8BF7\u52A0\u5165\u7FA4\u804A");else if(t.type=="uni-im-notification"&&t.subType=="uni-im-group-cancellation"){let{group_id:i}=t.data,o="group_"+i,s=O.currentConversationId,r=Jn(),{route:a,options:l}=r.$page;a=="uni_modules/uni-im/pages/group/info"&&(s=l.conversation_id),s==o&&uni.navigateBack({delta:2}),setTimeout(()=>{O.conversation.remove(o),O.group.remove({group_id:i})},1e3)}else if(t.type=="uni-im-notification"&&t.subType=="uni-im-friend-add"){let{from_uid:i,to_uid:o}=t.data,s=i==F.getCurrentUserInfo().uid?o:i;yield O.conversation.get({friend_uid:s}),O.friend.loadMore({friend_uid:s})}else if(t.type=="uni-im-notification"&&t.subType=="uni-im-friend-delete"){let{from_uid:i,to_uid:o}=t.data,s=i==F.getCurrentUserInfo().uid?o:i;O.conversation.remove(t.data.conversationId),O.friend.remove(s)}else t.type=="uni-im-revoke-msg"&&(yield O.conversation.revokeMsg(t.data),uni.setStorageSync("uni-im-lastTaskTime",t.data.taskCreateTime))}))},toFriendlyTime(n){return n-Date.now()<3600*1e3*2&&(n+=O.heartbeat*0),n?Ts(n):""},clearPushNotify(){plus.push.clear(),plus.runtime.setBadgeNumber(0)},login(t){return A(this,arguments,function*({token:n,tokenExpired:e}){uni.setStorage({key:"uni_id_token_expired",data:e}),uni.setStorage({key:"uni_id_token",data:n}),uni.getPushClientId({success:function(i){return A(this,null,function*(){let o=i.cid;yield Ds.setPushCid({pushClientId:o})})},fail(i){D("log","at uni_modules/uni-im/common/utils.js:688",i)}}),yield Ps.updateUserInfo(),uni.$emit("uni-id-pages-login-success")})}};function Jn(){let n=getCurrentPages();return n[n.length-1]}var Ie=ke(we());var Ms={id:"2852637",name:"uniui\u56FE\u6807\u5E93",font_family:"uniicons",css_prefix_text:"uniui-",description:"",glyphs:[{icon_id:"25027049",name:"yanse",font_class:"color",unicode:"e6cf",unicode_decimal:59087},{icon_id:"25027048",name:"wallet",font_class:"wallet",unicode:"e6b1",unicode_decimal:59057},{icon_id:"25015720",name:"settings-filled",font_class:"settings-filled",unicode:"e6ce",unicode_decimal:59086},{icon_id:"25015434",name:"shimingrenzheng-filled",font_class:"auth-filled",unicode:"e6cc",unicode_decimal:59084},{icon_id:"24934246",name:"shop-filled",font_class:"shop-filled",unicode:"e6cd",unicode_decimal:59085},{icon_id:"24934159",name:"staff-filled-01",font_class:"staff-filled",unicode:"e6cb",unicode_decimal:59083},{icon_id:"24932461",name:"VIP-filled",font_class:"vip-filled",unicode:"e6c6",unicode_decimal:59078},{icon_id:"24932462",name:"plus_circle_fill",font_class:"plus-filled",unicode:"e6c7",unicode_decimal:59079},{icon_id:"24932463",name:"folder_add-filled",font_class:"folder-add-filled",unicode:"e6c8",unicode_decimal:59080},{icon_id:"24932464",name:"yanse-filled",font_class:"color-filled",unicode:"e6c9",unicode_decimal:59081},{icon_id:"24932465",name:"tune-filled",font_class:"tune-filled",unicode:"e6ca",unicode_decimal:59082},{icon_id:"24932455",name:"a-rilidaka-filled",font_class:"calendar-filled",unicode:"e6c0",unicode_decimal:59072},{icon_id:"24932456",name:"notification-filled",font_class:"notification-filled",unicode:"e6c1",unicode_decimal:59073},{icon_id:"24932457",name:"wallet-filled",font_class:"wallet-filled",unicode:"e6c2",unicode_decimal:59074},{icon_id:"24932458",name:"paihangbang-filled",font_class:"medal-filled",unicode:"e6c3",unicode_decimal:59075},{icon_id:"24932459",name:"gift-filled",font_class:"gift-filled",unicode:"e6c4",unicode_decimal:59076},{icon_id:"24932460",name:"fire-filled",font_class:"fire-filled",unicode:"e6c5",unicode_decimal:59077},{icon_id:"24928001",name:"refreshempty",font_class:"refreshempty",unicode:"e6bf",unicode_decimal:59071},{icon_id:"24926853",name:"location-ellipse",font_class:"location-filled",unicode:"e6af",unicode_decimal:59055},{icon_id:"24926735",name:"person-filled",font_class:"person-filled",unicode:"e69d",unicode_decimal:59037},{icon_id:"24926703",name:"personadd-filled",font_class:"personadd-filled",unicode:"e698",unicode_decimal:59032},{icon_id:"24923351",name:"back",font_class:"back",unicode:"e6b9",unicode_decimal:59065},{icon_id:"24923352",name:"forward",font_class:"forward",unicode:"e6ba",unicode_decimal:59066},{icon_id:"24923353",name:"arrowthinright",font_class:"arrow-right",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923353",name:"arrowthinright",font_class:"arrowthinright",unicode:"e6bb",unicode_decimal:59067},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrow-left",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923354",name:"arrowthinleft",font_class:"arrowthinleft",unicode:"e6bc",unicode_decimal:59068},{icon_id:"24923355",name:"arrowthinup",font_class:"arrow-up",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923355",name:"arrowthinup",font_class:"arrowthinup",unicode:"e6bd",unicode_decimal:59069},{icon_id:"24923356",name:"arrowthindown",font_class:"arrow-down",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923356",name:"arrowthindown",font_class:"arrowthindown",unicode:"e6be",unicode_decimal:59070},{icon_id:"24923349",name:"arrowdown",font_class:"bottom",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923349",name:"arrowdown",font_class:"arrowdown",unicode:"e6b8",unicode_decimal:59064},{icon_id:"24923346",name:"arrowright",font_class:"right",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923346",name:"arrowright",font_class:"arrowright",unicode:"e6b5",unicode_decimal:59061},{icon_id:"24923347",name:"arrowup",font_class:"top",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923347",name:"arrowup",font_class:"arrowup",unicode:"e6b6",unicode_decimal:59062},{icon_id:"24923348",name:"arrowleft",font_class:"left",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923348",name:"arrowleft",font_class:"arrowleft",unicode:"e6b7",unicode_decimal:59063},{icon_id:"24923334",name:"eye",font_class:"eye",unicode:"e651",unicode_decimal:58961},{icon_id:"24923335",name:"eye-filled",font_class:"eye-filled",unicode:"e66a",unicode_decimal:58986},{icon_id:"24923336",name:"eye-slash",font_class:"eye-slash",unicode:"e6b3",unicode_decimal:59059},{icon_id:"24923337",name:"eye-slash-filled",font_class:"eye-slash-filled",unicode:"e6b4",unicode_decimal:59060},{icon_id:"24923305",name:"info-filled",font_class:"info-filled",unicode:"e649",unicode_decimal:58953},{icon_id:"24923299",name:"reload-01",font_class:"reload",unicode:"e6b2",unicode_decimal:59058},{icon_id:"24923195",name:"mic_slash_fill",font_class:"micoff-filled",unicode:"e6b0",unicode_decimal:59056},{icon_id:"24923165",name:"map-pin-ellipse",font_class:"map-pin-ellipse",unicode:"e6ac",unicode_decimal:59052},{icon_id:"24923166",name:"map-pin",font_class:"map-pin",unicode:"e6ad",unicode_decimal:59053},{icon_id:"24923167",name:"location",font_class:"location",unicode:"e6ae",unicode_decimal:59054},{icon_id:"24923064",name:"starhalf",font_class:"starhalf",unicode:"e683",unicode_decimal:59011},{icon_id:"24923065",name:"star",font_class:"star",unicode:"e688",unicode_decimal:59016},{icon_id:"24923066",name:"star-filled",font_class:"star-filled",unicode:"e68f",unicode_decimal:59023},{icon_id:"24899646",name:"a-rilidaka",font_class:"calendar",unicode:"e6a0",unicode_decimal:59040},{icon_id:"24899647",name:"fire",font_class:"fire",unicode:"e6a1",unicode_decimal:59041},{icon_id:"24899648",name:"paihangbang",font_class:"medal",unicode:"e6a2",unicode_decimal:59042},{icon_id:"24899649",name:"font",font_class:"font",unicode:"e6a3",unicode_decimal:59043},{icon_id:"24899650",name:"gift",font_class:"gift",unicode:"e6a4",unicode_decimal:59044},{icon_id:"24899651",name:"link",font_class:"link",unicode:"e6a5",unicode_decimal:59045},{icon_id:"24899652",name:"notification",font_class:"notification",unicode:"e6a6",unicode_decimal:59046},{icon_id:"24899653",name:"staff",font_class:"staff",unicode:"e6a7",unicode_decimal:59047},{icon_id:"24899654",name:"VIP",font_class:"vip",unicode:"e6a8",unicode_decimal:59048},{icon_id:"24899655",name:"folder_add",font_class:"folder-add",unicode:"e6a9",unicode_decimal:59049},{icon_id:"24899656",name:"tune",font_class:"tune",unicode:"e6aa",unicode_decimal:59050},{icon_id:"24899657",name:"shimingrenzheng",font_class:"auth",unicode:"e6ab",unicode_decimal:59051},{icon_id:"24899565",name:"person",font_class:"person",unicode:"e699",unicode_decimal:59033},{icon_id:"24899566",name:"email-filled",font_class:"email-filled",unicode:"e69a",unicode_decimal:59034},{icon_id:"24899567",name:"phone-filled",font_class:"phone-filled",unicode:"e69b",unicode_decimal:59035},{icon_id:"24899568",name:"phone",font_class:"phone",unicode:"e69c",unicode_decimal:59036},{icon_id:"24899570",name:"email",font_class:"email",unicode:"e69e",unicode_decimal:59038},{icon_id:"24899571",name:"personadd",font_class:"personadd",unicode:"e69f",unicode_decimal:59039},{icon_id:"24899558",name:"chatboxes-filled",font_class:"chatboxes-filled",unicode:"e692",unicode_decimal:59026},{icon_id:"24899559",name:"contact",font_class:"contact",unicode:"e693",unicode_decimal:59027},{icon_id:"24899560",name:"chatbubble-filled",font_class:"chatbubble-filled",unicode:"e694",unicode_decimal:59028},{icon_id:"24899561",name:"contact-filled",font_class:"contact-filled",unicode:"e695",unicode_decimal:59029},{icon_id:"24899562",name:"chatboxes",font_class:"chatboxes",unicode:"e696",unicode_decimal:59030},{icon_id:"24899563",name:"chatbubble",font_class:"chatbubble",unicode:"e697",unicode_decimal:59031},{icon_id:"24881290",name:"upload-filled",font_class:"upload-filled",unicode:"e68e",unicode_decimal:59022},{icon_id:"24881292",name:"upload",font_class:"upload",unicode:"e690",unicode_decimal:59024},{icon_id:"24881293",name:"weixin",font_class:"weixin",unicode:"e691",unicode_decimal:59025},{icon_id:"24881274",name:"compose",font_class:"compose",unicode:"e67f",unicode_decimal:59007},{icon_id:"24881275",name:"qq",font_class:"qq",unicode:"e680",unicode_decimal:59008},{icon_id:"24881276",name:"download-filled",font_class:"download-filled",unicode:"e681",unicode_decimal:59009},{icon_id:"24881277",name:"pengyouquan",font_class:"pyq",unicode:"e682",unicode_decimal:59010},{icon_id:"24881279",name:"sound",font_class:"sound",unicode:"e684",unicode_decimal:59012},{icon_id:"24881280",name:"trash-filled",font_class:"trash-filled",unicode:"e685",unicode_decimal:59013},{icon_id:"24881281",name:"sound-filled",font_class:"sound-filled",unicode:"e686",unicode_decimal:59014},{icon_id:"24881282",name:"trash",font_class:"trash",unicode:"e687",unicode_decimal:59015},{icon_id:"24881284",name:"videocam-filled",font_class:"videocam-filled",unicode:"e689",unicode_decimal:59017},{icon_id:"24881285",name:"spinner-cycle",font_class:"spinner-cycle",unicode:"e68a",unicode_decimal:59018},{icon_id:"24881286",name:"weibo",font_class:"weibo",unicode:"e68b",unicode_decimal:59019},{icon_id:"24881288",name:"videocam",font_class:"videocam",unicode:"e68c",unicode_decimal:59020},{icon_id:"24881289",name:"download",font_class:"download",unicode:"e68d",unicode_decimal:59021},{icon_id:"24879601",name:"help",font_class:"help",unicode:"e679",unicode_decimal:59001},{icon_id:"24879602",name:"navigate-filled",font_class:"navigate-filled",unicode:"e67a",unicode_decimal:59002},{icon_id:"24879603",name:"plusempty",font_class:"plusempty",unicode:"e67b",unicode_decimal:59003},{icon_id:"24879604",name:"smallcircle",font_class:"smallcircle",unicode:"e67c",unicode_decimal:59004},{icon_id:"24879605",name:"minus-filled",font_class:"minus-filled",unicode:"e67d",unicode_decimal:59005},{icon_id:"24879606",name:"micoff",font_class:"micoff",unicode:"e67e",unicode_decimal:59006},{icon_id:"24879588",name:"closeempty",font_class:"closeempty",unicode:"e66c",unicode_decimal:58988},{icon_id:"24879589",name:"clear",font_class:"clear",unicode:"e66d",unicode_decimal:58989},{icon_id:"24879590",name:"navigate",font_class:"navigate",unicode:"e66e",unicode_decimal:58990},{icon_id:"24879591",name:"minus",font_class:"minus",unicode:"e66f",unicode_decimal:58991},{icon_id:"24879592",name:"image",font_class:"image",unicode:"e670",unicode_decimal:58992},{icon_id:"24879593",name:"mic",font_class:"mic",unicode:"e671",unicode_decimal:58993},{icon_id:"24879594",name:"paperplane",font_class:"paperplane",unicode:"e672",unicode_decimal:58994},{icon_id:"24879595",name:"close",font_class:"close",unicode:"e673",unicode_decimal:58995},{icon_id:"24879596",name:"help-filled",font_class:"help-filled",unicode:"e674",unicode_decimal:58996},{icon_id:"24879597",name:"plus-filled",font_class:"paperplane-filled",unicode:"e675",unicode_decimal:58997},{icon_id:"24879598",name:"plus",font_class:"plus",unicode:"e676",unicode_decimal:58998},{icon_id:"24879599",name:"mic-filled",font_class:"mic-filled",unicode:"e677",unicode_decimal:58999},{icon_id:"24879600",name:"image-filled",font_class:"image-filled",unicode:"e678",unicode_decimal:59e3},{icon_id:"24855900",name:"locked-filled",font_class:"locked-filled",unicode:"e668",unicode_decimal:58984},{icon_id:"24855901",name:"info",font_class:"info",unicode:"e669",unicode_decimal:58985},{icon_id:"24855903",name:"locked",font_class:"locked",unicode:"e66b",unicode_decimal:58987},{icon_id:"24855884",name:"camera-filled",font_class:"camera-filled",unicode:"e658",unicode_decimal:58968},{icon_id:"24855885",name:"chat-filled",font_class:"chat-filled",unicode:"e659",unicode_decimal:58969},{icon_id:"24855886",name:"camera",font_class:"camera",unicode:"e65a",unicode_decimal:58970},{icon_id:"24855887",name:"circle",font_class:"circle",unicode:"e65b",unicode_decimal:58971},{icon_id:"24855888",name:"checkmarkempty",font_class:"checkmarkempty",unicode:"e65c",unicode_decimal:58972},{icon_id:"24855889",name:"chat",font_class:"chat",unicode:"e65d",unicode_decimal:58973},{icon_id:"24855890",name:"circle-filled",font_class:"circle-filled",unicode:"e65e",unicode_decimal:58974},{icon_id:"24855891",name:"flag",font_class:"flag",unicode:"e65f",unicode_decimal:58975},{icon_id:"24855892",name:"flag-filled",font_class:"flag-filled",unicode:"e660",unicode_decimal:58976},{icon_id:"24855893",name:"gear-filled",font_class:"gear-filled",unicode:"e661",unicode_decimal:58977},{icon_id:"24855894",name:"home",font_class:"home",unicode:"e662",unicode_decimal:58978},{icon_id:"24855895",name:"home-filled",font_class:"home-filled",unicode:"e663",unicode_decimal:58979},{icon_id:"24855896",name:"gear",font_class:"gear",unicode:"e664",unicode_decimal:58980},{icon_id:"24855897",name:"smallcircle-filled",font_class:"smallcircle-filled",unicode:"e665",unicode_decimal:58981},{icon_id:"24855898",name:"map-filled",font_class:"map-filled",unicode:"e666",unicode_decimal:58982},{icon_id:"24855899",name:"map",font_class:"map",unicode:"e667",unicode_decimal:58983},{icon_id:"24855825",name:"refresh-filled",font_class:"refresh-filled",unicode:"e656",unicode_decimal:58966},{icon_id:"24855826",name:"refresh",font_class:"refresh",unicode:"e657",unicode_decimal:58967},{icon_id:"24855808",name:"cloud-upload",font_class:"cloud-upload",unicode:"e645",unicode_decimal:58949},{icon_id:"24855809",name:"cloud-download-filled",font_class:"cloud-download-filled",unicode:"e646",unicode_decimal:58950},{icon_id:"24855810",name:"cloud-download",font_class:"cloud-download",unicode:"e647",unicode_decimal:58951},{icon_id:"24855811",name:"cloud-upload-filled",font_class:"cloud-upload-filled",unicode:"e648",unicode_decimal:58952},{icon_id:"24855813",name:"redo",font_class:"redo",unicode:"e64a",unicode_decimal:58954},{icon_id:"24855814",name:"images-filled",font_class:"images-filled",unicode:"e64b",unicode_decimal:58955},{icon_id:"24855815",name:"undo-filled",font_class:"undo-filled",unicode:"e64c",unicode_decimal:58956},{icon_id:"24855816",name:"more",font_class:"more",unicode:"e64d",unicode_decimal:58957},{icon_id:"24855817",name:"more-filled",font_class:"more-filled",unicode:"e64e",unicode_decimal:58958},{icon_id:"24855818",name:"undo",font_class:"undo",unicode:"e64f",unicode_decimal:58959},{icon_id:"24855819",name:"images",font_class:"images",unicode:"e650",unicode_decimal:58960},{icon_id:"24855821",name:"paperclip",font_class:"paperclip",unicode:"e652",unicode_decimal:58962},{icon_id:"24855822",name:"settings",font_class:"settings",unicode:"e653",unicode_decimal:58963},{icon_id:"24855823",name:"search",font_class:"search",unicode:"e654",unicode_decimal:58964},{icon_id:"24855824",name:"redo-filled",font_class:"redo-filled",unicode:"e655",unicode_decimal:58965},{icon_id:"24841702",name:"list",font_class:"list",unicode:"e644",unicode_decimal:58948},{icon_id:"24841489",name:"mail-open-filled",font_class:"mail-open-filled",unicode:"e63a",unicode_decimal:58938},{icon_id:"24841491",name:"hand-thumbsdown-filled",font_class:"hand-down-filled",unicode:"e63c",unicode_decimal:58940},{icon_id:"24841492",name:"hand-thumbsdown",font_class:"hand-down",unicode:"e63d",unicode_decimal:58941},{icon_id:"24841493",name:"hand-thumbsup-filled",font_class:"hand-up-filled",unicode:"e63e",unicode_decimal:58942},{icon_id:"24841494",name:"hand-thumbsup",font_class:"hand-up",unicode:"e63f",unicode_decimal:58943},{icon_id:"24841496",name:"heart-filled",font_class:"heart-filled",unicode:"e641",unicode_decimal:58945},{icon_id:"24841498",name:"mail-open",font_class:"mail-open",unicode:"e643",unicode_decimal:58947},{icon_id:"24841488",name:"heart",font_class:"heart",unicode:"e639",unicode_decimal:58937},{icon_id:"24839963",name:"loop",font_class:"loop",unicode:"e633",unicode_decimal:58931},{icon_id:"24839866",name:"pulldown",font_class:"pulldown",unicode:"e632",unicode_decimal:58930},{icon_id:"24813798",name:"scan",font_class:"scan",unicode:"e62a",unicode_decimal:58922},{icon_id:"24813786",name:"bars",font_class:"bars",unicode:"e627",unicode_decimal:58919},{icon_id:"24813788",name:"cart-filled",font_class:"cart-filled",unicode:"e629",unicode_decimal:58921},{icon_id:"24813790",name:"checkbox",font_class:"checkbox",unicode:"e62b",unicode_decimal:58923},{icon_id:"24813791",name:"checkbox-filled",font_class:"checkbox-filled",unicode:"e62c",unicode_decimal:58924},{icon_id:"24813794",name:"shop",font_class:"shop",unicode:"e62f",unicode_decimal:58927},{icon_id:"24813795",name:"headphones",font_class:"headphones",unicode:"e630",unicode_decimal:58928},{icon_id:"24813796",name:"cart",font_class:"cart",unicode:"e631",unicode_decimal:58929}]},Rs="/assets/uniicons.89ed7d6d.ttf",Ns={"uni-icons":{"":{fontFamily:"uniicons",textDecoration:"none",textAlign:"center"}}},Us=n=>typeof n=="number"||/^[0-9]*$/g.test(n)?n+"px":n,js=weex.requireModule("dom");js.addRule("fontFace",{fontFamily:"uniicons",src:"url('"+Rs+"')"});var Bs={name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""}},data(){return{icons:Ms.glyphs}},computed:{unicode(){let n=this.icons.find(e=>e.font_class===this.type);return n?unescape(`%u${n.unicode}`):""},iconSize(){return Us(this.size)}},methods:{_onClick(){this.$emit("click")}}};function Fs(n,e,t,i,o,s){return(0,Ie.openBlock)(),(0,Ie.createElementBlock)("u-text",{style:(0,Ie.normalizeStyle)({color:t.color,"font-size":s.iconSize}),class:"uni-icons",onClick:e[0]||(e[0]=(...r)=>s._onClick&&s._onClick(...r))},(0,Ie.toDisplayString)(s.unicode),5)}var yt=ie(Bs,[["render",Fs],["styles",[Ns]]]);var E=ke(we());var L=ke(we());var qs={"uni-list-chat":{"":{fontSize:16,position:"relative",flexDirection:"column",justifyContent:"space-between",backgroundColor:"#ffffff"}},"uni-list-chat--hover":{"":{backgroundColor:"#f5f5f5"}},"uni-list--border":{"":{position:"relative",marginLeft:15,borderTopColor:"#e5e5e5",borderTopStyle:"solid",borderTopWidth:.5}},"uni-list-chat--first":{"":{borderTopWidth:0}},"uni-ellipsis":{"":{lines:1}},"uni-ellipsis-2":{"":{lines:2}},"uni-list-chat__container":{"":{position:"relative",flexDirection:"row",flex:1,paddingTop:10,paddingRight:15,paddingBottom:10,paddingLeft:15,overflow:"hidden"}},"uni-list-chat__header-warp":{"":{position:"relative"}},"uni-list-chat__header":{"":{flexDirection:"row",justifyContent:"center",alignItems:"center",flexWrap:"wrap-reverse",width:50,height:50,borderRadius:5,borderColor:"#eeeeee",borderWidth:1,borderStyle:"solid",overflow:"hidden"}},"uni-list-chat__header-box":{"":{width:50,height:50,overflow:"hidden",borderRadius:2}},"uni-list-chat__header-image":{"":{marginTop:1,marginRight:1,marginBottom:1,marginLeft:1,width:50,height:50}},"header--circle":{"":{borderRadius:50}},"uni-list-chat__content":{"":{flexDirection:"row",flex:1,overflow:"hidden",paddingTop:2,paddingRight:0,paddingBottom:2,paddingLeft:0}},"uni-list-chat__content-main":{"":{flexDirection:"column",justifyContent:"space-between",paddingLeft:10,flex:1,overflow:"hidden"}},"uni-list-chat__content-title":{"":{fontSize:16,color:"#3b4144",fontWeight:"normal",overflow:"hidden"}},draft:{"":{marginTop:3,color:"#eb3a41",fontSize:12,fontWeight:"normal",overflow:"hidden",paddingRight:3}},"uni-list-chat__content-note":{"":{marginTop:3,color:"#999999",fontSize:12,fontWeight:"normal",overflow:"hidden"}},"uni-list-chat__content-extra":{"":{flexDirection:"column",justifyContent:"space-between",alignItems:"flex-end",marginLeft:5}},"uni-list-chat__content-extra-text":{"":{color:"#999999",fontSize:12,fontWeight:"normal",overflow:"hidden"}},"uni-list-chat__badge-pos":{"":{position:"absolute",left:55,top:3}},"uni-list-chat__badge":{"":{justifyContent:"center",alignItems:"center",borderRadius:100,backgroundColor:"#ff5a5f"}},"uni-list-chat__badge-text":{"":{color:"#ffffff",fontSize:12}},"uni-badge--single":{"":{width:18,height:18}},"uni-badge--complex":{"":{left:50,height:18,paddingTop:0,paddingRight:6,paddingBottom:0,paddingLeft:6}},"uni-badge--dot":{"":{left:60,top:6,width:10,height:10,paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}},"uni-list-chat--right":{"":{left:0}}},Zt=45,Hs={name:"UniListChat",emits:["click"],props:{title:{type:String,default:""},note:{type:String,default:""},clickable:{type:Boolean,default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},badgeText:{type:[String,Number],default:""},badgePositon:{type:String,default:"right"},time:{type:String,default:""},avatarCircle:{type:Boolean,default:!1},avatar:{type:String,default:""},avatarList:{type:Array,default(){return[]}}},computed:{isDraft(){return this.note.slice(0,14)=="[uni-im-draft]"},isSingle(){return this.badgeText==="dot"?"uni-badge--dot":this.badgeText.toString().length>1?"uni-badge--complex":"uni-badge--single"},computedAvatar(){return this.avatarList.length>4?(this.imageWidth=Zt*.31,"avatarItem--3"):this.avatarList.length>1?(this.imageWidth=Zt*.47,"avatarItem--2"):(this.imageWidth=Zt,"avatarItem--1")}},watch:{avatar:{handler(n){n.substr(0,8)=="cloud://"?F.getTempFileURL({fileList:[n]}).then(e=>{let t=e.fileList||e.result.fileList;this.avatarUrl=t[0].tempFileURL}):this.avatarUrl=n},immediate:!0}},data(){return{isFirstChild:!1,border:!0,imageWidth:50,avatarUrl:""}},mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0),this.border=this.list.border)},methods:{getForm(n="uniList"){let e=this.$parent,t=e.$options.name;for(;t!==n;){if(e=e.$parent,!e)return!1;t=e.$options.name}return e},onClick(){if(this.to!==""){this.openPage();return}(this.clickable||this.link)&&this.$emit("click",{data:{}})},openPage(){["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)!==-1?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(n){let e={url:this.to,success:t=>{this.$emit("click",{data:t})},fail:t=>{this.$emit("click",{data:t})}};switch(n){case"navigateTo":uni.navigateTo(e);break;case"redirectTo":uni.redirectTo(e);break;case"reLaunch":uni.reLaunch(e);break;case"switchTab":uni.switchTab(e);break;default:uni.navigateTo(e)}}}};function Ws(n,e,t,i,o,s){return(0,L.openBlock)(),(0,L.createElementBlock)("cell",null,[(0,L.createElementVNode)("view",{hoverClass:!t.clickable&&!t.link?"":"uni-list-chat--hover",class:"uni-list-chat",onClick:e[0]||(e[0]=(0,L.withModifiers)((...r)=>s.onClick&&s.onClick(...r),["stop"]))},[(0,L.createElementVNode)("view",{class:(0,L.normalizeClass)({"uni-list--border":o.border,"uni-list-chat--first":o.isFirstChild})},null,2),(0,L.createElementVNode)("view",{class:"uni-list-chat__container"},[(0,L.createElementVNode)("view",{class:"uni-list-chat__header-warp"},[t.avatarCircle||t.avatarList.length===0?((0,L.openBlock)(),(0,L.createElementBlock)("view",{key:0,class:(0,L.normalizeClass)(["uni-list-chat__header",{"header--circle":t.avatarCircle}])},[(0,L.createElementVNode)("u-image",{class:(0,L.normalizeClass)(["uni-list-chat__header-image",{"header--circle":t.avatarCircle}]),src:o.avatarUrl,mode:"aspectFill"},null,10,["src"])],2)):((0,L.openBlock)(),(0,L.createElementBlock)("view",{key:1,class:"uni-list-chat__header"},[((0,L.openBlock)(!0),(0,L.createElementBlock)(L.Fragment,null,(0,L.renderList)(t.avatarList,(r,a)=>((0,L.openBlock)(),(0,L.createElementBlock)("view",{key:a,class:(0,L.normalizeClass)(["uni-list-chat__header-box",s.computedAvatar]),style:(0,L.normalizeStyle)({width:o.imageWidth+"px",height:o.imageWidth+"px"})},[(0,L.createElementVNode)("u-image",{class:"uni-list-chat__header-image",style:(0,L.normalizeStyle)({width:o.imageWidth+"px",height:o.imageWidth+"px"}),src:r.url,mode:"aspectFill"},null,12,["src"])],6))),128))]))]),(0,L.renderSlot)(n.$slots,"header"),t.badgeText&&t.badgePositon==="left"?((0,L.openBlock)(),(0,L.createElementBlock)("view",{key:0,class:(0,L.normalizeClass)(["uni-list-chat__badge uni-list-chat__badge-pos",[s.isSingle]])},[(0,L.createElementVNode)("u-text",{class:"uni-list-chat__badge-text"},(0,L.toDisplayString)(t.badgeText==="dot"?"":t.badgeText),1)],2)):(0,L.createCommentVNode)("",!0),(0,L.createElementVNode)("view",{class:"uni-list-chat__content"},[(0,L.createElementVNode)("view",{class:"uni-list-chat__content-main"},[(0,L.createElementVNode)("u-text",{class:"uni-list-chat__content-title uni-ellipsis"},(0,L.toDisplayString)(t.title),1),(0,L.createElementVNode)("view",{style:{"flex-direction":"row"}},[s.isDraft?((0,L.openBlock)(),(0,L.createElementBlock)("u-text",{key:0,class:"draft"},"[\u8349\u7A3F]")):(0,L.createCommentVNode)("",!0),(0,L.createElementVNode)("u-text",{class:"uni-list-chat__content-note uni-ellipsis"},(0,L.toDisplayString)(s.isDraft?t.note.slice(14):t.note),1)])]),(0,L.createElementVNode)("view",{class:"uni-list-chat__content-extra"},[(0,L.renderSlot)(n.$slots,"default",{},()=>[(0,L.createElementVNode)("u-text",{class:"uni-list-chat__content-extra-text"},(0,L.toDisplayString)(t.time),1),t.badgeText&&t.badgePositon==="right"?((0,L.openBlock)(),(0,L.createElementBlock)("view",{key:0,class:(0,L.normalizeClass)(["uni-list-chat__badge",[s.isSingle,t.badgePositon==="right"?"uni-list-chat--right":""]])},[(0,L.createElementVNode)("u-text",{class:"uni-list-chat__badge-text"},(0,L.toDisplayString)(t.badgeText==="dot"?"":t.badgeText),1)],2)):(0,L.createCommentVNode)("",!0)])])])])],8,["hoverClass"])])}var Li=ie(Hs,[["render",Ws],["styles",[qs]]]);var zs=n=>n!==null&&typeof n=="object",Js=["{","}"],en=class{constructor(){this._caches=Object.create(null)}interpolate(e,t,i=Js){if(!t)return[e];let o=this._caches[e];return o||(o=Gs(e,i),this._caches[e]=o),Ys(o,t)}},Vs=/^(?:\d)+/,Ks=/^(?:\w)+/;function Gs(n,[e,t]){let i=[],o=0,s="";for(;o<n.length;){let r=n[o++];if(r===e){s&&i.push({type:"text",value:s}),s="";let a="";for(r=n[o++];r!==void 0&&r!==t;)a+=r,r=n[o++];let l=r===t,c=Vs.test(a)?"list":l&&Ks.test(a)?"named":"unknown";i.push({value:a,type:c})}else s+=r}return s&&i.push({type:"text",value:s}),i}function Ys(n,e){let t=[],i=0,o=Array.isArray(e)?"list":zs(e)?"named":"unknown";if(o==="unknown")return t;for(;i<n.length;){let s=n[i];switch(s.type){case"text":t.push(s.value);break;case"list":t.push(e[parseInt(s.value,10)]);break;case"named":o==="named"&&t.push(e[s.value]);break}i++}return t}var Xt="zh-Hans",Oi="zh-Hant",je="en",$s="fr",Qs="es",Zs=Object.prototype.hasOwnProperty,Ei=(n,e)=>Zs.call(n,e),Xs=new en;function ea(n,e){return!!e.find(t=>n.indexOf(t)!==-1)}function ta(n,e){return e.find(t=>n.indexOf(t)===0)}function Di(n,e){if(!n)return;if(n=n.trim().replace(/_/g,"-"),e&&e[n])return n;if(n=n.toLowerCase(),n==="chinese")return Xt;if(n.indexOf("zh")===0)return n.indexOf("-hans")>-1?Xt:n.indexOf("-hant")>-1||ea(n,["-tw","-hk","-mo","-cht"])?Oi:Xt;let t=[je,$s,Qs];e&&Object.keys(e).length>0&&(t=Object.keys(e));let i=ta(n,t);if(i)return i}var tn=class{constructor({locale:e,fallbackLocale:t,messages:i,watcher:o,formater:s}){this.locale=je,this.fallbackLocale=je,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=s||Xs,this.messages=i||{},this.setLocale(e||je),o&&this.watchLocale(o)}setLocale(e){let t=this.locale;this.locale=Di(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach(i=>{i(this.locale,t)})}getLocale(){return this.locale}watchLocale(e){let t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,i=!0){let o=this.messages[e];o?i?Object.assign(o,t):Object.keys(t).forEach(s=>{Ei(o,s)||(o[s]=t[s])}):this.messages[e]=t}f(e,t,i){return this.formater.interpolate(e,t,i).join("")}t(e,t,i){let o=this.message;return typeof t=="string"?(t=Di(t,this.messages),t&&(o=this.messages[t])):i=t,Ei(o,e)?this.formater.interpolate(o[e],i).join(""):(console.warn(`Cannot translate the value of keypath ${e}. Use the value of keypath as default.`),e)}};function na(n,e){n.$watchLocale?n.$watchLocale(t=>{e.setLocale(t)}):n.$watch(()=>n.$locale,t=>{e.setLocale(t)})}function ia(){return typeof uni!="undefined"&&uni.getLocale?uni.getLocale():typeof global!="undefined"&&global.getLocale?global.getLocale():je}function Mi(n,e={},t,i){typeof n!="string"&&([n,e]=[e,n]),typeof n!="string"&&(n=ia()),typeof t!="string"&&(t=typeof __uniConfig!="undefined"&&__uniConfig.fallbackLocale||je);let o=new tn({locale:n,fallbackLocale:t,messages:e,watcher:i}),s=(r,a)=>{if(typeof getApp!="function")s=function(l,c){return o.t(l,c)};else{let l=!1;s=function(c,_){let u=getApp().$vm;return u&&(u.$locale,l||(l=!0,na(u,o))),o.t(c,_)}}return s(r,a)};return{i18n:o,f(r,a,l){return o.f(r,a,l)},t(r,a){return s(r,a)},add(r,a,l=!0){return o.add(r,a,l)},watch(r){return o.watchLocale(r)},getLocale(){return o.getLocale()},setLocale(r){return o.setLocale(r)}}}var G=ke(we());var oa={"uni-load-more.contentdown":"Pull up to show more","uni-load-more.contentrefresh":"loading...","uni-load-more.contentnomore":"No more data"},sa={"uni-load-more.contentdown":"\u4E0A\u62C9\u663E\u793A\u66F4\u591A","uni-load-more.contentrefresh":"\u6B63\u5728\u52A0\u8F7D...","uni-load-more.contentnomore":"\u6CA1\u6709\u66F4\u591A\u6570\u636E\u4E86"},aa={"uni-load-more.contentdown":"\u4E0A\u62C9\u986F\u793A\u66F4\u591A","uni-load-more.contentrefresh":"\u6B63\u5728\u52A0\u8F09...","uni-load-more.contentnomore":"\u6C92\u6709\u66F4\u591A\u6578\u64DA\u4E86"},ra={en:oa,"zh-Hans":sa,"zh-Hant":aa},ca={"uni-load-more":{"":{flexDirection:"row",height:40,alignItems:"center",justifyContent:"center"}},"uni-load-more__text":{"":{fontSize:14,marginLeft:8}},"uni-load-more__img":{"":{width:24,height:24}},"uni-load-more__img--nvue":{"":{color:"#666666"}},"uni-load-more__img--android":{"":{width:24,height:24,transform:"rotate(0deg)"}},"uni-load-more__img--ios":{"":{width:24,height:24,transform:"rotate(0deg)"}}},Ri;setTimeout(()=>{Ri=uni.getSystemInfoSync().platform},16);var{t:nn}=Mi(ra),la={name:"UniLoadMore",emits:["clickLoadMore"],props:{status:{type:String,default:"more"},showIcon:{type:Boolean,default:!0},iconType:{type:String,default:"auto"},iconSize:{type:Number,default:24},color:{type:String,default:"#777777"},contentText:{type:Object,default(){return{contentdown:"",contentrefresh:"",contentnomore:""}}},showText:{type:Boolean,default:!0}},data(){return{webviewHide:!1,platform:Ri,imgBase64:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QzlBMzU3OTlEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QzlBMzU3OUFEOUM0MTFFOUI0NTZDNERBQURBQzI4RkUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpDOUEzNTc5N0Q5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpDOUEzNTc5OEQ5QzQxMUU5QjQ1NkM0REFBREFDMjhGRSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pt+ALSwAAA6CSURBVHja1FsLkFZVHb98LM+F5bHL8khA1iSeiyQBCRM+YGqKUnnJTDLGI0BGZlKDIU2MMglUiDApEZvSsZnQtBRJtKwQNKQMFYeRDR10WOLd8ljYXdh+v8v5fR3Od+797t1dnOnO/Ofce77z+J//+b/P+ZqtXbs2sJ9MJhNUV1cHJ06cCJo3bx7EPc2aNcvpy7pWrVoF+/fvDyoqKoI2bdoE9fX1F7TjN8a+EXBn/fkfvw942Tf+wYMHg9mzZwfjxo0LDhw4EPa1x2MbFw/fOGfPng1qa2tzcCkILsLDydq2bRsunpOTMM7TD/W/tZDZhPdeKD+yGxHhdu3aBV27dg3OnDlzMVANMheLAO3btw8KCwuDmpoaX5OxbgUIMEq7K8IcPnw4KCsrC/r37x8cP378/4cAXAB3vqSkJMuiDhTkw+XcuXNhOWbMmKBly5YhUT8xArhyFvP0BfwRsAuwxJZJsm/nzp2DTp06he/OU+cZ64K6o0ePBkOHDg2GDx8e6gEbJ5Q/NHNuAJQ1hgBeHUDlR7nVTkY8rQAvAi4z34vR/mPs1FoRsaCgIJThI0eOBC1atEiFGGV+5MiRoS45efJkqFjJFXV1dQuA012m2WcwTw98fy6CqBdsaiIO4CScrGPHjvk4odhavPquRtFWXEC25VgkREKOCh/qDSq+vn37htzD/mZTOmOc5U7zKzBPEedygWshcDyWvs30igAbU+6oyMgJBCFhwQE0fccxN60Ay9iebbjoDh06hMowjQxT4fXq1SskArmHZpkArvixp/kWzHdMeArExSJEaiXIjjRjRJ4DaAGWpibLzXN3Fm1vA5teBgh3j1Rv3bp1YgKwPdmf2p9zcyNYYgPKMfY0T5f5nNYdw158nJ8QawW4CLKwiOBSEgO/hok2eBydR+3dYH+PLxA5J8Vv0KBBwenTp0P2JWAx6+yFEBfs8lMY+y0SWMBNI9E4ThKi58VKTg3FQZS1RQF1cz27eC0QHMu+3E0SkUowjhVt5VdaWhp07949ZHv2Qd1EjDXM2cla1M0nl3GxAs3J9yREzyTdFVKVFOaE9qRA8GM0WebRuo9JGZKA7Mv2SeS/Z8+eoQ9BArMfFrLGo6jvxbhHbJZnKX2Rzz1O7QhJJ9Cs2ZMaWIyq/zhdeqPNfIoHd58clIQD+JSXl4dKlyIAuBdVXZwFVWKspSSoxE++h8x4k3uCnEhE4I5KwRiFWGOU0QWKiCYLbdoRMRKAu2kQ9vkfLU6dOhX06NEjlH+yMRZSinnuyWnYosVcji8CEA/6Cg2JF+IIUBqnGKUTCNwtwBN4f89RiK1R96DEgO2o0NDmtEdvVFdVVYV+P3UAPUEs6GFwV3PHmXkD4vh74iDFJysVI/MlaQhwKeBNTLYX5VuA8T4/gZxA4MRGFxDB6R7OmYPfyykGRJbyie+XnGYnQIC/coH9+vULiYrxrkL9ZA9+0ykaHIfEpM7ge8TiJ2CsHYwyMfafAF1yCGBHYIbCVDjDjKt7BeB51D+LgQa6OkG7IDYEEtvQ7lnXLKLtLdLuJBpE4gPUXcW2+PkZwOex+4cGDhwYDBkyRL7/HFcEwUGPo/8uWRUpYnfxGHco8HkewLHLyYmAawAPuIFZxhOpDfJQ8gbUv41yORAptMWBNr6oqMhWird5+u+iHmBb2nhjDV7HWBNQTgK8y11l5NetWzc5ULscAtSj7nbNI0skhWeUZCc0W4nyH/jO4Vz0u1IeYhbk4AiwM6tjxIWByHsoZ9qcIBPJd/y+DwPfBESOmCa/QF3WiZHucLlEDpNxcNhmheEOPgdQNx6/VZFQzFZ5TN08AHXQt2Ii3EdyFuUsPtTcGPhW5iMiCNELvz+Gdn9huG4HUJaW/w3g0wxV0XaG7arG2WeKiUWYM4Y7GO5ezshTARbbWGw/DvXkpp/ivVvE0JVoMxN4rpGzJMhE5Pl+xlATsDIqikP9F9D2z3h9nOksEUFhK+qO4rcPkoalMQ/HqJLIyb3F3JdjrCcw1yZ8joyJLR5gCo54etlag7qIoeNh1N1BRYj3DTFJ0elotxPlVzkGuYAmL0VSJVGAJA41c4Z6A3BzTLfn0HYwYKEI6CUAMzZEWvLsIcQOo1AmmyyM72nHJCfYsogflGV6jEk9vyQZXSuq6w4c16NsGcGZbwOPr+H1RkOk2LEzjNepxQkihHSCQ4ynAYNRx2zMKV92CQMWqj8J0BRE8EShxRFN6YrfCRhC0x3r/Zm4IbQCcmJoV0kMamllccR6FjHqUC5F2R/wS2dcymOlfAKOS4KmzQb5cpNC2MC7JhVn5wjXoJ44rYhLh8n0eXOCorJxa7POjbSlCGVczr34/RsAmrcvo9s+wGp3tzVhntxiXiJ4nvEYb4FJkf0O8HocAePmLvCxnL0AORraVekJk6TYjDabRVXfRE2lCN1h6ZQRN1+InUbsCpKwoBZHh0dODN9JBCUffItXxEavTQkUtnfTVAplCWL3JISz29h4NjotnuSsQKJCk8dF+kJR6RARjrqFVmfPnj3ZbK8cIJ0msd6jgHPGtfVTQ8VLmlvh4mct9sobRmPic0DyDQQnx/NlfYUgyz59+oScsH379pAwXABD32nTpoUHIToESeI5mnbE/UqDdyLcafEBf2MCqgC7NwxIbMREJQ0g4D4sfJwnD+AmRrII05cfMWJE+L1169bQr+fip06dGp4oJ83lmYd5wj/EmMa4TaHivo4EeCguYZBnkB5g2aWA69OIEnUHOaGysjIYMGBAMGnSpODYsWPZwCpFmm4lNq+4gSLQA7jcX8DwtjEyRC8wjabnXEx9kfWnTJkSJkAo90xpJVV+FmcVNeYAF5zWngS4C4O91MBxmAv8blLEpbjI5sz9MTdAhcgkCT1RO8mZkAjfiYpTEvStAS53Uw1vAiUGgZ3GpuQEYvoiBqlIan7kSDHnTwJQFNiPu0+5VxCVYhcZIjNrdXUDdp+Eq5AZ3Gkg8QAyVZRZIk4Tl4QAbF9cXJxNYZMAtAokgs4BrNxEpCtteXg7DDTMDKYNSuQdKsnJBek7HxewvxaosWxLYXtw+cJp18217wql4aKCfBNoEu0O5VU+PhctJ0YeXD4C6JQpyrlpSLTojpGGGN5YwNziChdIZLk4lvLcFJ9jMX3QdiImY9bmGQU+TRUL5CHITTRlgF8D9ouD1MfmLoEPl5xokIumZ2cfgMpHt47IW9N64Hsh7wQYYjyIugWuF5fCqYncXRd5vPMWyizzvhi/32+nvG0dZc9vR6fZOu0md5e+uC408FvKSIOZwXlGvxPv95izA2Vtvg1xKFWARI+vMX66HUhpQQb643uW1bSjuTWyw2SBvDrBvjFic1eGGlz5esq3ko9uSIlBRqPuFcCv8F4WIcN12nVaBd0SaYwI6PDDImR11JkqgHcPmQssjxIn6bUshygDFJUTxPMpHk+jfjPgupgdnYV2R/g7xSjtpah8RJBewhwf0gGK6XI92u4wXFEU40afJ4DN4h5LcAd+40HI3JgJecuT0c062W0i2hQJUTcxan3/CMW1PF2K6bbA+Daz4xRs1D3Br1Cm0OihKCqizW78/nXAF/G5TXrEcVzaNMH6CyMswqsAHqDyDLEyou8lwOXnKF8DjI6KjV3KzMBiXkDH8ij/H214J5A596ekrZ3F0zXlWeL7+P5eUrNo3/QwC15uxthuzidy7DzKRwEDaAViiDgKbTbz7CJnzo0bN7pIfIiid8SuPwn25o3QCmpnyjlZkyxPP8EomCJzrGb7GJMx7tNsq4MT2xMUYaiErZOluTzKsnz3gwCeCZyVRZJfYplNEokEjwrPtxlxjeYAk+F1F74VAzPxQRNYYdtpOUvWs8J1sGhBJMNsb7igN8plJs1eSmLIhLKE4rvaCX27gOhLpLOsIzJ7qn/i+wZzcvSOZ23/du8TZjwV8zHIXoP4R3ifBxiFz1dcVpa3aPntPE+c6TmIWE9EtcMmAcPdWAhYhAXxcLOQi9L1WhD1Sc8p1d2oL7XGiRKp8F4A2i8K/nfI+y/gsTDJ/YC/8+AD5Uh04KHiGl+cIFPnBDDrPMjwRGkLXyxO4VGbfQWnDH2v0bVWE3C9QOXlepbgjEfIJQI6XDG3z5ahD9cw2pS78ipB85wyScNTvsVzlzzhL8/jRrnmVjfFJK/m3m4nj9vbgQTguT8XZTjsm672R5uJKEaQmBI/c58gyus8ZDagLpEVSJBIyHp4jn++xqPV71OgQgJYEWOtZ/haxRtKmWOBu8xdBLftWltsY84zE6WIEy/eIOWL+BaayMx+KHtL7EAkqdNDLiEXmEMUHniedtJqg9HmZtfvt26vNi0BdG3Ft3g8ZOf7PAu59TxtzivLNIekyi+wD1i8CuUiD9FXAa8C+/xS3JPmZnomyc7H+fb4/Se0bk41Fel621r4cgVxbq91V4jVqwB7HTe2M7jgB+QWHavZkDRPmZcASoZEmBx6i75bGjPcMdL4/VKGFAGWZkGzPG0XAbdL9A81G5LOmUnC9hHKJeO7dcUMjblSl12867ElFTtaGl20xvvLGPdVz/8TVuU7y0x1PG7vtNg24oz9Uo/Z412++VFWI7Fcog9tu9Lm6gvRmIPv9x1xmQAu6RDkXtbOtlGEmpgD5Nvnyc0dcv0EE6cfdi1HmhMf9wDF3k3gtRvEedhxjpgfqPb9PU9iEJHnyOUA7bQUXh6kq/D7l2iTjWv7XOD530BDr8jIrus+srXjt4MzumJMHuTsBa63YKE1+RR5lBjEikCCnWKWiHdzOgKO+nRIBAF88za/IFmJ3eMZov4CYxGBabcpGL8EYx+SeMXJeRwHNsV/h+vdxeuhEpN3ZyNY78Gm2fknJxVGhyjixPiQvVkNzT1elD9Py/aTAL64Hb9vcYmC9zfdXdT/C1LeGbg4rnBaAihDFJH12W5ulfNCNe/xTsP3bp8ikzJs5BF+5PNfAQYAPaseTdsEcaYAAAAASUVORK5CYII="}},computed:{iconSnowWidth(){return(Math.floor(this.iconSize/24)||1)*2},contentdownText(){return this.contentText.contentdown||nn("uni-load-more.contentdown")},contentrefreshText(){return this.contentText.contentrefresh||nn("uni-load-more.contentrefresh")},contentnomoreText(){return this.contentText.contentnomore||nn("uni-load-more.contentnomore")}},mounted(){var n=getCurrentPages(),e=n[n.length-1],t=e.$getAppWebview();t.addEventListener("hide",()=>{this.webviewHide=!0}),t.addEventListener("show",()=>{this.webviewHide=!1})},methods:{onClick(){this.$emit("clickLoadMore",{detail:{status:this.status}})}}};function ua(n,e,t,i,o,s){return(0,G.openBlock)(),(0,G.createElementBlock)("view",{class:"uni-load-more",onClick:e[0]||(e[0]=(...r)=>s.onClick&&s.onClick(...r)),renderWhole:!0},[!o.webviewHide&&t.status==="loading"&&t.showIcon?((0,G.openBlock)(),(0,G.createElementBlock)("loading-indicator",{key:0,style:(0,G.normalizeStyle)({color:t.color,width:t.iconSize+"px",height:t.iconSize+"px"}),animating:!0,class:"uni-load-more__img uni-load-more__img--nvue"},null,4)):(0,G.createCommentVNode)("",!0),t.showText?((0,G.openBlock)(),(0,G.createElementBlock)("u-text",{key:1,class:"uni-load-more__text",style:(0,G.normalizeStyle)({color:t.color})},(0,G.toDisplayString)(t.status==="more"?s.contentdownText:t.status==="loading"?s.contentrefreshText:s.contentnomoreText),5)):(0,G.createCommentVNode)("",!0)])}var Ni=ie(la,[["render",ua],["styles",[ca]]]);var C=ke(we());var da={"uni-badge--x":{"":{position:"relative"}},"uni-badge--absolute":{"":{position:"absolute"}},"uni-badge--small":{"":{transform:"scale(0.8)",transformOrigin:"center center"}},"uni-badge":{"":{justifyContent:"center",flexDirection:"row",height:20,paddingTop:0,paddingRight:4,paddingBottom:0,paddingLeft:4,lineHeight:18,color:"#ffffff",borderRadius:100,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderStyle:"solid",borderColor:"#ffffff",textAlign:"center",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSize:12}},"uni-badge--info":{"":{color:"#ffffff",backgroundColor:"#909399"}},"uni-badge--primary":{"":{backgroundColor:"#2979ff"}},"uni-badge--success":{"":{backgroundColor:"#4cd964"}},"uni-badge--warning":{"":{backgroundColor:"#f0ad4e"}},"uni-badge--error":{"":{backgroundColor:"#dd524d"}},"uni-badge--inverted":{"":{paddingTop:0,paddingRight:5,paddingBottom:0,paddingLeft:0,color:"#909399"}},"uni-badge--info-inverted":{"":{color:"#909399",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--primary-inverted":{"":{color:"#2979ff",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--success-inverted":{"":{color:"#4cd964",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--warning-inverted":{"":{color:"#f0ad4e",backgroundColor:"rgba(0,0,0,0)"}},"uni-badge--error-inverted":{"":{color:"#dd524d",backgroundColor:"rgba(0,0,0,0)"}}},fa={name:"UniBadge",emits:["click"],props:{type:{type:String,default:"error"},inverted:{type:Boolean,default:!1},isDot:{type:Boolean,default:!1},maxNum:{type:Number,default:99},absolute:{type:String,default:""},offset:{type:Array,default(){return[0,0]}},text:{type:[String,Number],default:""},size:{type:String,default:"small"},customStyle:{type:Object,default(){return{}}}},data(){return{}},computed:{width(){return String(this.text).length*8+12},classNames(){let{inverted:n,type:e,size:t,absolute:i}=this;return[n?"uni-badge--"+e+"-inverted":"","uni-badge--"+e,"uni-badge--"+t,i?"uni-badge--absolute":""].join(" ")},positionStyle(){if(!this.absolute)return{};let n=this.width/2,e=10;this.isDot&&(n=5,e=5);let t=`${-n+this.offset[0]}px`,i=`${-e+this.offset[1]}px`,o={rightTop:{right:t,top:i},rightBottom:{right:t,bottom:i},leftBottom:{left:t,bottom:i},leftTop:{left:t,top:i}},s=o[this.absolute];return s||o.rightTop},dotStyle(){return this.isDot?{width:"10px",minWidth:"0",height:"10px",padding:"0",borderRadius:"10px"}:{}},displayValue(){let{isDot:n,text:e,maxNum:t}=this;return n?"":Number(e)>t?`${t}+`:e}},methods:{onClick(){this.$emit("click")}}};function ha(n,e,t,i,o,s){return(0,C.openBlock)(),(0,C.createElementBlock)("view",{class:"uni-badge--x",renderWhole:!0},[(0,C.renderSlot)(n.$slots,"default"),t.text?((0,C.openBlock)(),(0,C.createElementBlock)("u-text",{key:0,class:(0,C.normalizeClass)([s.classNames,"uni-badge"]),style:(0,C.normalizeStyle)([s.positionStyle,t.customStyle,s.dotStyle]),onClick:e[0]||(e[0]=r=>s.onClick())},(0,C.toDisplayString)(s.displayValue),7)):(0,C.createCommentVNode)("",!0)])}var ga=ie(fa,[["render",ha],["styles",[da]]]),ma={"uni-list-item":{"":{fontSize:16,position:"relative",justifyContent:"space-between",alignItems:"center",backgroundColor:"#ffffff",flexDirection:"row"}},"uni-list-item--disabled":{"":{opacity:.3}},"uni-list-item--hover":{"":{"!backgroundColor":"#f1f1f1"}},"uni-list-item__container":{"":{position:"relative",flexDirection:"row",paddingTop:12,paddingRight:15,paddingBottom:12,paddingLeft:15,flex:1,overflow:"hidden"}},"container--right":{"":{paddingRight:0}},"uni-list--border":{"":{position:"absolute",top:0,right:0,left:0,borderTopColor:"#e5e5e5",borderTopStyle:"solid",borderTopWidth:.5}},"uni-list-item__content":{"":{paddingRight:8,flex:1,color:"#3b4144",flexDirection:"column",justifyContent:"space-between",overflow:"hidden"}},"uni-list-item__content--center":{"":{justifyContent:"center"}},"uni-list-item__content-title":{"":{fontSize:14,color:"#3b4144",overflow:"hidden"}},"uni-list-item__content-note":{"":{marginTop:"6rpx",color:"#999999",fontSize:12,overflow:"hidden"}},"uni-list-item__extra":{"":{flexDirection:"row",justifyContent:"flex-end",alignItems:"center"}},"uni-list-item__header":{"":{flexDirection:"row",alignItems:"center"}},"uni-list-item__icon":{"":{marginRight:"18rpx",flexDirection:"row",justifyContent:"center",alignItems:"center"}},"uni-list-item__icon-img":{"":{height:26,width:26,marginRight:10}},"uni-icon-wrapper":{"":{alignItems:"center",paddingTop:0,paddingRight:10,paddingBottom:0,paddingLeft:10}},"flex--direction":{"":{flexDirection:"column"}},"uni-list--lg":{"":{height:40,width:40}},"uni-list--base":{"":{height:26,width:26}},"uni-list--sm":{"":{height:20,width:20}},"uni-list-item__extra-text":{"":{color:"#999999",fontSize:12}},"uni-ellipsis-1":{"":{lines:1,textOverflow:"ellipsis"}},"uni-ellipsis-2":{"":{lines:2,textOverflow:"ellipsis"}}},pa={name:"UniListItem",emits:["click","switchChange"],props:{direction:{type:String,default:"row"},title:{type:String,default:""},note:{type:String,default:""},ellipsis:{type:[Number,String],default:0},disabled:{type:[Boolean,String],default:!1},clickable:{type:Boolean,default:!1},showArrow:{type:[Boolean,String],default:!1},link:{type:[Boolean,String],default:!1},to:{type:String,default:""},showBadge:{type:[Boolean,String],default:!1},showSwitch:{type:[Boolean,String],default:!1},switchChecked:{type:[Boolean,String],default:!1},badgeText:{type:String,default:""},badgeType:{type:String,default:"success"},badgeStyle:{type:Object,default(){return{}}},rightText:{type:String,default:""},thumb:{type:String,default:""},thumbSize:{type:String,default:"base"},showExtraIcon:{type:[Boolean,String],default:!1},extraIcon:{type:Object,default(){return{type:"",color:"#000000",size:20,customPrefix:""}}},border:{type:Boolean,default:!0},customStyle:{type:Object,default(){return{padding:"",backgroundColor:"#FFFFFF"}}},keepScrollPosition:{type:Boolean,default:!1}},watch:{"customStyle.padding":{handler(n){typeof n=="number"&&(n+="");let e=n.split(" ");if(e.length===1){let t=e[0];this.padding={top:t,right:t,bottom:t,left:t}}else if(e.length===2){let[t,i]=e;this.padding={top:t,right:i,bottom:t,left:i}}else if(e.length===4){let[t,i,o,s]=e;this.padding={top:t,right:i,bottom:o,left:s}}},immediate:!0}},data(){return{isFirstChild:!1,padding:{top:"",right:"",bottom:"",left:""}}},mounted(){this.list=this.getForm(),this.list&&(this.list.firstChildAppend||(this.list.firstChildAppend=!0,this.isFirstChild=!0))},methods:{getForm(n="uniList"){let e=this.$parent,t=e.$options.name;for(;t!==n;){if(e=e.$parent,!e)return!1;t=e.$options.name}return e},onClick(){if(this.to!==""){this.openPage();return}(this.clickable||this.link)&&this.$emit("click",{data:{}})},onSwitchChange(n){this.$emit("switchChange",n.detail)},openPage(){["navigateTo","redirectTo","reLaunch","switchTab"].indexOf(this.link)!==-1?this.pageApi(this.link):this.pageApi("navigateTo")},pageApi(n){let e={url:this.to,success:t=>{this.$emit("click",{data:t})},fail:t=>{this.$emit("click",{data:t})}};switch(n){case"navigateTo":uni.navigateTo(e);break;case"redirectTo":uni.redirectTo(e);break;case"reLaunch":uni.reLaunch(e);break;case"switchTab":uni.switchTab(e);break;default:uni.navigateTo(e)}}}};function _a(n,e,t,i,o,s){let r=be((0,C.resolveDynamicComponent)("uni-icons"),yt),a=be((0,C.resolveDynamicComponent)("uni-badge"),ga),l=(0,C.resolveComponent)("switch");return(0,C.openBlock)(),(0,C.createElementBlock)("cell",{keepScrollPosition:t.keepScrollPosition},[(0,C.createElementVNode)("view",{class:(0,C.normalizeClass)([{"uni-list-item--disabled":t.disabled},"uni-list-item"]),style:(0,C.normalizeStyle)({"background-color":t.customStyle.backgroundColor}),hoverClass:!t.clickable&&!t.link||t.disabled||t.showSwitch?"":"uni-list-item--hover",onClick:e[0]||(e[0]=(...c)=>s.onClick&&s.onClick(...c))},[o.isFirstChild?(0,C.createCommentVNode)("",!0):((0,C.openBlock)(),(0,C.createElementBlock)("view",{key:0,class:(0,C.normalizeClass)(["border--left",{"uni-list--border":t.border}])},null,2)),(0,C.createElementVNode)("view",{class:(0,C.normalizeClass)(["uni-list-item__container",{"container--right":t.showArrow||t.link,"flex--direction":t.direction==="column"}]),style:(0,C.normalizeStyle)({paddingTop:o.padding.top,paddingLeft:o.padding.left,paddingRight:o.padding.right,paddingBottom:o.padding.bottom})},[(0,C.renderSlot)(n.$slots,"header",{},()=>[(0,C.createElementVNode)("view",{class:"uni-list-item__header"},[t.thumb?((0,C.openBlock)(),(0,C.createElementBlock)("view",{key:0,class:"uni-list-item__icon"},[(0,C.createElementVNode)("u-image",{src:t.thumb,class:(0,C.normalizeClass)(["uni-list-item__icon-img",["uni-list--"+t.thumbSize]])},null,10,["src"])])):t.showExtraIcon?((0,C.openBlock)(),(0,C.createElementBlock)("view",{key:1,class:"uni-list-item__icon"},[(0,C.createVNode)(r,{customPrefix:t.extraIcon.customPrefix,color:t.extraIcon.color,size:t.extraIcon.size,type:t.extraIcon.type},null,8,["customPrefix","color","size","type"])])):(0,C.createCommentVNode)("",!0)])]),(0,C.renderSlot)(n.$slots,"body",{},()=>[(0,C.createElementVNode)("view",{class:(0,C.normalizeClass)(["uni-list-item__content",{"uni-list-item__content--center":t.thumb||t.showExtraIcon||t.showBadge||t.showSwitch}])},[t.title?((0,C.openBlock)(),(0,C.createElementBlock)("u-text",{key:0,class:(0,C.normalizeClass)(["uni-list-item__content-title",[t.ellipsis!==0&&t.ellipsis<=2?"uni-ellipsis-"+t.ellipsis:""]])},(0,C.toDisplayString)(t.title),3)):(0,C.createCommentVNode)("",!0),t.note?((0,C.openBlock)(),(0,C.createElementBlock)("u-text",{key:1,class:"uni-list-item__content-note"},(0,C.toDisplayString)(t.note),1)):(0,C.createCommentVNode)("",!0)],2)]),(0,C.renderSlot)(n.$slots,"footer",{},()=>[t.rightText||t.showBadge||t.showSwitch?((0,C.openBlock)(),(0,C.createElementBlock)("view",{key:0,class:(0,C.normalizeClass)(["uni-list-item__extra",{"flex--justify":t.direction==="column"}])},[t.rightText?((0,C.openBlock)(),(0,C.createElementBlock)("u-text",{key:0,class:"uni-list-item__extra-text"},(0,C.toDisplayString)(t.rightText),1)):(0,C.createCommentVNode)("",!0),t.showBadge?((0,C.openBlock)(),(0,C.createBlock)(a,{key:1,type:t.badgeType,text:t.badgeText,"custom-style":t.badgeStyle},null,8,["type","text","custom-style"])):(0,C.createCommentVNode)("",!0),t.showSwitch?((0,C.openBlock)(),(0,C.createBlock)(l,{key:2,disabled:t.disabled,checked:t.switchChecked,onChange:s.onSwitchChange},null,8,["disabled","checked","onChange"])):(0,C.createCommentVNode)("",!0)],2)):(0,C.createCommentVNode)("",!0)])],6),t.showArrow||t.link?((0,C.openBlock)(),(0,C.createBlock)(r,{key:1,size:16,class:"uni-icon-wrapper",color:"#bbb",type:"arrowright"})):(0,C.createCommentVNode)("",!0)],14,["hoverClass"])],8,["keepScrollPosition"])}var Ui=ie(pa,[["render",_a],["styles",[ma]]]);var Ae=ke(we());var ya={"uni-list":{"":{backgroundColor:"#ffffff",position:"relative",flexDirection:"column"}},"uni-list--border":{"":{position:"relative",borderTopColor:"#e5e5e5",borderTopStyle:"solid",borderTopWidth:.5,borderBottomColor:"#e5e5e5",borderBottomStyle:"solid",borderBottomWidth:.5,zIndex:-1}}},wa={name:"uniList","mp-weixin":{options:{multipleSlots:!1}},props:{stackFromEnd:{type:Boolean,default:!1},enableBackToTop:{type:[Boolean,String],default:!1},scrollY:{type:[Boolean,String],default:!1},border:{type:Boolean,default:!0},renderReverse:{type:Boolean,default:!1}},created(){this.firstChildAppend=!1},methods:{loadMore(n){this.$emit("scrolltolower")},scroll(n){this.$emit("scroll",n)}}};function ba(n,e,t,i,o,s){return(0,Ae.openBlock)(),(0,Ae.createElementBlock)("list",{bounce:!1,scrollable:!0,showScrollbar:"",renderReverse:t.renderReverse,onScroll:e[0]||(e[0]=(...r)=>s.scroll&&s.scroll(...r)),class:(0,Ae.normalizeClass)(["uni-list",{"uni-list--border":t.border}]),enableBackToTop:t.enableBackToTop,loadmoreoffset:"15"},[(0,Ae.renderSlot)(n.$slots,"default")],42,["renderReverse","enableBackToTop"])}var ji=ie(wa,[["render",ba],["styles",[ya]]]);var Bi=F.database();function va(s,r){return A(this,arguments,function*({subType:n,confirm:e,cancel:t,item:i},o){switch(D("log","at uni_modules/uni-im/pages/contacts/notification/action.js:8",{subType:n,confirm:e,cancel:t,item:i}),n){case"uni-im-friend-invite":return uni.showLoading({mask:!1}),Bi.collection("uni-im-friend-invite").doc(i.payload.data._id).update({state:e?100:-100}).then(a=>{uni.hideLoading(),o()}).catch(a=>{D("log","at uni_modules/uni-im/pages/contacts/notification/action.js:28",a),uni.showModal({content:a.message||"\u8BF7\u6C42\u670D\u52A1\u5931\u8D25",showCancel:!1})});case"uni-im-group-join-request":uni.showLoading({mask:!1}),yield Bi.collection("uni-im-group-join").where({_id:i.payload.data.doc_id}).update({state:e?100:-100}).then(a=>{uni.hideLoading(),o()}).catch(a=>{D("log","at uni_modules/uni-im/pages/contacts/notification/action.js:50",a),uni.showModal({content:a.message||"\u8BF7\u6C42\u670D\u52A1\u5931\u8D25",showCancel:!1})});break;default:D("log","at uni_modules/uni-im/pages/contacts/notification/action.js:58",{subType:n});break}})}var ka={"notification-box":{"":{flex:1,backgroundColor:"#f5f5f5"}},tips:{"":{height:40,lineHeight:40,paddingLeft:"20rpx",fontSize:"26rpx",color:"#666666"}},"handle-box":{"":{flexDirection:"row",height:40,alignItems:"center"}},handle:{"":{width:50,textAlign:"center",height:25,lineHeight:25,backgroundColor:"#efefef",borderRadius:50,fontSize:12,marginTop:0,marginRight:5,marginBottom:0,marginLeft:5}},done:{"":{width:50,backgroundColor:"#FFFFFF",color:"#aaaaaa"}},"load-more":{"":{"!backgroundColor":"#f5f5f5",justifyContent:"center"}},tip:{"":{position:"relative",left:-15,width:"750rpx"}}},Fi=F.database(),xa={data(){return{filterNotice:{},tips:"",hasMore:!0}},onLoad(e){return A(this,arguments,function*({param:n}){n=JSON.parse(decodeURIComponent(n)),this.setParam(n)})},computed:{isWidescreen(){return O.isWidescreen},notificationDatas(){let n=O.notification.get(this.filterNotice);return n.length==0&&setTimeout(()=>{this.hasMore=!1},100),n}},mounted(){this.hasMore=O.notification.hasMore},methods:{setParam({filterNotice:n,title:e}){typeof n=="string"&&(n=JSON.parse(decodeURIComponent(n))),this.filterNotice=n,D("log","at uni_modules/uni-im/pages/contacts/notification/notification.nvue:89","filterNotice",n),uni.setNavigationBarTitle({title:e}),e=="\u65B0\u670B\u53CB"&&!this.isWidescreen&&(this.tips="\u597D\u53CB\u8BF7\u6C42\u901A\u77E5")},setItem(t,i){return A(this,arguments,function*({_id:n},e){let o=O.notification.get(this.filterNotice);for(let a=0;a<o.length;a++)if(o[a]._id==n){o[a]=r(o[a],e),O.notificationDatas=o,D("log","at uni_modules/uni-im/pages/contacts/notification/notification.nvue:104","uniIm.notificationDatas",O.notificationDatas);break}yield Fi.collection("uni-im-notification").where(`"_id" == "${n}" && "user_id" == $cloudEnv_uid`).get(),yield Fi.collection("uni-im-notification").where(`"_id" == "${n}" && "user_id" == $cloudEnv_uid`).update(e);function s(a){return typeof a=="object"&&Object.prototype.toString.call(a)==="[object Object]"}function r(){let a=arguments.length,l=arguments[0];s(l)||(l={});for(let c=1;c<a;c++){let _=arguments[c];if(s(_))for(let u in _)u==="__proto__"||l===_[u]||(s(_[u])?l[u]=r(l[u],_[u]):l[u]=_[u])}return l}})},clickHandle(n,e){return A(this,null,function*(){e.is_read||this.setItem(e,{is_read:!0});let t=e.path||e.payload.path;t&&uni.navigateTo({url:t,fail:i=>{D("error","at uni_modules/uni-im/pages/contacts/notification/notification.nvue:162",i)}})})},doAction(n,e){let t=this.notificationDatas[n],i={subType:t.payload.subType,confirm:e===1,cancel:e===0,item:t};va(i,o=>{D("log","at uni_modules/uni-im/pages/contacts/notification/notification.nvue:180","doAction",o),this.setItem(t,{is_read:!0,payload:{state:e===1?"confirm":"cancel"}})})},friendlyTime(n){return Qt.toFriendlyTime(n)},handleText(n){switch(n){case 0:return"\u540C\u610F";case 100:return"\u5DF2\u540C\u610F";case-100:return"\u5DF2\u62D2\u7EDD";default:return"\u5176\u4ED6"}}}};function Sa(n,e,t,i,o,s){let r=be((0,E.resolveDynamicComponent)("uni-icons"),yt),a=be((0,E.resolveDynamicComponent)("uni-list-chat"),Li),l=be((0,E.resolveDynamicComponent)("uni-load-more"),Ni),c=be((0,E.resolveDynamicComponent)("uni-list-item"),Ui),_=be((0,E.resolveDynamicComponent)("uni-list"),ji);return(0,E.openBlock)(),(0,E.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,E.createElementVNode)("view",{class:"notification-box"},[o.tips?((0,E.openBlock)(),(0,E.createElementBlock)("u-text",{key:0,class:"tips"},(0,E.toDisplayString)(o.tips),1)):(0,E.createCommentVNode)("",!0),(0,E.createVNode)(_,{border:!1},{default:(0,E.withCtx)(()=>[s.notificationDatas&&s.notificationDatas.length?((0,E.openBlock)(!0),(0,E.createElementBlock)(E.Fragment,{key:0},(0,E.renderList)(s.notificationDatas,(u,v)=>((0,E.openBlock)(),(0,E.createBlock)(a,{key:u.id,avatarCircle:!0,clickable:!0,"badge-text":u.is_read?"":"dot",badgePositon:"left",title:u.payload.title||u.title,note:u.payload.content||u.content||"\u65E0",avatar:u.payload.avatar_file&&u.payload.avatar_file.url?u.payload.avatar_file.url:"/uni_modules/uni-im/static/noticeIcon/notification2.png",onClick:h=>s.clickHandle(v,u),direction:"column",time:s.friendlyTime(u.create_time)},{default:(0,E.withCtx)(()=>[(0,E.createElementVNode)("view",{class:"handle-box"},[u.payload.state?((0,E.openBlock)(),(0,E.createElementBlock)("u-text",{key:0,class:"handle done"},(0,E.toDisplayString)("\u5DF2"+(u.payload.state=="confirm"?u.payload.confirmText:u.payload.cancelText)),1)):((0,E.openBlock)(),(0,E.createElementBlock)(E.Fragment,{key:1},[u.payload.cancelText?((0,E.openBlock)(),(0,E.createElementBlock)("u-text",{key:0,class:"handle",onClick:(0,E.withModifiers)(h=>s.doAction(v,0),["stop"])},(0,E.toDisplayString)(u.payload.cancelText),9,["onClick"])):(0,E.createCommentVNode)("",!0),u.payload.confirmText?((0,E.openBlock)(),(0,E.createElementBlock)("u-text",{key:1,class:"handle",onClick:(0,E.withModifiers)(h=>s.doAction(v,1),["stop"])},(0,E.toDisplayString)(u.payload.confirmText),9,["onClick"])):(0,E.createCommentVNode)("",!0),!u.payload.cancelText&&!u.payload.confirmText&&u.path?((0,E.openBlock)(),(0,E.createBlock)(r,{key:2,type:"right",color:"#cccccc"})):(0,E.createCommentVNode)("",!0)],64))])]),_:2},1032,["badge-text","title","note","avatar","onClick","time"]))),128)):((0,E.openBlock)(),(0,E.createBlock)(c,{key:1,class:"load-more"},{body:(0,E.withCtx)(()=>[(0,E.createVNode)(l,{class:"tip",status:o.hasMore?"loading":"noMore"},null,8,["status"])]),_:1}))]),_:1})])])}var wt=ie(xa,[["render",Sa],["styles",[ka]]]);var on=plus.webview.currentWebview();if(on){let n=parseInt(on.id),e="uni_modules/uni-im/pages/contacts/notification/notification",t={};try{t=JSON.parse(on.__query__)}catch(o){}wt.mpType="page";let i=Vue.createPageApp(wt,{$store:getApp({allowDefault:!0}).$store,__pageId:n,__pagePath:e,__pageQuery:t});i.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...wt.styles||[]])),i.mount("#root")}})();
